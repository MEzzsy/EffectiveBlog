
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>16 插件化 · Mezzsy is here</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Mezzsy">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="17 绘制流程-生产者.html" />
    
    
    <link rel="prev" href="15 Hook.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    00 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../01 语言/">
            
                <a href="../../01 语言/">
            
                    
                    01 语言
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../01 语言/01 Cpp/">
            
                <a href="../../01 语言/01 Cpp/">
            
                    
                    01 Cpp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../01 语言/01 Cpp/原理总结/">
            
                <a href="../../01 语言/01 Cpp/原理总结/">
            
                    
                    原理总结
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1.1" data-path="../../01 语言/01 Cpp/原理总结/其它.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/其它.html">
            
                    
                    其它
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.2" data-path="../../01 语言/01 Cpp/原理总结/函数.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/函数.html">
            
                    
                    函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.3" data-path="../../01 语言/01 Cpp/原理总结/对象.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/对象.html">
            
                    
                    对象
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.4" data-path="../../01 语言/01 Cpp/原理总结/成员变量.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/成员变量.html">
            
                    
                    成员变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.5" data-path="../../01 语言/01 Cpp/原理总结/执行期.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/执行期.html">
            
                    
                    执行期
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.6" data-path="../../01 语言/01 Cpp/原理总结/构造函数.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/构造函数.html">
            
                    
                    构造函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.7" data-path="../../01 语言/01 Cpp/原理总结/构造析构拷贝.html">
            
                <a href="../../01 语言/01 Cpp/原理总结/构造析构拷贝.html">
            
                    
                    构造析构拷贝
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../01 语言/01 Cpp/知识点/">
            
                <a href="../../01 语言/01 Cpp/知识点/">
            
                    
                    知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.2.1" data-path="../../01 语言/01 Cpp/知识点/基础.html">
            
                <a href="../../01 语言/01 Cpp/知识点/基础.html">
            
                    
                    基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.2" data-path="../../01 语言/01 Cpp/知识点/类.html">
            
                <a href="../../01 语言/01 Cpp/知识点/类.html">
            
                    
                    类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2.3" data-path="../../01 语言/01 Cpp/知识点/线程.html">
            
                <a href="../../01 语言/01 Cpp/知识点/线程.html">
            
                    
                    线程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../01 语言/02 Java/">
            
                <a href="../../01 语言/02 Java/">
            
                    
                    02 Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../01 语言/02 Java/Java-IO.html">
            
                <a href="../../01 语言/02 Java/Java-IO.html">
            
                    
                    Java-IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../01 语言/02 Java/Java反射机制和泛型.html">
            
                <a href="../../01 语言/02 Java/Java反射机制和泛型.html">
            
                    
                    Java反射机制和泛型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../../01 语言/02 Java/Java基础知识.html">
            
                <a href="../../01 语言/02 Java/Java基础知识.html">
            
                    
                    Java基础知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../../01 语言/02 Java/Java异常机制.html">
            
                <a href="../../01 语言/02 Java/Java异常机制.html">
            
                    
                    Java异常机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../../01 语言/02 Java/并发.html">
            
                <a href="../../01 语言/02 Java/并发.html">
            
                    
                    并发
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../../01 语言/02 Java/异常.html">
            
                <a href="../../01 语言/02 Java/异常.html">
            
                    
                    异常
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="../../01 语言/02 Java/禁止在foreach循环里进行元素的remove-add操作.html">
            
                <a href="../../01 语言/02 Java/禁止在foreach循环里进行元素的remove-add操作.html">
            
                    
                    禁止在foreach循环里进行元素的remove-add操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="../../01 语言/02 Java/类和接口.html">
            
                <a href="../../01 语言/02 Java/类和接口.html">
            
                    
                    类和接口
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../02 计算机系统/">
            
                <a href="../../02 计算机系统/">
            
                    
                    02 计算机系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../02 计算机系统/01-操作系统.html">
            
                <a href="../../02 计算机系统/01-操作系统.html">
            
                    
                    01-操作系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../02 计算机系统/02-内存.html">
            
                <a href="../../02 计算机系统/02-内存.html">
            
                    
                    02-内存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../02 计算机系统/03-线程.html">
            
                <a href="../../02 计算机系统/03-线程.html">
            
                    
                    03-线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../02 计算机系统/04-编译链接.html">
            
                <a href="../../02 计算机系统/04-编译链接.html">
            
                    
                    04-编译链接
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../02 计算机系统/深入理解计算机系统/">
            
                <a href="../../02 计算机系统/深入理解计算机系统/">
            
                    
                    深入理解计算机系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../../02 计算机系统/深入理解计算机系统/01-计算机系统漫游.html">
            
                <a href="../../02 计算机系统/深入理解计算机系统/01-计算机系统漫游.html">
            
                    
                    01-计算机系统漫游
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.2" data-path="../../02 计算机系统/深入理解计算机系统/02-信息的表示和处理.html">
            
                <a href="../../02 计算机系统/深入理解计算机系统/02-信息的表示和处理.html">
            
                    
                    02-信息的表示和处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.3" data-path="../../02 计算机系统/深入理解计算机系统/07-链接.html">
            
                <a href="../../02 计算机系统/深入理解计算机系统/07-链接.html">
            
                    
                    07-链接
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.4" data-path="../../02 计算机系统/深入理解计算机系统/09-虚拟内存.html">
            
                <a href="../../02 计算机系统/深入理解计算机系统/09-虚拟内存.html">
            
                    
                    09-虚拟内存
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../03 Java/">
            
                <a href="../../03 Java/">
            
                    
                    03 Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../03 Java/01 Java知识点/">
            
                <a href="../../03 Java/01 Java知识点/">
            
                    
                    01 Java知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../03 Java/01 Java知识点/Java基础知识.html">
            
                <a href="../../03 Java/01 Java知识点/Java基础知识.html">
            
                    
                    Java基础知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../03 Java/01 Java知识点/Java问题.html">
            
                <a href="../../03 Java/01 Java知识点/Java问题.html">
            
                    
                    Java问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../03 Java/01 Java知识点/泛型.html">
            
                <a href="../../03 Java/01 Java知识点/泛型.html">
            
                    
                    泛型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../../03 Java/01 Java知识点/注解.html">
            
                <a href="../../03 Java/01 Java知识点/注解.html">
            
                    
                    注解
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../03 Java/02 Java虚拟机/">
            
                <a href="../../03 Java/02 Java虚拟机/">
            
                    
                    02 Java虚拟机
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../03 Java/02 Java虚拟机/01-Java介绍.html">
            
                <a href="../../03 Java/02 Java虚拟机/01-Java介绍.html">
            
                    
                    01-Java介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../03 Java/02 Java虚拟机/02-内存区域.html">
            
                <a href="../../03 Java/02 Java虚拟机/02-内存区域.html">
            
                    
                    02-内存区域
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../03 Java/02 Java虚拟机/03-垃圾收集TODO.html">
            
                <a href="../../03 Java/02 Java虚拟机/03-垃圾收集TODO.html">
            
                    
                    03-垃圾收集TODO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../../03 Java/02 Java虚拟机/06-类文件结构.html">
            
                <a href="../../03 Java/02 Java虚拟机/06-类文件结构.html">
            
                    
                    06-类文件结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../../03 Java/02 Java虚拟机/07-虚拟机类加载机制.html">
            
                <a href="../../03 Java/02 Java虚拟机/07-虚拟机类加载机制.html">
            
                    
                    07-虚拟机类加载机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../../03 Java/02 Java虚拟机/08-虚拟机字节码执行引擎.html">
            
                <a href="../../03 Java/02 Java虚拟机/08-虚拟机字节码执行引擎.html">
            
                    
                    08-虚拟机字节码执行引擎
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.7" data-path="../../03 Java/02 Java虚拟机/12-Java内存模型与线程.html">
            
                <a href="../../03 Java/02 Java虚拟机/12-Java内存模型与线程.html">
            
                    
                    12-Java内存模型与线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.8" data-path="../../03 Java/02 Java虚拟机/13-线程安全与锁优化.html">
            
                <a href="../../03 Java/02 Java虚拟机/13-线程安全与锁优化.html">
            
                    
                    13-线程安全与锁优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../03 Java/03 常用源码分析/">
            
                <a href="../../03 Java/03 常用源码分析/">
            
                    
                    03 常用源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../03 Java/03 常用源码分析/ArrayList源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/ArrayList源码分析.html">
            
                    
                    ArrayList源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../../03 Java/03 常用源码分析/ConcurrentHashMap源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/ConcurrentHashMap源码分析.html">
            
                    
                    ConcurrentHashMap源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../../03 Java/03 常用源码分析/HashMap源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/HashMap源码分析.html">
            
                    
                    HashMap源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="../../03 Java/03 常用源码分析/HashTable源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/HashTable源码分析.html">
            
                    
                    HashTable源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.5" data-path="../../03 Java/03 常用源码分析/LinkedHashMap源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/LinkedHashMap源码分析.html">
            
                    
                    LinkedHashMap源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.6" data-path="../../03 Java/03 常用源码分析/LinkedList源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/LinkedList源码分析.html">
            
                    
                    LinkedList源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.7" data-path="../../03 Java/03 常用源码分析/ThreadLocal源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/ThreadLocal源码分析.html">
            
                    
                    ThreadLocal源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.8" data-path="../../03 Java/03 常用源码分析/线程池源码分析.html">
            
                <a href="../../03 Java/03 常用源码分析/线程池源码分析.html">
            
                    
                    线程池源码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../04 源码分析/">
            
                <a href="../../04 源码分析/">
            
                    
                    04 源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../04 源码分析/AddressSanitizer.html">
            
                <a href="../../04 源码分析/AddressSanitizer.html">
            
                    
                    AddressSanitizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../04 源码分析/ByteX.html">
            
                <a href="../../04 源码分析/ByteX.html">
            
                    
                    ByteX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../04 源码分析/PltHook.html">
            
                <a href="../../04 源码分析/PltHook.html">
            
                    
                    PltHook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../../04 源码分析/Raphael分析.html">
            
                <a href="../../04 源码分析/Raphael分析.html">
            
                    
                    Raphael分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../../04 源码分析/基于fp的栈回朔.html">
            
                <a href="../../04 源码分析/基于fp的栈回朔.html">
            
                    
                    基于fp的栈回朔
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../">
            
                <a href="../">
            
                    
                    05 Android
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="./">
            
                <a href="./">
            
                    
                    01 Android底层源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="01 系统启动过程.html">
            
                <a href="01 系统启动过程.html">
            
                    
                    01 系统启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="02 应用进程启动过程.html">
            
                <a href="02 应用进程启动过程.html">
            
                    
                    02 应用进程启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.3" data-path="03 Activity启动过程.html">
            
                <a href="03 Activity启动过程.html">
            
                    
                    03 Activity启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.4" data-path="04 其它组件启动过程.html">
            
                <a href="04 其它组件启动过程.html">
            
                    
                    04 其它组件启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.5" data-path="05 Context总结.html">
            
                <a href="05 Context总结.html">
            
                    
                    05 Context总结
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.6" data-path="06 AMS.html">
            
                <a href="06 AMS.html">
            
                    
                    06 AMS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.7" data-path="07 WM.html">
            
                <a href="07 WM.html">
            
                    
                    07 WM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.8" data-path="08 WMS.html">
            
                <a href="08 WMS.html">
            
                    
                    08 WMS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.9" data-path="10 JNI.html">
            
                <a href="10 JNI.html">
            
                    
                    10 JNI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.10" data-path="13 ClassLoader.html">
            
                <a href="13 ClassLoader.html">
            
                    
                    13 ClassLoader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.11" data-path="14 热修复.html">
            
                <a href="14 热修复.html">
            
                    
                    14 热修复
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.12" data-path="15 Hook.html">
            
                <a href="15 Hook.html">
            
                    
                    15 Hook
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.1.13" data-path="16 插件化.html">
            
                <a href="16 插件化.html">
            
                    
                    16 插件化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.14" data-path="17 绘制流程-生产者.html">
            
                <a href="17 绘制流程-生产者.html">
            
                    
                    17 绘制流程-生产者
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.15" data-path="18 绘制流程-消费者.html">
            
                <a href="18 绘制流程-消费者.html">
            
                    
                    18 绘制流程-消费者
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.16" data-path="19 渲染总结.html">
            
                <a href="19 渲染总结.html">
            
                    
                    19 渲染总结
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.17" data-path="20 硬件加速.html">
            
                <a href="20 硬件加速.html">
            
                    
                    20 硬件加速
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../02 Android应用和原理/">
            
                <a href="../02 Android应用和原理/">
            
                    
                    02 Android应用和原理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../02 Android应用和原理/Android动画.html">
            
                <a href="../02 Android应用和原理/Android动画.html">
            
                    
                    Android动画
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../02 Android应用和原理/Android消息机制.html">
            
                <a href="../02 Android应用和原理/Android消息机制.html">
            
                    
                    Android消息机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../02 Android应用和原理/Android的跨进程通信.html">
            
                <a href="../02 Android应用和原理/Android的跨进程通信.html">
            
                    
                    Android的跨进程通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="../02 Android应用和原理/Android类加载机制.html">
            
                <a href="../02 Android应用和原理/Android类加载机制.html">
            
                    
                    Android类加载机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="../02 Android应用和原理/Android线程.html">
            
                <a href="../02 Android应用和原理/Android线程.html">
            
                    
                    Android线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="../02 Android应用和原理/Drawable.html">
            
                <a href="../02 Android应用和原理/Drawable.html">
            
                    
                    Drawable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="../02 Android应用和原理/View手势事件.html">
            
                <a href="../02 Android应用和原理/View手势事件.html">
            
                    
                    View手势事件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.8" data-path="../02 Android应用和原理/View绘制基础.html">
            
                <a href="../02 Android应用和原理/View绘制基础.html">
            
                    
                    View绘制基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.9" data-path="../02 Android应用和原理/四大组件.html">
            
                <a href="../02 Android应用和原理/四大组件.html">
            
                    
                    四大组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.10" data-path="../02 Android应用和原理/性能优化.html">
            
                <a href="../02 Android应用和原理/性能优化.html">
            
                    
                    性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.11" data-path="../02 Android应用和原理/虚拟机.html">
            
                <a href="../02 Android应用和原理/虚拟机.html">
            
                    
                    虚拟机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.12" data-path="../02 Android应用和原理/面试题.html">
            
                <a href="../02 Android应用和原理/面试题.html">
            
                    
                    面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../03 Android应用手册/">
            
                <a href="../03 Android应用手册/">
            
                    
                    03 Android应用手册
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1" data-path="../03 Android应用手册/四大组件/">
            
                <a href="../03 Android应用手册/四大组件/">
            
                    
                    四大组件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1.1" data-path="../03 Android应用手册/四大组件/Android启动模式研究.html">
            
                <a href="../03 Android应用手册/四大组件/Android启动模式研究.html">
            
                    
                    Android启动模式研究
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.1.2" data-path="../03 Android应用手册/四大组件/Android生命周期.html">
            
                <a href="../03 Android应用手册/四大组件/Android生命周期.html">
            
                    
                    Android生命周期
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.1.3" data-path="../03 Android应用手册/四大组件/Broadcast.html">
            
                <a href="../03 Android应用手册/四大组件/Broadcast.html">
            
                    
                    Broadcast
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3.2" data-path="../03 Android应用手册/架构组件/">
            
                <a href="../03 Android应用手册/架构组件/">
            
                    
                    架构组件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.2.1" data-path="../03 Android应用手册/架构组件/LiveData.html">
            
                <a href="../03 Android应用手册/架构组件/LiveData.html">
            
                    
                    LiveData
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2.2" data-path="../03 Android应用手册/架构组件/Navigation.html">
            
                <a href="../03 Android应用手册/架构组件/Navigation.html">
            
                    
                    Navigation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2.3" data-path="../03 Android应用手册/架构组件/ViewModel.html">
            
                <a href="../03 Android应用手册/架构组件/ViewModel.html">
            
                    
                    ViewModel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3.3" data-path="../03 Android应用手册/视图/">
            
                <a href="../03 Android应用手册/视图/">
            
                    
                    视图
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.3.1" data-path="../03 Android应用手册/视图/Android动画.html">
            
                <a href="../03 Android应用手册/视图/Android动画.html">
            
                    
                    Android动画
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.2" data-path="../03 Android应用手册/视图/Android布局.html">
            
                <a href="../03 Android应用手册/视图/Android布局.html">
            
                    
                    Android布局
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.3" data-path="../03 Android应用手册/视图/Android控件.html">
            
                <a href="../03 Android应用手册/视图/Android控件.html">
            
                    
                    Android控件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.4" data-path="../03 Android应用手册/视图/Drawable.html">
            
                <a href="../03 Android应用手册/视图/Drawable.html">
            
                    
                    Drawable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.5" data-path="../03 Android应用手册/视图/View绘制.html">
            
                <a href="../03 Android应用手册/视图/View绘制.html">
            
                    
                    View绘制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.6" data-path="../03 Android应用手册/视图/视图相关工具类.html">
            
                <a href="../03 Android应用手册/视图/视图相关工具类.html">
            
                    
                    视图相关工具类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3.7" data-path="../03 Android应用手册/视图/资源文件.html">
            
                <a href="../03 Android应用手册/视图/资源文件.html">
            
                    
                    资源文件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3.4" data-path="../03 Android应用手册/项目/">
            
                <a href="../03 Android应用手册/项目/">
            
                    
                    项目
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.4.1" data-path="../03 Android应用手册/项目/命令行调试.html">
            
                <a href="../03 Android应用手册/项目/命令行调试.html">
            
                    
                    命令行调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.4.2" data-path="../03 Android应用手册/项目/打包.html">
            
                <a href="../03 Android应用手册/项目/打包.html">
            
                    
                    打包
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../04 常用类源码分析/">
            
                <a href="../04 常用类源码分析/">
            
                    
                    04 常用类源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="../04 常用类源码分析/AsyncTask源码分析.html">
            
                <a href="../04 常用类源码分析/AsyncTask源码分析.html">
            
                    
                    AsyncTask源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="../04 常用类源码分析/EventBus源码分析.html">
            
                <a href="../04 常用类源码分析/EventBus源码分析.html">
            
                    
                    EventBus源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="../04 常用类源码分析/Glide源码分析.html">
            
                <a href="../04 常用类源码分析/Glide源码分析.html">
            
                    
                    Glide源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.4" data-path="../04 常用类源码分析/Handler源码分析.html">
            
                <a href="../04 常用类源码分析/Handler源码分析.html">
            
                    
                    Handler源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.5" data-path="../04 常用类源码分析/LeakCanary.html">
            
                <a href="../04 常用类源码分析/LeakCanary.html">
            
                    
                    LeakCanary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.6" data-path="../04 常用类源码分析/LinearLayout源码分析.html">
            
                <a href="../04 常用类源码分析/LinearLayout源码分析.html">
            
                    
                    LinearLayout源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.7" data-path="../04 常用类源码分析/ListView源码分析.html">
            
                <a href="../04 常用类源码分析/ListView源码分析.html">
            
                    
                    ListView源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.8" data-path="../04 常用类源码分析/LruCache源码分析.html">
            
                <a href="../04 常用类源码分析/LruCache源码分析.html">
            
                    
                    LruCache源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.9" data-path="../04 常用类源码分析/OkHttp3源码分析.html">
            
                <a href="../04 常用类源码分析/OkHttp3源码分析.html">
            
                    
                    OkHttp3源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.10" data-path="../04 常用类源码分析/Retrofit2源码分析.html">
            
                <a href="../04 常用类源码分析/Retrofit2源码分析.html">
            
                    
                    Retrofit2源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.11" data-path="../04 常用类源码分析/RxJava2源码分析.html">
            
                <a href="../04 常用类源码分析/RxJava2源码分析.html">
            
                    
                    RxJava2源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.12" data-path="../04 常用类源码分析/SparseArray源码分析.html">
            
                <a href="../04 常用类源码分析/SparseArray源码分析.html">
            
                    
                    SparseArray源码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../05 性能优化工具/">
            
                <a href="../05 性能优化工具/">
            
                    
                    05 性能优化工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../05 性能优化工具/cpu工具.html">
            
                <a href="../05 性能优化工具/cpu工具.html">
            
                    
                    cpu工具
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../06 计算机网络/">
            
                <a href="../../06 计算机网络/">
            
                    
                    06 计算机网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../06 计算机网络/计算机网络.html">
            
                <a href="../../06 计算机网络/计算机网络.html">
            
                    
                    计算机网络
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../07 设计模式/">
            
                <a href="../../07 设计模式/">
            
                    
                    07 设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../07 设计模式/Builder模式.html">
            
                <a href="../../07 设计模式/Builder模式.html">
            
                    
                    Builder模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../07 设计模式/代理模式.html">
            
                <a href="../../07 设计模式/代理模式.html">
            
                    
                    代理模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../07 设计模式/其它设计模式/">
            
                <a href="../../07 设计模式/其它设计模式/">
            
                    
                    其它设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="../../07 设计模式/其它设计模式/中介者模式.html">
            
                <a href="../../07 设计模式/其它设计模式/中介者模式.html">
            
                    
                    中介者模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.2" data-path="../../07 设计模式/其它设计模式/享元模式.html">
            
                <a href="../../07 设计模式/其它设计模式/享元模式.html">
            
                    
                    享元模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.3" data-path="../../07 设计模式/其它设计模式/原型模式.html">
            
                <a href="../../07 设计模式/其它设计模式/原型模式.html">
            
                    
                    原型模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.4" data-path="../../07 设计模式/其它设计模式/命令模式.html">
            
                <a href="../../07 设计模式/其它设计模式/命令模式.html">
            
                    
                    命令模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.5" data-path="../../07 设计模式/其它设计模式/备忘录模式.html">
            
                <a href="../../07 设计模式/其它设计模式/备忘录模式.html">
            
                    
                    备忘录模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.6" data-path="../../07 设计模式/其它设计模式/外观模式.html">
            
                <a href="../../07 设计模式/其它设计模式/外观模式.html">
            
                    
                    外观模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.7" data-path="../../07 设计模式/其它设计模式/工厂方法模式.html">
            
                <a href="../../07 设计模式/其它设计模式/工厂方法模式.html">
            
                    
                    工厂方法模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.8" data-path="../../07 设计模式/其它设计模式/抽象工厂模式.html">
            
                <a href="../../07 设计模式/其它设计模式/抽象工厂模式.html">
            
                    
                    抽象工厂模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.9" data-path="../../07 设计模式/其它设计模式/框架模式.html">
            
                <a href="../../07 设计模式/其它设计模式/框架模式.html">
            
                    
                    框架模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.10" data-path="../../07 设计模式/其它设计模式/桥接模式.html">
            
                <a href="../../07 设计模式/其它设计模式/桥接模式.html">
            
                    
                    桥接模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.11" data-path="../../07 设计模式/其它设计模式/模板方法模式.html">
            
                <a href="../../07 设计模式/其它设计模式/模板方法模式.html">
            
                    
                    模板方法模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.12" data-path="../../07 设计模式/其它设计模式/状态模式.html">
            
                <a href="../../07 设计模式/其它设计模式/状态模式.html">
            
                    
                    状态模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.13" data-path="../../07 设计模式/其它设计模式/策略模式.html">
            
                <a href="../../07 设计模式/其它设计模式/策略模式.html">
            
                    
                    策略模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.14" data-path="../../07 设计模式/其它设计模式/组合模式.html">
            
                <a href="../../07 设计模式/其它设计模式/组合模式.html">
            
                    
                    组合模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.15" data-path="../../07 设计模式/其它设计模式/装饰模式.html">
            
                <a href="../../07 设计模式/其它设计模式/装饰模式.html">
            
                    
                    装饰模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.16" data-path="../../07 设计模式/其它设计模式/解释器模式.html">
            
                <a href="../../07 设计模式/其它设计模式/解释器模式.html">
            
                    
                    解释器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.17" data-path="../../07 设计模式/其它设计模式/访问者模式.html">
            
                <a href="../../07 设计模式/其它设计模式/访问者模式.html">
            
                    
                    访问者模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.18" data-path="../../07 设计模式/其它设计模式/责任链模式.html">
            
                <a href="../../07 设计模式/其它设计模式/责任链模式.html">
            
                    
                    责任链模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.19" data-path="../../07 设计模式/其它设计模式/迭代器模式.html">
            
                <a href="../../07 设计模式/其它设计模式/迭代器模式.html">
            
                    
                    迭代器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.20" data-path="../../07 设计模式/其它设计模式/适配器模式.html">
            
                <a href="../../07 设计模式/其它设计模式/适配器模式.html">
            
                    
                    适配器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.21" data-path="../../07 设计模式/其它设计模式/静态工厂方法模式.html">
            
                <a href="../../07 设计模式/其它设计模式/静态工厂方法模式.html">
            
                    
                    静态工厂方法模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../07 设计模式/单例模式.html">
            
                <a href="../../07 设计模式/单例模式.html">
            
                    
                    单例模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../../07 设计模式/架构模式.html">
            
                <a href="../../07 设计模式/架构模式.html">
            
                    
                    架构模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../../07 设计模式/生产者消费者模式.html">
            
                <a href="../../07 设计模式/生产者消费者模式.html">
            
                    
                    生产者消费者模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../../07 设计模式/观察者模式.html">
            
                <a href="../../07 设计模式/观察者模式.html">
            
                    
                    观察者模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../08 杂项/">
            
                <a href="../../08 杂项/">
            
                    
                    08 杂项
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../08 杂项/git手册/">
            
                <a href="../../08 杂项/git手册/">
            
                    
                    git手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../08 杂项/常用命令/">
            
                <a href="../../08 杂项/常用命令/">
            
                    
                    常用命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../../08 杂项/环境搭建记录/">
            
                <a href="../../08 杂项/环境搭建记录/">
            
                    
                    环境搭建记录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.3.1" data-path="../../08 杂项/环境搭建记录/环境搭建.html">
            
                <a href="../../08 杂项/环境搭建记录/环境搭建.html">
            
                    
                    环境搭建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../09 Gradle总结/">
            
                <a href="../../09 Gradle总结/">
            
                    
                    09 Gradle总结
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../../09 Gradle总结/Gradle总结.html">
            
                <a href="../../09 Gradle总结/Gradle总结.html">
            
                    
                    Gradle总结
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../../11 知识点/">
            
                <a href="../../11 知识点/">
            
                    
                    11 知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../../11 知识点/04-操作系统.html">
            
                <a href="../../11 知识点/04-操作系统.html">
            
                    
                    04-操作系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../../11 知识点/06-数据结构.html">
            
                <a href="../../11 知识点/06-数据结构.html">
            
                    
                    06-数据结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../../11 知识点/07-第三方库.html">
            
                <a href="../../11 知识点/07-第三方库.html">
            
                    
                    07-第三方库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../../11 知识点/08-设计模式.html">
            
                <a href="../../11 知识点/08-设计模式.html">
            
                    
                    08-设计模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../../11 知识点/09-算法.html">
            
                <a href="../../11 知识点/09-算法.html">
            
                    
                    09-算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../../11 知识点/10-计算机底层基础.html">
            
                <a href="../../11 知识点/10-计算机底层基础.html">
            
                    
                    10-计算机底层基础
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../../docs/README.md">
            
                <span>
            
                    
                    docs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../../docs/01 语言/README.md">
            
                <span>
            
                    
                    01 语言
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.1" data-path="../../docs/01 语言/01 Cpp/README.md">
            
                <span>
            
                    
                    01 Cpp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.1.1" data-path="../../docs/01 语言/01 Cpp/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2" data-path="../../docs/01 语言/01 Cpp/原理总结/README.md">
            
                <span>
            
                    
                    原理总结
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.1.2.1" data-path="../../docs/01 语言/01 Cpp/原理总结/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.2" data-path="../../docs/01 语言/01 Cpp/原理总结/其它.html">
            
                <span>
            
                    
                    其它.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.3" data-path="../../docs/01 语言/01 Cpp/原理总结/函数.html">
            
                <span>
            
                    
                    函数.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.4" data-path="../../docs/01 语言/01 Cpp/原理总结/对象.html">
            
                <span>
            
                    
                    对象.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.5" data-path="../../docs/01 语言/01 Cpp/原理总结/成员变量.html">
            
                <span>
            
                    
                    成员变量.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.6" data-path="../../docs/01 语言/01 Cpp/原理总结/执行期.html">
            
                <span>
            
                    
                    执行期.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.7" data-path="../../docs/01 语言/01 Cpp/原理总结/构造函数.html">
            
                <span>
            
                    
                    构造函数.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.2.8" data-path="../../docs/01 语言/01 Cpp/原理总结/构造析构拷贝.html">
            
                <span>
            
                    
                    构造析构拷贝.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.3" data-path="../../docs/01 语言/01 Cpp/知识点/README.md">
            
                <span>
            
                    
                    知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.1.3.1" data-path="../../docs/01 语言/01 Cpp/知识点/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.3.2" data-path="../../docs/01 语言/01 Cpp/知识点/基础.html">
            
                <span>
            
                    
                    基础.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.3.3" data-path="../../docs/01 语言/01 Cpp/知识点/类.html">
            
                <span>
            
                    
                    类.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.1.3.4" data-path="../../docs/01 语言/01 Cpp/知识点/线程.html">
            
                <span>
            
                    
                    线程.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.1.2" data-path="../../docs/01 语言/02 Java/README.md">
            
                <span>
            
                    
                    02 Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.2.1" data-path="../../docs/01 语言/02 Java/Java-IO.html">
            
                <span>
            
                    
                    Java-IO.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.2" data-path="../../docs/01 语言/02 Java/Java反射机制和泛型.html">
            
                <span>
            
                    
                    Java反射机制和泛型.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.3" data-path="../../docs/01 语言/02 Java/Java基础知识.html">
            
                <span>
            
                    
                    Java基础知识.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.4" data-path="../../docs/01 语言/02 Java/Java异常机制.html">
            
                <span>
            
                    
                    Java异常机制.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.5" data-path="../../docs/01 语言/02 Java/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.6" data-path="../../docs/01 语言/02 Java/并发.html">
            
                <span>
            
                    
                    并发.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.7" data-path="../../docs/01 语言/02 Java/异常.html">
            
                <span>
            
                    
                    异常.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.8" data-path="../../docs/01 语言/02 Java/禁止在foreach循环里进行元素的remove-add操作.html">
            
                <span>
            
                    
                    禁止在foreach循环里进行元素的remove-add操作.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2.9" data-path="../../docs/01 语言/02 Java/类和接口.html">
            
                <span>
            
                    
                    类和接口.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.1.3" data-path="../../docs/01 语言/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../../docs/02 计算机系统/README.md">
            
                <span>
            
                    
                    02 计算机系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.2.1" data-path="../../docs/02 计算机系统/01-操作系统.html">
            
                <span>
            
                    
                    01-操作系统.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.2" data-path="../../docs/02 计算机系统/02-内存.html">
            
                <span>
            
                    
                    02-内存.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.3" data-path="../../docs/02 计算机系统/03-线程.html">
            
                <span>
            
                    
                    03-线程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.4" data-path="../../docs/02 计算机系统/04-编译链接.html">
            
                <span>
            
                    
                    04-编译链接.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.5" data-path="../../docs/02 计算机系统/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.6" data-path="../../docs/02 计算机系统/深入理解计算机系统/README.md">
            
                <span>
            
                    
                    深入理解计算机系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.2.6.1" data-path="../../docs/02 计算机系统/深入理解计算机系统/01-计算机系统漫游.html">
            
                <span>
            
                    
                    01-计算机系统漫游.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.6.2" data-path="../../docs/02 计算机系统/深入理解计算机系统/02-信息的表示和处理.html">
            
                <span>
            
                    
                    02-信息的表示和处理.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.6.3" data-path="../../docs/02 计算机系统/深入理解计算机系统/07-链接.html">
            
                <span>
            
                    
                    07-链接.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.6.4" data-path="../../docs/02 计算机系统/深入理解计算机系统/09-虚拟内存.html">
            
                <span>
            
                    
                    09-虚拟内存.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.6.5" data-path="../../docs/02 计算机系统/深入理解计算机系统/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../../docs/03 Java/README.md">
            
                <span>
            
                    
                    03 Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.3.1" data-path="../../docs/03 Java/01 Java知识点/README.md">
            
                <span>
            
                    
                    01 Java知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.3.1.1" data-path="../../docs/03 Java/01 Java知识点/Java基础知识.html">
            
                <span>
            
                    
                    Java基础知识.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.1.2" data-path="../../docs/03 Java/01 Java知识点/Java问题.html">
            
                <span>
            
                    
                    Java问题.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.1.3" data-path="../../docs/03 Java/01 Java知识点/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.1.4" data-path="../../docs/03 Java/01 Java知识点/泛型.html">
            
                <span>
            
                    
                    泛型.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.1.5" data-path="../../docs/03 Java/01 Java知识点/注解.html">
            
                <span>
            
                    
                    注解.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.3.2" data-path="../../docs/03 Java/02 Java虚拟机/README.md">
            
                <span>
            
                    
                    02 Java虚拟机
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.3.2.1" data-path="../../docs/03 Java/02 Java虚拟机/01-Java介绍.html">
            
                <span>
            
                    
                    01-Java介绍.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.2" data-path="../../docs/03 Java/02 Java虚拟机/02-内存区域.html">
            
                <span>
            
                    
                    02-内存区域.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.3" data-path="../../docs/03 Java/02 Java虚拟机/03-垃圾收集TODO.html">
            
                <span>
            
                    
                    03-垃圾收集TODO.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.4" data-path="../../docs/03 Java/02 Java虚拟机/06-类文件结构.html">
            
                <span>
            
                    
                    06-类文件结构.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.5" data-path="../../docs/03 Java/02 Java虚拟机/07-虚拟机类加载机制.html">
            
                <span>
            
                    
                    07-虚拟机类加载机制.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.6" data-path="../../docs/03 Java/02 Java虚拟机/08-虚拟机字节码执行引擎.html">
            
                <span>
            
                    
                    08-虚拟机字节码执行引擎.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.7" data-path="../../docs/03 Java/02 Java虚拟机/12-Java内存模型与线程.html">
            
                <span>
            
                    
                    12-Java内存模型与线程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.8" data-path="../../docs/03 Java/02 Java虚拟机/13-线程安全与锁优化.html">
            
                <span>
            
                    
                    13-线程安全与锁优化.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2.9" data-path="../../docs/03 Java/02 Java虚拟机/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.3.3" data-path="../../docs/03 Java/03 常用源码分析/README.md">
            
                <span>
            
                    
                    03 常用源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.3.3.1" data-path="../../docs/03 Java/03 常用源码分析/ArrayList源码分析.html">
            
                <span>
            
                    
                    ArrayList源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.2" data-path="../../docs/03 Java/03 常用源码分析/ConcurrentHashMap源码分析.html">
            
                <span>
            
                    
                    ConcurrentHashMap源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.3" data-path="../../docs/03 Java/03 常用源码分析/HashMap源码分析.html">
            
                <span>
            
                    
                    HashMap源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.4" data-path="../../docs/03 Java/03 常用源码分析/HashTable源码分析.html">
            
                <span>
            
                    
                    HashTable源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.5" data-path="../../docs/03 Java/03 常用源码分析/LinkedHashMap源码分析.html">
            
                <span>
            
                    
                    LinkedHashMap源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.6" data-path="../../docs/03 Java/03 常用源码分析/LinkedList源码分析.html">
            
                <span>
            
                    
                    LinkedList源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.7" data-path="../../docs/03 Java/03 常用源码分析/ThreadLocal源码分析.html">
            
                <span>
            
                    
                    ThreadLocal源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.8" data-path="../../docs/03 Java/03 常用源码分析/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3.9" data-path="../../docs/03 Java/03 常用源码分析/线程池源码分析.html">
            
                <span>
            
                    
                    线程池源码分析.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.3.4" data-path="../../docs/03 Java/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../../docs/04 源码分析/README.md">
            
                <span>
            
                    
                    04 源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.4.1" data-path="../../docs/04 源码分析/AddressSanitizer.html">
            
                <span>
            
                    
                    AddressSanitizer.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4.2" data-path="../../docs/04 源码分析/ByteX.html">
            
                <span>
            
                    
                    ByteX.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4.3" data-path="../../docs/04 源码分析/PltHook.html">
            
                <span>
            
                    
                    PltHook.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4.4" data-path="../../docs/04 源码分析/Raphael分析.html">
            
                <span>
            
                    
                    Raphael分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4.5" data-path="../../docs/04 源码分析/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4.6" data-path="../../docs/04 源码分析/基于fp的栈回朔.html">
            
                <span>
            
                    
                    基于fp的栈回朔.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../../docs/05 Android/README.md">
            
                <span>
            
                    
                    05 Android
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.1" data-path="../../docs/05 Android/01 Android底层源码分析/README.md">
            
                <span>
            
                    
                    01 Android底层源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.1.1" data-path="../../docs/05 Android/01 Android底层源码分析/01 系统启动过程.html">
            
                <span>
            
                    
                    01 系统启动过程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.2" data-path="../../docs/05 Android/01 Android底层源码分析/02 应用进程启动过程.html">
            
                <span>
            
                    
                    02 应用进程启动过程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.3" data-path="../../docs/05 Android/01 Android底层源码分析/03 Activity启动过程.html">
            
                <span>
            
                    
                    03 Activity启动过程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.4" data-path="../../docs/05 Android/01 Android底层源码分析/04 其它组件启动过程.html">
            
                <span>
            
                    
                    04 其它组件启动过程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.5" data-path="../../docs/05 Android/01 Android底层源码分析/05 Context总结.html">
            
                <span>
            
                    
                    05 Context总结.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.6" data-path="../../docs/05 Android/01 Android底层源码分析/06 AMS.html">
            
                <span>
            
                    
                    06 AMS.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.7" data-path="../../docs/05 Android/01 Android底层源码分析/07 WM.html">
            
                <span>
            
                    
                    07 WM.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.8" data-path="../../docs/05 Android/01 Android底层源码分析/08 WMS.html">
            
                <span>
            
                    
                    08 WMS.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.9" data-path="../../docs/05 Android/01 Android底层源码分析/10 JNI.html">
            
                <span>
            
                    
                    10 JNI.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.10" data-path="../../docs/05 Android/01 Android底层源码分析/13 ClassLoader.html">
            
                <span>
            
                    
                    13 ClassLoader.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.11" data-path="../../docs/05 Android/01 Android底层源码分析/14 热修复.html">
            
                <span>
            
                    
                    14 热修复.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.12" data-path="../../docs/05 Android/01 Android底层源码分析/15 Hook.html">
            
                <span>
            
                    
                    15 Hook.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.13" data-path="../../docs/05 Android/01 Android底层源码分析/16 插件化.html">
            
                <span>
            
                    
                    16 插件化.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.14" data-path="../../docs/05 Android/01 Android底层源码分析/17 绘制流程-生产者.html">
            
                <span>
            
                    
                    17 绘制流程-生产者.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.15" data-path="../../docs/05 Android/01 Android底层源码分析/18 绘制流程-消费者.html">
            
                <span>
            
                    
                    18 绘制流程-消费者.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.16" data-path="../../docs/05 Android/01 Android底层源码分析/19 渲染总结.html">
            
                <span>
            
                    
                    19 渲染总结.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.17" data-path="../../docs/05 Android/01 Android底层源码分析/20 硬件加速.html">
            
                <span>
            
                    
                    20 硬件加速.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.1.18" data-path="../../docs/05 Android/01 Android底层源码分析/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.2" data-path="../../docs/05 Android/02 Android应用和原理/README.md">
            
                <span>
            
                    
                    02 Android应用和原理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.2.1" data-path="../../docs/05 Android/02 Android应用和原理/Android动画.html">
            
                <span>
            
                    
                    Android动画.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.2" data-path="../../docs/05 Android/02 Android应用和原理/Android消息机制.html">
            
                <span>
            
                    
                    Android消息机制.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.3" data-path="../../docs/05 Android/02 Android应用和原理/Android的跨进程通信.html">
            
                <span>
            
                    
                    Android的跨进程通信.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.4" data-path="../../docs/05 Android/02 Android应用和原理/Android类加载机制.html">
            
                <span>
            
                    
                    Android类加载机制.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.5" data-path="../../docs/05 Android/02 Android应用和原理/Android线程.html">
            
                <span>
            
                    
                    Android线程.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.6" data-path="../../docs/05 Android/02 Android应用和原理/Drawable.html">
            
                <span>
            
                    
                    Drawable.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.7" data-path="../../docs/05 Android/02 Android应用和原理/View手势事件.html">
            
                <span>
            
                    
                    View手势事件.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.8" data-path="../../docs/05 Android/02 Android应用和原理/View绘制基础.html">
            
                <span>
            
                    
                    View绘制基础.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.9" data-path="../../docs/05 Android/02 Android应用和原理/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.10" data-path="../../docs/05 Android/02 Android应用和原理/四大组件.html">
            
                <span>
            
                    
                    四大组件.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.11" data-path="../../docs/05 Android/02 Android应用和原理/性能优化.html">
            
                <span>
            
                    
                    性能优化.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.12" data-path="../../docs/05 Android/02 Android应用和原理/虚拟机.html">
            
                <span>
            
                    
                    虚拟机.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.2.13" data-path="../../docs/05 Android/02 Android应用和原理/面试题.html">
            
                <span>
            
                    
                    面试题.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.3" data-path="../../docs/05 Android/03 Android应用手册/README.md">
            
                <span>
            
                    
                    03 Android应用手册
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.3.1" data-path="../../docs/05 Android/03 Android应用手册/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.2" data-path="../../docs/05 Android/03 Android应用手册/四大组件/README.md">
            
                <span>
            
                    
                    四大组件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.3.2.1" data-path="../../docs/05 Android/03 Android应用手册/四大组件/Android启动模式研究.html">
            
                <span>
            
                    
                    Android启动模式研究.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.2.2" data-path="../../docs/05 Android/03 Android应用手册/四大组件/Android生命周期.html">
            
                <span>
            
                    
                    Android生命周期.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.2.3" data-path="../../docs/05 Android/03 Android应用手册/四大组件/Broadcast.html">
            
                <span>
            
                    
                    Broadcast.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.2.4" data-path="../../docs/05 Android/03 Android应用手册/四大组件/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.3" data-path="../../docs/05 Android/03 Android应用手册/架构组件/README.md">
            
                <span>
            
                    
                    架构组件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.3.3.1" data-path="../../docs/05 Android/03 Android应用手册/架构组件/LiveData.html">
            
                <span>
            
                    
                    LiveData.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.3.2" data-path="../../docs/05 Android/03 Android应用手册/架构组件/Navigation.html">
            
                <span>
            
                    
                    Navigation.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.3.3" data-path="../../docs/05 Android/03 Android应用手册/架构组件/ViewModel.html">
            
                <span>
            
                    
                    ViewModel.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.3.4" data-path="../../docs/05 Android/03 Android应用手册/架构组件/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4" data-path="../../docs/05 Android/03 Android应用手册/视图/README.md">
            
                <span>
            
                    
                    视图
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.3.4.1" data-path="../../docs/05 Android/03 Android应用手册/视图/Android动画.html">
            
                <span>
            
                    
                    Android动画.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.2" data-path="../../docs/05 Android/03 Android应用手册/视图/Android布局.html">
            
                <span>
            
                    
                    Android布局.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.3" data-path="../../docs/05 Android/03 Android应用手册/视图/Android控件.html">
            
                <span>
            
                    
                    Android控件.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.4" data-path="../../docs/05 Android/03 Android应用手册/视图/Drawable.html">
            
                <span>
            
                    
                    Drawable.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.5" data-path="../../docs/05 Android/03 Android应用手册/视图/View绘制.html">
            
                <span>
            
                    
                    View绘制.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.6" data-path="../../docs/05 Android/03 Android应用手册/视图/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.7" data-path="../../docs/05 Android/03 Android应用手册/视图/视图相关工具类.html">
            
                <span>
            
                    
                    视图相关工具类.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.4.8" data-path="../../docs/05 Android/03 Android应用手册/视图/资源文件.html">
            
                <span>
            
                    
                    资源文件.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.5" data-path="../../docs/05 Android/03 Android应用手册/项目/README.md">
            
                <span>
            
                    
                    项目
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.3.5.1" data-path="../../docs/05 Android/03 Android应用手册/项目/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.5.2" data-path="../../docs/05 Android/03 Android应用手册/项目/命令行调试.html">
            
                <span>
            
                    
                    命令行调试.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.3.5.3" data-path="../../docs/05 Android/03 Android应用手册/项目/打包.html">
            
                <span>
            
                    
                    打包.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.4" data-path="../../docs/05 Android/04 常用类源码分析/README.md">
            
                <span>
            
                    
                    04 常用类源码分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.4.1" data-path="../../docs/05 Android/04 常用类源码分析/AsyncTask源码分析.html">
            
                <span>
            
                    
                    AsyncTask源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.2" data-path="../../docs/05 Android/04 常用类源码分析/EventBus源码分析.html">
            
                <span>
            
                    
                    EventBus源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.3" data-path="../../docs/05 Android/04 常用类源码分析/Glide源码分析.html">
            
                <span>
            
                    
                    Glide源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.4" data-path="../../docs/05 Android/04 常用类源码分析/Handler源码分析.html">
            
                <span>
            
                    
                    Handler源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.5" data-path="../../docs/05 Android/04 常用类源码分析/LeakCanary.html">
            
                <span>
            
                    
                    LeakCanary.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.6" data-path="../../docs/05 Android/04 常用类源码分析/LinearLayout源码分析.html">
            
                <span>
            
                    
                    LinearLayout源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.7" data-path="../../docs/05 Android/04 常用类源码分析/ListView源码分析.html">
            
                <span>
            
                    
                    ListView源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.8" data-path="../../docs/05 Android/04 常用类源码分析/LruCache源码分析.html">
            
                <span>
            
                    
                    LruCache源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.9" data-path="../../docs/05 Android/04 常用类源码分析/OkHttp3源码分析.html">
            
                <span>
            
                    
                    OkHttp3源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.10" data-path="../../docs/05 Android/04 常用类源码分析/Retrofit2源码分析.html">
            
                <span>
            
                    
                    Retrofit2源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.11" data-path="../../docs/05 Android/04 常用类源码分析/RxJava2源码分析.html">
            
                <span>
            
                    
                    RxJava2源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.12" data-path="../../docs/05 Android/04 常用类源码分析/SparseArray源码分析.html">
            
                <span>
            
                    
                    SparseArray源码分析.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.4.13" data-path="../../docs/05 Android/04 常用类源码分析/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.5" data-path="../../docs/05 Android/05 性能优化工具/README.md">
            
                <span>
            
                    
                    05 性能优化工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.5.5.1" data-path="../../docs/05 Android/05 性能优化工具/cpu工具.html">
            
                <span>
            
                    
                    cpu工具.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5.5.2" data-path="../../docs/05 Android/05 性能优化工具/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.5.6" data-path="../../docs/05 Android/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../../docs/06 计算机网络/README.md">
            
                <span>
            
                    
                    06 计算机网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.6.1" data-path="../../docs/06 计算机网络/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6.2" data-path="../../docs/06 计算机网络/计算机网络.html">
            
                <span>
            
                    
                    计算机网络.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../../docs/07 设计模式/README.md">
            
                <span>
            
                    
                    07 设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.7.1" data-path="../../docs/07 设计模式/Builder模式.html">
            
                <span>
            
                    
                    Builder模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.2" data-path="../../docs/07 设计模式/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.3" data-path="../../docs/07 设计模式/代理模式.html">
            
                <span>
            
                    
                    代理模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4" data-path="../../docs/07 设计模式/其它设计模式/README.md">
            
                <span>
            
                    
                    其它设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.7.4.1" data-path="../../docs/07 设计模式/其它设计模式/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.2" data-path="../../docs/07 设计模式/其它设计模式/中介者模式.html">
            
                <span>
            
                    
                    中介者模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.3" data-path="../../docs/07 设计模式/其它设计模式/享元模式.html">
            
                <span>
            
                    
                    享元模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.4" data-path="../../docs/07 设计模式/其它设计模式/原型模式.html">
            
                <span>
            
                    
                    原型模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.5" data-path="../../docs/07 设计模式/其它设计模式/命令模式.html">
            
                <span>
            
                    
                    命令模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.6" data-path="../../docs/07 设计模式/其它设计模式/备忘录模式.html">
            
                <span>
            
                    
                    备忘录模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.7" data-path="../../docs/07 设计模式/其它设计模式/外观模式.html">
            
                <span>
            
                    
                    外观模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.8" data-path="../../docs/07 设计模式/其它设计模式/工厂方法模式.html">
            
                <span>
            
                    
                    工厂方法模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.9" data-path="../../docs/07 设计模式/其它设计模式/抽象工厂模式.html">
            
                <span>
            
                    
                    抽象工厂模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.10" data-path="../../docs/07 设计模式/其它设计模式/框架模式.html">
            
                <span>
            
                    
                    框架模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.11" data-path="../../docs/07 设计模式/其它设计模式/桥接模式.html">
            
                <span>
            
                    
                    桥接模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.12" data-path="../../docs/07 设计模式/其它设计模式/模板方法模式.html">
            
                <span>
            
                    
                    模板方法模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.13" data-path="../../docs/07 设计模式/其它设计模式/状态模式.html">
            
                <span>
            
                    
                    状态模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.14" data-path="../../docs/07 设计模式/其它设计模式/策略模式.html">
            
                <span>
            
                    
                    策略模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.15" data-path="../../docs/07 设计模式/其它设计模式/组合模式.html">
            
                <span>
            
                    
                    组合模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.16" data-path="../../docs/07 设计模式/其它设计模式/装饰模式.html">
            
                <span>
            
                    
                    装饰模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.17" data-path="../../docs/07 设计模式/其它设计模式/解释器模式.html">
            
                <span>
            
                    
                    解释器模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.18" data-path="../../docs/07 设计模式/其它设计模式/访问者模式.html">
            
                <span>
            
                    
                    访问者模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.19" data-path="../../docs/07 设计模式/其它设计模式/责任链模式.html">
            
                <span>
            
                    
                    责任链模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.20" data-path="../../docs/07 设计模式/其它设计模式/迭代器模式.html">
            
                <span>
            
                    
                    迭代器模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.21" data-path="../../docs/07 设计模式/其它设计模式/适配器模式.html">
            
                <span>
            
                    
                    适配器模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.4.22" data-path="../../docs/07 设计模式/其它设计模式/静态工厂方法模式.html">
            
                <span>
            
                    
                    静态工厂方法模式.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.7.5" data-path="../../docs/07 设计模式/单例模式.html">
            
                <span>
            
                    
                    单例模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.6" data-path="../../docs/07 设计模式/架构模式.html">
            
                <span>
            
                    
                    架构模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.7" data-path="../../docs/07 设计模式/生产者消费者模式.html">
            
                <span>
            
                    
                    生产者消费者模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7.8" data-path="../../docs/07 设计模式/观察者模式.html">
            
                <span>
            
                    
                    观察者模式.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="../../docs/08 杂项/README.md">
            
                <span>
            
                    
                    08 杂项
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.8.1" data-path="../../docs/08 杂项/git手册/README.md">
            
                <span>
            
                    
                    git手册
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.8.1.1" data-path="../../docs/08 杂项/git手册/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.8.2" data-path="../../docs/08 杂项/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8.3" data-path="../../docs/08 杂项/常用命令/README.md">
            
                <span>
            
                    
                    常用命令
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.8.3.1" data-path="../../docs/08 杂项/常用命令/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.8.4" data-path="../../docs/08 杂项/环境搭建记录/README.md">
            
                <span>
            
                    
                    环境搭建记录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.8.4.1" data-path="../../docs/08 杂项/环境搭建记录/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8.4.2" data-path="../../docs/08 杂项/环境搭建记录/环境搭建.html">
            
                <span>
            
                    
                    环境搭建.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.9" data-path="../../docs/09 Gradle总结/README.md">
            
                <span>
            
                    
                    09 Gradle总结
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.9.1" data-path="../../docs/09 Gradle总结/Gradle总结.html">
            
                <span>
            
                    
                    Gradle总结.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.9.2" data-path="../../docs/09 Gradle总结/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.10" data-path="../../docs/11 知识点/README.md">
            
                <span>
            
                    
                    11 知识点
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.10.1" data-path="../../docs/11 知识点/04-操作系统.html">
            
                <span>
            
                    
                    04-操作系统.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.2" data-path="../../docs/11 知识点/06-数据结构.html">
            
                <span>
            
                    
                    06-数据结构.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.3" data-path="../../docs/11 知识点/07-第三方库.html">
            
                <span>
            
                    
                    07-第三方库.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.4" data-path="../../docs/11 知识点/08-设计模式.html">
            
                <span>
            
                    
                    08-设计模式.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.5" data-path="../../docs/11 知识点/09-算法.html">
            
                <span>
            
                    
                    09-算法.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.6" data-path="../../docs/11 知识点/10-计算机底层基础.html">
            
                <span>
            
                    
                    10-计算机底层基础.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.10.7" data-path="../../docs/11 知识点/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11" data-path="../../docs/gitbook/README.md">
            
                <span>
            
                    
                    gitbook
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.1" data-path="../../docs/gitbook/fonts/README.md">
            
                <span>
            
                    
                    fonts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.1.1" data-path="../../docs/gitbook/fonts/fontawesome/README.md">
            
                <span>
            
                    
                    fontawesome
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.1.1.1" data-path="../../docs/gitbook/fonts/fontawesome/FontAwesome.otf">
            
                <span>
            
                    
                    FontAwesome.otf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.1.1.2" data-path="../../docs/gitbook/fonts/fontawesome/fontawesome-webfont.eot">
            
                <span>
            
                    
                    fontawesome-webfont.eot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.1.1.3" data-path="../../docs/gitbook/fonts/fontawesome/fontawesome-webfont.svg">
            
                <span>
            
                    
                    fontawesome-webfont.svg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.1.1.4" data-path="../../docs/gitbook/fonts/fontawesome/fontawesome-webfont.ttf">
            
                <span>
            
                    
                    fontawesome-webfont.ttf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.1.1.5" data-path="../../docs/gitbook/fonts/fontawesome/fontawesome-webfont.woff">
            
                <span>
            
                    
                    fontawesome-webfont.woff
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.1.1.6" data-path="../../docs/gitbook/fonts/fontawesome/fontawesome-webfont.woff2">
            
                <span>
            
                    
                    fontawesome-webfont.woff2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.2" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/README.md">
            
                <span>
            
                    
                    gitbook-plugin-anchor-navigation-ex
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.2.1" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/lib/README.md">
            
                <span>
            
                    
                    lib
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.2.1.1" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/lib/config.js">
            
                <span>
            
                    
                    config.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.2.1.2" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/lib/log.js">
            
                <span>
            
                    
                    log.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.2.1.3" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/lib/plugin.js">
            
                <span>
            
                    
                    plugin.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.2.2" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/style/README.md">
            
                <span>
            
                    
                    style
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.2.2.1" data-path="../../docs/gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
            
                <span>
            
                    
                    plugin.css
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.3" data-path="../../docs/gitbook/gitbook-plugin-anchors/README.md">
            
                <span>
            
                    
                    gitbook-plugin-anchors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.3.1" data-path="../../docs/gitbook/gitbook-plugin-anchors/plugin.css">
            
                <span>
            
                    
                    plugin.css
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.4" data-path="../../docs/gitbook/gitbook-plugin-expandable-chapters-small/README.md">
            
                <span>
            
                    
                    gitbook-plugin-expandable-chapters-small
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.4.1" data-path="../../docs/gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
            
                <span>
            
                    
                    expandable-chapters-small.css
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.4.2" data-path="../../docs/gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js">
            
                <span>
            
                    
                    expandable-chapters-small.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.5" data-path="../../docs/gitbook/gitbook-plugin-fontsettings/README.md">
            
                <span>
            
                    
                    gitbook-plugin-fontsettings
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.5.1" data-path="../../docs/gitbook/gitbook-plugin-fontsettings/fontsettings.js">
            
                <span>
            
                    
                    fontsettings.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.5.2" data-path="../../docs/gitbook/gitbook-plugin-fontsettings/website.css">
            
                <span>
            
                    
                    website.css
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.6" data-path="../../docs/gitbook/gitbook-plugin-highlight/README.md">
            
                <span>
            
                    
                    gitbook-plugin-highlight
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.6.1" data-path="../../docs/gitbook/gitbook-plugin-highlight/ebook.css">
            
                <span>
            
                    
                    ebook.css
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.6.2" data-path="../../docs/gitbook/gitbook-plugin-highlight/website.css">
            
                <span>
            
                    
                    website.css
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.7" data-path="../../docs/gitbook/gitbook-plugin-livereload/README.md">
            
                <span>
            
                    
                    gitbook-plugin-livereload
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.7.1" data-path="../../docs/gitbook/gitbook-plugin-livereload/plugin.js">
            
                <span>
            
                    
                    plugin.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.8" data-path="../../docs/gitbook/gitbook-plugin-lunr/README.md">
            
                <span>
            
                    
                    gitbook-plugin-lunr
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.8.1" data-path="../../docs/gitbook/gitbook-plugin-lunr/lunr.min.js">
            
                <span>
            
                    
                    lunr.min.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.8.2" data-path="../../docs/gitbook/gitbook-plugin-lunr/search-lunr.js">
            
                <span>
            
                    
                    search-lunr.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.9" data-path="../../docs/gitbook/gitbook-plugin-search/README.md">
            
                <span>
            
                    
                    gitbook-plugin-search
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.9.1" data-path="../../docs/gitbook/gitbook-plugin-search/lunr.min.js">
            
                <span>
            
                    
                    lunr.min.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.9.2" data-path="../../docs/gitbook/gitbook-plugin-search/search-engine.js">
            
                <span>
            
                    
                    search-engine.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.9.3" data-path="../../docs/gitbook/gitbook-plugin-search/search.css">
            
                <span>
            
                    
                    search.css
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.9.4" data-path="../../docs/gitbook/gitbook-plugin-search/search.js">
            
                <span>
            
                    
                    search.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.10" data-path="../../docs/gitbook/gitbook-plugin-sharing/README.md">
            
                <span>
            
                    
                    gitbook-plugin-sharing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.10.1" data-path="../../docs/gitbook/gitbook-plugin-sharing/buttons.js">
            
                <span>
            
                    
                    buttons.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.11" data-path="../../docs/gitbook/gitbook-plugin-splitter/README.md">
            
                <span>
            
                    
                    gitbook-plugin-splitter
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.11.1" data-path="../../docs/gitbook/gitbook-plugin-splitter/splitter.css">
            
                <span>
            
                    
                    splitter.css
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.11.2" data-path="../../docs/gitbook/gitbook-plugin-splitter/splitter.js">
            
                <span>
            
                    
                    splitter.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.12" data-path="../../docs/gitbook/gitbook.js">
            
                <span>
            
                    
                    gitbook.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.13" data-path="../../docs/gitbook/images/README.md">
            
                <span>
            
                    
                    images
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.11.13.1" data-path="../../docs/gitbook/images/apple-touch-icon-precomposed-152.png">
            
                <span>
            
                    
                    apple-touch-icon-precomposed-152.png
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.13.2" data-path="../../docs/gitbook/images/favicon.ico">
            
                <span>
            
                    
                    favicon.ico
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.11.14" data-path="../../docs/gitbook/style.css">
            
                <span>
            
                    
                    style.css
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.11.15" data-path="../../docs/gitbook/theme.js">
            
                <span>
            
                    
                    theme.js
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.12" data-path="../../docs/index.html">
            
                <span>
            
                    
                    index.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.13" data-path="../../docs/search_index.json">
            
                <span>
            
                    
                    search_index.json
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >16 插件化</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;"><b>1. </b>&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;</a></li><li><span class="title-icon "></span><a href="#&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;"><b>2. </b>&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;</a></li><ul><li><span class="title-icon "></span><a href="#&#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;"><b>2.1. </b>&#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;</a></li></ul><li><span class="title-icon "></span><a href="#activity&#x63D2;&#x4EF6;&#x5316;"><b>3. </b>Activity&#x63D2;&#x4EF6;&#x5316;</a></li><ul><li><span class="title-icon "></span><a href="#activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;"><b>3.1. </b>Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;</a></li><li><span class="title-icon "></span><a href="#hook-iactivitymanager&#x65B9;&#x6848;&#x5B9E;&#x73B0;"><b>3.2. </b>Hook IActivityManager&#x65B9;&#x6848;&#x5B9E;&#x73B0;</a></li><ul><li><span class="title-icon "></span><a href="#&#x6CE8;&#x518C;activity&#x8FDB;&#x884C;&#x5360;&#x5751;"><b>3.2.1. </b>&#x6CE8;&#x518C;Activity&#x8FDB;&#x884C;&#x5360;&#x5751;</a></li></ul></ul><li><span class="title-icon "></span><a href="#mht&#xFF0C;aaahcallbackmhhmcallback&#xFF0C;emyapplicationj"><b>4. </b>mHt&#xFF0C;aaahcallback**mHHmCallback&#xFF0C;EMyApplicationJ</a></li><li><span class="title-icon "></span><a href="#0&#xFF09;"><b>5. </b>0&#xFF09;{</a></li><li><span class="title-icon "></span><a href="#r&#x3002;id&#x3002;button&#xFF09;"><b>6. </b>R&#x3002;id&#x3002;button&#xFF09;{</a></li><li><span class="title-icon "></span><a href="#null&#xFF09;"><b>7. </b>null&#xFF09;{</a></li><li><span class="title-icon "></span><a href="#null&#xFF09;thrownewillegalargumentexception&#xFF08;packageinfo&#xFF09;"><b>8. </b>null&#xFF09;thrownewIllegalArgumentException&#xFF08;&quot;packageInfo&quot;&#xFF09;;</a></li></ul></div><a href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;"><a name="&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;" class="anchor-navigation-ex-anchor" href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;</h1>
<p>&#x5728;Android&#x4F20;&#x7EDF;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x4E00;&#x65E6;&#x5E94;&#x7528;&#x7684;&#x4EE3;&#x7801;&#x88AB;&#x6253;&#x5305;&#x6210;APK&#x5E76;&#x88AB;&#x4E0A;&#x4F20;&#x5230;&#x5404;&#x4E2A;&#x6E20;&#x9053;&#x5E02;&#x573A;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x4FEE;&#x6539;&#x5E94;&#x7528;&#x7684;&#x6E90;&#x7801;&#x4E86;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x670D;&#x52A1;&#x5668;&#x6765;&#x63A7;&#x5236;&#x5E94;&#x7528;&#x4E2D;&#x9884;&#x7559;&#x7684;&#x5206;&#x652F;&#x4EE3;&#x7801;&#x3002;&#x4F46;&#x662F;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x65E0;&#x6CD5;&#x63D0;&#x524D;&#x9884;&#x77E5;&#x9700;&#x6C42;&#x548C;&#x7A81;&#x7136;&#x53D1;&#x751F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4E5F;&#x5C31;&#x4E0D;&#x80FD;&#x63D0;&#x524D;&#x5728;&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x4E2D;&#x9884;&#x7559;&#x5206;&#x652F;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x65F6;&#x5C31;&#x9700;&#x8981;&#x91C7;&#x7528;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;&#x3002;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x4E00;&#x4E9B;&#x7A0B;&#x5E8F;&#x4E2D;&#x539F;&#x672C;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5E76;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x3002;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x603B;&#x7684;&#x6765;&#x8BF4;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;so&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;dex&#x76F8;&#x5173;&#x6587;&#x4EF6;&#xFF08;dex&#x4EE5;&#x53CA;&#x5305;&#x542B;dex&#x7684;jar/apk&#x6587;&#x4EF6;&#xFF09;&#x3002;</p>
<p>&#x968F;&#x7740;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x6280;&#x672F;&#x548C;&#x4E1A;&#x52A1;&#x7684;&#x9010;&#x6B65;&#x53D1;&#x5C55;&#xFF0C;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;&#x6D3E;&#x751F;&#x51FA;&#x4E24;&#x4E2A;&#x6280;&#x672F;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x70ED;&#x4FEE;&#x590D;&#x6280;&#x672F;&#x548C;&#x63D2;&#x4EF6;&#x5316;&#x6280;&#x672F;&#xFF0C;&#x5176;&#x4E2D;&#x70ED;&#x4FEE;&#x590D;&#x6280;&#x672F;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x4FEE;&#x590D;Bug&#xFF0C;&#x63D2;&#x4EF6;&#x5316;&#x6280;&#x672F;&#x5219;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x89E3;&#x51B3;&#x5E94;&#x7528;&#x8D8A;&#x6765;&#x8D8A;&#x5E9E;&#x5927;&#x4EE5;&#x53CA;&#x529F;&#x80FD;&#x6A21;&#x5757;&#x7684;&#x89E3;&#x8026;&#xFF0C;&#x56F4;&#x7ED5;&#x7740;&#x4E24;&#x4E2A;&#x6280;&#x672F;&#x51FA;&#x73B0;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x70ED;&#x4FEE;&#x590D;&#x6846;&#x67B6;&#x548C;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;&#x672C;&#x8EAB;&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x5B98;&#x65B9;&#x8BA4;&#x53EF;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x89C4;&#x7684;&#x6280;&#x672F;&#xFF0C;&#x5728;&#x56FD;&#x5916;&#x8FD9;&#x95E8;&#x6280;&#x672F;&#x5173;&#x6CE8;&#x5EA6;&#x5E76;&#x4E0D;&#x9AD8;&#xFF0C;&#x5B83;
&#x7684;&#x4EA7;&#x751F;&#x66F4;&#x591A;&#x7684;&#x662F;&#x56FD;&#x5185;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#x548C;&#x4EA7;&#x54C1;&#x7684;&#x9A71;&#x52A8;&#x3002;</p>
<h1 id="&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;"><a name="&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;" class="anchor-navigation-ex-anchor" href="#&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;</h1>
<h2 id="&#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;"><a name="&#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;" class="anchor-navigation-ex-anchor" href="#&#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. &#x63D2;&#x4EF6;&#x5316;&#x5B9A;&#x4E49;</h2>
<p>&#x91C7;&#x7528;&#x63D2;&#x4EF6;&#x5316;&#x601D;&#x60F3;&#x6765;&#x5BF9;&#x6DD8;&#x5B9D;&#x4E3B;&#x5BA2;&#x6237;&#x7AEF;&#x6846;&#x67B6;&#x8FDB;&#x884C;&#x6539;&#x9020;&#xFF1A;</p>
<p><img src="assets/7.jpg" alt="7" style="zoom:50%;"></p>
<p>&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x7531;&#x5BBF;&#x4E3B;&#x548C;&#x63D2;&#x4EF6;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF0C;&#x5BBF;&#x4E3B;&#x5C31;&#x662F;&#x6307;&#x5148;&#x88AB;&#x5B89;&#x88C5;&#x5230;&#x624B;&#x673A;&#x4E2D;&#x7684;APK&#xFF0C;&#x5C31;&#x662F;&#x5E73;&#x5E38;&#x52A0;&#x8F7D;&#x7684;&#x666E;&#x901A;APK&#x3002;&#x63D2;&#x4EF6;&#x4E00;&#x822C;&#x662F;&#x6307;&#x7ECF;&#x8FC7;&#x5904;&#x7406;&#x7684;APK&#x3001;So&#x548C;dex&#x7B49;&#x6587;&#x4EF6;&#xFF0C;&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x88AB;&#x5BBF;&#x4E3B;&#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#xFF0C;&#x6709;&#x7684;&#x63D2;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;APK&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x53EF;&#x4EE5;&#x5F15;&#x51FA;&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;&#x5C06;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x6309;&#x7167;&#x63D2;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x6539;&#x9020;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x53EB;&#x4F5C;&#x63D2;&#x4EF6;&#x5316;&#x3002;</p>
<h1 id="activity&#x63D2;&#x4EF6;&#x5316;"><a name="activity&#x63D2;&#x4EF6;&#x5316;" class="anchor-navigation-ex-anchor" href="#activity&#x63D2;&#x4EF6;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>3. Activity&#x63D2;&#x4EF6;&#x5316;</h1>
<p>&#x56DB;&#x5927;&#x7EC4;&#x4EF6;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x662F;&#x63D2;&#x4EF6;&#x5316;&#x6280;&#x672F;&#x7684;&#x6838;&#x5FC3;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x800C;Activity&#x63D2;&#x4EF6;&#x5316;&#x66F4;&#x662F;&#x91CD;&#x4E2D;&#x4E4B;&#x91CD;&#xFF0C;Activity&#x63D2;&#x4EF6;&#x5316;&#x4E3B;&#x8981;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x53CD;&#x5C04;&#x5B9E;&#x73B0;&#x3001;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;&#x548C;Hook&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x3002;&#x53CD;&#x5C04;&#x5B9E;&#x73B0;&#x4F1A;&#x5BF9;&#x6027;&#x80FD;&#x6709;&#x6240;&#x5F71;&#x54CD;&#xFF0C;&#x4E3B;&#x6D41;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x6CA1;&#x6709;&#x91C7;&#x7528;&#x6B64;&#x65B9;&#x5F0F;&#xFF0C;&#x5173;&#x4E8E;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x9605;&#x8BFB;dynamic-load-apk&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x4ECB;&#x7ECD;&#xFF0C;&#x76EE;&#x524D;Hook&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x662F;&#x4E3B;&#x6D41;&#xFF0C;&#x56E0;&#x6B64;&#x672C;&#x7AE0;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;Hook&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x3002;</p>
<p>Hook&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x901A;&#x8FC7;HookIActivityManager&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;HookInstrumentation&#x5B9E;&#x73B0;&#x3002;</p>
<h2 id="activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;"><a name="activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;" class="anchor-navigation-ex-anchor" href="#activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;</h2>
<p>&#x6839;Activity&#x7684;&#x542F;&#x52A8;&#xFF1A;&#x9996;&#x5148;Launcher&#x8FDB;&#x7A0B;&#x5411;AMS&#x8BF7;&#x6C42;&#x521B;&#x5EFA;&#x6839;Activity&#xFF0C;AMS&#x4F1A;&#x5224;&#x65AD;&#x6839;Activity&#x6240;&#x9700;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x5E76;&#x542F;&#x52A8;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x5C31;&#x4F1A;&#x8BF7;&#x6C42;Zygote&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x3002;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x542F;&#x52A8;&#x540E;&#xFF0C;AMS&#x4F1A;&#x8BF7;&#x6C42;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x5E76;&#x542F;&#x52A8;&#x6839;Activity&#x3002;</p>
<h2 id="hook-iactivitymanager&#x65B9;&#x6848;&#x5B9E;&#x73B0;"><a name="hook-iactivitymanager&#x65B9;&#x6848;&#x5B9E;&#x73B0;" class="anchor-navigation-ex-anchor" href="#hook-iactivitymanager&#x65B9;&#x6848;&#x5B9E;&#x73B0;"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. Hook IActivityManager&#x65B9;&#x6848;&#x5B9E;&#x73B0;</h2>
<p>AMS&#x5B58;&#x5728;&#x4E8E;SystemServer&#x8FDB;&#x7A0B;&#x4E2D;&#xFF0C;&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#xFF0C;&#x53EA;&#x80FD;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x4E2D;&#x4FEE;&#x6539;&#x3002;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x9884;&#x5148;&#x5360;&#x5751;&#x7136;&#x540E;&#x518D;&#x66FF;&#x6362;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x89E3;&#x51B3;&#x6CA1;&#x6709;&#x5728;AndroidManifest.xml&#x4E2D;&#x663E;&#x5F0F;&#x58F0;&#x660E;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x6CE8;&#x518C;activity&#x8FDB;&#x884C;&#x5360;&#x5751;"><a name="&#x6CE8;&#x518C;activity&#x8FDB;&#x884C;&#x5360;&#x5751;" class="anchor-navigation-ex-anchor" href="#&#x6CE8;&#x518C;activity&#x8FDB;&#x884C;&#x5360;&#x5751;"><i class="fa fa-link" aria-hidden="true"></i></a>3.2.1. &#x6CE8;&#x518C;Activity&#x8FDB;&#x884C;&#x5360;&#x5751;</h3>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x5730;&#x8BB2;&#x89E3;&#x542F;&#x52A8;&#x63D2;&#x4EF6;Activity&#x7684;&#x539F;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x7701;&#x7565;&#x4E86;&#x63D2;&#x4EF6;Activity&#x7684;&#x52A0;&#x8F7D;&#x903B;&#x8F91;&#xFF0C;&#x76F4;&#x63A5;
&#x521B;&#x5EFA;&#x4E00;&#x4E2A;TargetActivity&#x6765;&#x4EE3;&#x8868;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x63D2;&#x4EF6;Activity&#xFF0C;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;
SubActivity*S&#x3002;&#xC6;AndroidManifest&#x3002;xml&#xC8;}SubActivity&#xFF0C;tuTT&#xFF1A;
AndroidManifest&#x3002;xml
&lt;?xmlversion=&quot;1&#x3002;0&quot;encoding=&quot;utf-8&quot;?&gt;</p>
<p><manifestxmlns：android="http： schemas。android。com="" apk="" res="" android"="" package="com&#x3002;example&#x3002;liuwangshu&#x3002;pluginactivity">S</manifestxmlns：android="http：></p>
<p>&lt;application</p>
<p><activityandroid：name="。stubactivity">
&lt;/application&gt;
&lt;/manifest&gt;
TargetActivity&#x7528;&#x6765;&#x4EE3;&#x8868;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x63D2;&#x4EF6;Activity&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x9700;&#x8981;&#x5728;
AndroidManifest&#x3002;xml&#x4E2D;&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x5728;MainActivity&#x4E2D;&#x542F;&#x52A8;TargetActivity&#x80AF;&#x5B9A;
araae&#xFF08;android&#x3002;content&#x3002;ActivityNotFoundException&#xFF09;&#x3002;
15&#x3002;4&#x3002;2&#x3002;2&#x4F7F;&#x7528;&#x5360;&#x5751;Activity&#x901A;&#x8FC7;AMS&#x9A8C;&#x8BC1;
&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x62A5;&#x9519;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x542F;&#x52A8;&#x7684;TargetActivity&#x66FF;&#x6362;&#x4E3A;SubActivity&#xFF0C;&#x7528;SubActivity&#x6765;&#x901A;
&#x8FC7;AMS&#x7684;&#x9A8C;&#x8BC1;&#x3002;&#x5728;&#x7B2C;6&#x7AE0;&#x4E2D;&#x8BB2;&#x8FC7;Android8&#x3002;0&#x4E0E;Android7&#x3002;0&#x7684;AMS&#x5BB6;&#x65CF;&#x6709;&#x4E00;&#x4E9B;&#x5DEE;&#x522B;&#xFF0C;&#x4E3B;
TEAndroid8&#x3002;0EHTAMSfJftActivityManagerProxy&#xFF0C;ft&#xC8;IActivityManager&#xFF0C;
&#x76F4;&#x63A5;&#x91C7;&#x7528;AIDL&#x6765;&#x8FDB;&#x884C;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x3002;Android7&#x3002;0&#x7684;Activity&#x7684;&#x542F;&#x52A8;&#x4F1A;&#x8C03;&#x7528;
ActivityManagerNativefjgetDefaultF&#xA3;&#xFF0C;kuTHizT&#xFF1A;
frameworks/base/core/java/android/app/ActivityManagerNative&#x3002;java
staticpublicIActivityManagergetDefault&#xFF08;&#xFF09;{
returngDefault&#x3002;get&#xFF08;&#xFF09;;
}
354</activityandroid：name="。stubactivity"></p>
<p>Page371
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
privatestatic
finalSingleton<iactivitymanager>gDefault
Singleton
new</iactivitymanager></p>
<p><iactivitymanager>&#xFF08;&#xFF09;{
protectedIActivityManagercreate&#xFF08;&#xFF09;{
IBinderb=
ServiceManager&#x3002;getService&#xFF08;&quot;activity&quot;&#xFF09;;
if&#xFF08;false&#xFF09;{
Log&#x3002;v&#xFF08;&quot;ActivityManager&quot;&#xFF0C;&quot;defaultservicebinder=
%3D
+b&#xFF09;;
IActivityManageram=asInterface&#xFF08;b&#xFF09;;
if&#xFF08;false&#xFF09;{
Log&#x3002;v&#xFF08;&quot;ActivityManager&quot;&#xFF0C;&quot;defaultservice=
+am&#xFF09;;
%3D
returnam;
}
};
getDefaultO&#x162;IActivityManagerActivityManagerf#DTSingleton
&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF0C;&#x800C;&#x4E14;gDefault&#x53C8;&#x662F;&#x9759;&#x6001;&#x7684;&#xFF0C;&#x56E0;&#x6B64;IActivityManager&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x597D;&#x7684;Hook&#x70B9;&#x3002;
Android8&#x3002;0#jActivityfJHaActivityManagerigetService7j#&#xFF0C;KnTBias&#xFF1A;
frameworks/base/core/javalandroid/app/ActivityManager&#x3002;java
publicstaticIActivityManagergetService&#xFF08;&#xFF09;{
returnIActivityManagerSingleton&#x3002;get&#xFF08;&#xFF09;;
privatestaticfinalSingleton<iactivitymanager>IActivityManagerSingleton
newSingleton<iactivitymanager>&#xFF08;&#xFF09;{
@Override
protectedIActivityManagercreate&#xFF08;&#xFF09;{
finalIBinderb
ServiceManager&#x3002;getService&#xFF08;Context&#x3002;ACTIVITY
SERVICE&#xFF09;;
finalIActivityManageram=
IActivityManager&#x3002;Stub&#x3002;asInterface&#xFF08;b&#xFF09;;
returnam;
};
&#x540C;&#x6837;&#x5730;&#xFF0C;getService&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E86;IActivityManager&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;IActivityManager
&#x501F;&#x52A9;&#x4E86;Singleton&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF0C;&#x518D;&#x7ED3;&#x5408;&#x56FE;6-1&#x548C;6-3&#xFF0C;&#x786E;&#x5B9A;&#x4E86;&#x65E0;&#x8BBA;&#x662F;Android7&#x3002;0&#x8FD8;&#x662F;Android
8&#x3002;0&#xFF0C;IActivityManager&#x90FD;&#x662F;&#x6BD4;&#x8F83;&#x597D;&#x7684;Hook&#x70B9;&#x3002;Singleton&#x7C7B;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x7528;&#x5230;&#xFF1A;
frameworks/base/core/java/android/util/Singleton&#x3002;java
icabstractclassSingleton<t>{
privateTmInstance;
protectedabstractTcreate&#xFF08;&#xFF09;;
355</t></iactivitymanager></iactivitymanager></iactivitymanager></p>
<p>Page372
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
publicfinalTget&#xFF08;&#xFF09;{
synchronized&#xFF08;this&#xFF09;{
if&#xFF08;mInstance
null&#xFF09;{
mInstance=create&#xFF08;&#xFF09;;
}
returnmInstance;
&#x7531;&#x4E8E;Hook&#x9700;&#x8981;&#x591A;&#x6B21;&#x5BF9;&#x5B57;&#x6BB5;&#x8FDB;&#x884C;&#x53CD;&#x5C04;&#x64CD;&#x4F5C;&#xFF0C;&#x5148;&#x5199;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x5DE5;&#x5177;&#x7C7B;FieldUtil&#xFF1A;
FieldUtil&#x3002;java
publicclassFieldUtil{
publicstaticObjectgetField&#xFF08;Classclazz&#xFF0C;Objecttarget&#xFF0C;Stringname&#xFF09;throws
Exception{
Fieldfield=clazz&#x3002;getDeclaredField&#xFF08;name&#xFF09;;
field&#x3002;setAccessible&#xFF08;true&#xFF09;;
returnfield&#x3002;get&#xFF08;target&#xFF09;;
}
publicstaticFieldgetField&#xFF08;Classclazz&#xFF0C;Stringname&#xFF09;throwsException{
Fieldfield=clazz&#x3002;getDeclaredField&#xFF08;name&#xFF09;;
field&#x3002;setAccessible&#xFF08;true&#xFF09;;
returnfield;
}
publicstaticvoidsetField&#xFF08;Classclazz&#xFF0C;Objecttarget&#xFF0C;Stringname&#xFF0C;Objectvalue&#xFF09;
throwsException{
Fieldfield=clazz&#x3002;getDeclaredField&#xFF08;name&#xFF09;;
field&#x3002;setAccessible&#xFF08;true&#xFF09;;
field&#x3002;set&#xFF08;target&#xFF0C;value&#xFF09;;
}
&#x5176;&#x4E2D;setField&#x65B9;&#x6CD5;&#x4E0D;&#x4F1A;&#x9A6C;&#x4E0A;&#x7528;&#x5230;&#xFF0C;&#x63A5;&#x7740;&#x5B9A;&#x4E49;&#x66FF;&#x6362;IActivityManager&#x7684;&#x4EE3;&#x7406;&#x7C7B;
IActivityManagerProxy&#xFF0C;uFi&#xFF1A;
publicclassIActivityManagerProxyimplementsInvocationHandler{
privateObjectmActivityManager;
privatestaticfinalStringTAG=
&quot;IActivityManagerProxy&quot;;
publicIActivityManagerProxy&#xFF08;ObjectactivityManager&#xFF09;
this&#x3002;mActivityManager
activityManager;
%3D
}
@Override
publicObjectinvoke&#xFF08;Objecto&#xFF0C;Methodmethod&#xFF0C;Object[]args&#xFF09;throwsThrowable{
if&#xFF08;&quot;startActivity&quot;&#x3002;equals&#xFF08;method&#x3002;getName&#xFF08;&#xFF09;&#xFF09;&#xFF09;{//1
Intentintent=null;
356</p>
<p>Page373
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
intindex=0;
for&#xFF08;inti=0;i<args。length;i++）{ 3="" 4="" if（args[i]instanceofintent）{="" index="i;" break;="" （intent）args[index];="" intentsubintent="newIntent&#xFF08;&#xFF09;;//2" intent="StringpackageName" "com。example。liuwangshu。pluginactivity";="" subintent。setclassname（packagename，packagename+"。stubactivity"）;="" subintent。putextra（hookhelper。targetintent，intent）;="" args[index]="subIntent;//5" }="" returnmethod。invoke（mactivitymanager，args）;="" hook点iactivitymanager是一个接口，建议采用动态代理。在注释1处拦截startactivity="" 方法，接着获取参数args中第一个intent对象，它原本要启动插件targetactivity的intent。="" 在注释2、注释3处新建一个sublntent用来启动stubactivity，在注释4处将这个="" targetactivity的intent保存到subintent中，便于以后还原targetactivity。在注释5处用="" sublntent赋值给参数args，这样启动的目标就变为了stubactivity，用来通过ams的校验。="" rhahahaaaactivitymanagerproxy**iactivitymanager，ufpizi：="" hookhelper。java="" publicclasshookhelper{="" publicstaticfinalstringtargetintent="target_intent" ;="" publicstaticvoidhookams（）throwsexception{="" objectdefaultsingleton="null;" if（build。version。sdkint="">=26&#xFF09;{//1
Class&lt;?&gt;activityManageClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ActivityManager&quot;&#xFF09;;
//#activityManagerfIActivityManagerSingleton*
defaultSingleton=FieldUtil&#x3002;getField&#xFF08;activityManageClazz&#xFF0C;null&#xFF0C;
&quot;IActivityManagerSingleton&quot;&#xFF09;;
}else{
Class&lt;?&gt;activityManagerNativeClazz
=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;
ActivityManagerNative&quot;&#xFF09;;
//#ActivityManagerNative&#x2020;#gDefault
defaultSingleton=FieldUtil&#x3002;getField&#xFF08;activityManagerNativeClazz&#xFF0C;null&#xFF0C;
&quot;gDefault&quot;&#xFF09;;
}
Class&lt;?&gt;singletonClazz
=Class&#x3002;forName&#xFF08;&quot;android&#x3002;util&#x3002;Singleton&quot;&#xFF09;;
357</args。length;i++）{></p>
<p>Page374
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
FieldmInstanceField=FieldUtil&#x3002;getField&#xFF08;singletonClazz&#xFF0C;&quot;mInstance&quot;&#xFF09;;//2
//<em>iActivityManager
ObjectiActivityManager=mInstanceField&#x3002;get&#xFF08;defaultSingleton&#xFF09;;//3
Class&lt;?&gt;iActivityManagerClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;IActivityManager&quot;&#xFF09;;
Objectproxy
Proxy&#x3002;newProxyInstance&#xFF08;Thread&#x3002;currentThread&#xFF08;&#xFF09;&#x3002;getContext
%3D
ClassLoader&#xFF08;&#xFF09;&#xFF0C;newClass&lt;?&gt;[]{iActivityManagerClazz}&#xFF0C;new
IactivityManagerProxy&#xFF08;iActivityManager&#xFF09;&#xFF09;;
mInstanceField&#x3002;set&#xFF08;defaultSingleton&#xFF0C;proxy&#xFF09;;
}
&#x9996;&#x5148;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x5BF9;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x8FDB;&#x884C;&#x533A;&#x5206;&#xFF0C;&#x6700;&#x7EC8;&#x83B7;&#x53D6;&#x7684;&#x662F;Singleton<iactivitymanager>&#x7C7B;&#x578B;
HJIActivityManagerSingletongDefault&#x3002;E&#xC8;#2LSingletonmInstance
&#x5B57;&#x6BB5;&#xFF0C;&#x4ECE;&#x524D;&#x9762;Singleton&#x7C7B;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;mlnstance&#x5B57;&#x6BB5;&#x7684;&#x7C7B;&#x578B;&#x578B;&#x4E3A;T&#xFF0C;&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x5F97;&#x5230;
IActivityManagerSingletongDefault#O&#xFF0C;T&#xCD;J</iactivitymanager></em>HIActivityManager&#xFF0C;
&#x6700;&#x540E;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x4EE3;&#x7406;&#x7C7B;IActivityManagerProxy&#xFF0C;&#x7528;IActivityManagerProxy&#x6765;&#x66FF;&#x6362;
IActivityManager&#xFF0C;&#xC1;&#xC8;X-&#x2191;Application&#xFF0C;&#xC6;##AHookHelper#jhookAMSF&#xA3;&#xFF0C;kI
&#x4E0B;&#x6240;&#x793A;&#xFF1A;
MyApplication&#x3002;java
publicclassMyApplicationextendsApplication{
@Override
publicvoidattachBaseContext&#xFF08;Contextbase&#xFF09;{
super&#x3002;attachBaseContext&#xFF08;base&#xFF09;;
try{
HookHelper&#x3002;hookAMS&#xFF08;&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
&#x5728;MainActivity&#x4E2D;&#x542F;&#x52A8;TargetActivity&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
MainActivity&#x3002;java
publicclassMainActivityextendsActivity{
privateButtonbthook;
@Override
protectedvoidonCreate&#xFF08;BundlesavedInstanceState&#xFF09;{
super&#x3002;onCreate&#xFF08;savedInstanceState&#xFF09;;
setContentView&#xFF08;R&#x3002;layout&#x3002;activity_main&#xFF09;;
bt_hook=&#xFF08;Button&#xFF09;this&#x3002;findViewById&#xFF08;R&#x3002;id&#x3002;bt_hook&#xFF09;;
bthook&#x3002;setOnClickListener&#xFF08;newView&#x3002;OnClickListener&#xFF08;&#xFF09;{
358</p>
<p>Page375
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
@Override
publicvoidonClick&#xFF08;Viewview&#xFF09;{
Intentintent=newIntent&#xFF08;MainActivity&#x3002;this&#xFF0C;TargetActivity&#x3002;class&#xFF09;;
startActivity&#xFF08;intent&#xFF09;;
&#x4E00;
}&#xFF09;;
&#x4E00;
}
&#x70B9;&#x51FB;Button&#x65F6;&#xFF0C;&#x542F;&#x52A8;&#x7684;&#x5E76;&#x4E0D;&#x662F;TargetActivity&#x800C;&#x662F;SubActivity&#xFF0C;&#x540C;&#x65F6;Log&#x4E2D;&#x6253;&#x5370;&#x4E86;&#x201C;hook
&#x6210;&#x529F;&#x201D;&#xFF0C;&#x8BF4;&#x660E;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x7528;SubActivity&#x901A;&#x8FC7;&#x4E86;AMS&#x7684;&#x6821;&#x9A8C;&#x3002;
15&#x3002;4&#x3002;2&#x3002;3&#x8FD8;&#x539F;&#x63D2;&#x4EF6;Activity
&#x524D;&#x9762;&#x7528;&#x5360;&#x5751;Activity&#x901A;&#x8FC7;&#x4E86;AMS&#x7684;&#x6821;&#x9A8C;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x8981;&#x542F;&#x52A8;&#x7684;&#x662F;&#x63D2;&#x4EF6;TargetActivity&#xFF0C;&#x8FD8;
&#x9700;&#x8981;&#x7528;&#x63D2;&#x4EF6;TargetActivity&#x6765;&#x66FF;&#x6362;&#x5360;&#x5751;&#x7684;SubActivity&#xFF0C;&#x8FD9;&#x4E00;&#x66FF;&#x6362;&#x7684;&#x65F6;&#x673A;&#x5C31;&#x5728;&#x56FE;15-7&#x6240;&#x793A;&#x7684;
&#x6B65;&#x9AA4;2&#x4E4B;&#x540E;&#x3002;&#x5728;4&#x3002;1&#x3002;3&#x8282;&#x4E2D;&#x8BB2;&#x5230;&#x4E86;ActivityThread&#x542F;&#x52A8;Activity&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x5982;&#x56FE;15-8&#x6240;&#x793A;&#x3002;
ApplicationThread
ActivityThread
H
Instrumentation
Activity
-schedulelaunchActivity
-sendMessage
-handleMessage-
KhandlelaunchActivity-
performlaunchActivity
callActivityOnCreate-
-performCreate-
onCreate
&#x56FE;15-8ActivityThread&#x542F;&#x52A8;Activity&#x7684;&#x8FC7;&#x7A0B;
ActivityThread&#x4F1A;&#x901A;&#x8FC7;H&#x7C7B;&#x5C06;&#x4EE3;&#x7801;&#x7684;&#x903B;&#x8F91;&#x5207;&#x6362;&#x5230;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;H&#x7C7B;&#x662F;ActivityThread&#x7684;&#x5185;
&#x90E8;&#x7C7B;&#x5E76;&#x7EE7;&#x627F;&#x81EA;Handler&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
359</p>
<p>Page376
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
frameworks/base/lcore/java/android/app/ActivityThread&#x3002;java
privateclassHextendsHandler{
publicstaticfinalintLAUNCHACTIVITY=100;
publicstaticfinalintPAUSEACTIVITY=101;
publicvoidhandleMessage&#xFF08;Messagemsg&#xFF09;{
if&#xFF08;DEBUG_MESSAGES&#xFF09;Slog&#x3002;v&#xFF08;TAG&#xFF0C;&quot;&gt;&gt;&gt;handling&#xFF1A;
+codeToString&#xFF08;msg&#x3002;
what&#xFF09;&#xFF09;;
switch&#xFF08;msg&#x3002;what&#xFF09;{
caseLAUNCHACTIVITY&#xFF1A;{
Trace&#x3002;traceBegin&#xFF08;Trace&#x3002;TRACE_TAG_ACTIVITY_MANAGER&#xFF0C;&quot;activityStart&quot;&#xFF09;;
finalActivityClientRecordr=
&#xFF08;ActivityClientRecord&#xFF09;msg&#x3002;obj;
r&#x3002;packageInfo=getPackageInfoNoCheck&#xFF08;
r&#x3002;activityInfo&#x3002;applicationInfo&#xFF0C;r&#x3002;compatInfo&#xFF09;;
handleLaunchActivity&#xFF08;r&#xFF0C;null&#xFF0C;&quot;LAUNCH_ACTIVITY&quot;&#xFF09;;
Trace&#x3002;traceEnd&#xFF08;Trace&#x3002;TRACETAGACTIVITYMANAGER&#xFF09;;
}break;
}
H&#x7C7B;&#x4E2D;&#x91CD;&#x5199;&#x7684;handleMessage&#x65B9;&#x6CD5;&#x4F1A;&#x5BF9;LAUNCH_ACTIVITY&#x7C7B;&#x578B;&#x7684;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x6700;
&#x7EC8;&#x4F1A;&#x8C03;&#x7528;Activity&#x7684;onCreate&#x65B9;&#x6CD5;&#x3002;&#x90A3;&#x4E48;&#x5728;&#x54EA;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x5462;?&#x63A5;&#x7740;&#x6765;&#x770B;Handler&#x7684;
dispatchMessage
frameworks/base/core/javalandroid/os/Handler&#x3002;java
publicvoiddispatchMessage&#xFF08;Messagemsg&#xFF09;{
if&#xFF08;msg&#x3002;callback!=null&#xFF09;{
handleCallback&#xFF08;msg&#xFF09;;
}else{
if&#xFF08;mCallback!=null&#xFF09;{
if&#xFF08;mCallback&#x3002;handleMessage&#xFF08;msg&#xFF09;&#xFF09;{
return;
}
handleMessage&#xFF08;msg&#xFF09;;
}
}
Handler#jdispatchMessageHFL&#xFF0C;AAHandlerjCallback*I
mCallback&#x4E0D;&#x4E3A;null&#xFF0C;&#x5C31;&#x4F1A;&#x6267;&#x884C;mCallback&#x7684;handleMessage&#x65B9;&#x6CD5;&#x3002;&#x56E0;&#x6B64;&#xFF0C;mCallback&#x53EF;&#x4EE5;&#x4F5C;
360</p>
<p>Page377
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
&#x4E3A;Hook&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x7684;Callback&#x6765;&#x66FF;&#x6362;mCallback&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x7684;Callback&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
HCallback&#x3002;java
publicclassHCallbackimplementsHandler&#x3002;Callback{
publicstaticfinalintLAUNCHACTIVITY=100;
HandlermHandler;
publicHCallback&#xFF08;Handlerhandler&#xFF09;
mHandler=handler;
}
@Override
publicbooleanhandleMessage&#xFF08;Messagemsg&#xFF09;{
if&#xFF08;msg&#x3002;what
LAUNCHACTIVITY&#xFF09;{
Objectr=msg&#x3002;obj;
try{
//&#x5F97;&#x5230;&#x6D88;&#x606F;&#x4E2D;&#x7684;Intent&#xFF08;&#x542F;&#x52A8;SubActivity&#x7684;Intent&#xFF09;
Intentintent=
&#xFF08;Intent&#xFF09;FieldUtil&#x3002;getField&#xFF08;r&#x3002;getClass&#xFF08;&#xFF09;&#xFF0C;r&#xFF0C;&quot;intent&quot;&#xFF09;;
//tE<em>Intent&#xFF08;&#xC0;TargetActivity#Intent&#xFF09;
Intenttarget=intent&#x3002;getParcelableExtra&#xFF08;HookHelper&#x3002;TARGETINTENT&#xFF09;;
//</em>subActivityIntent**TargetActivity#Intent
intent&#x3002;setComponent&#xFF08;target&#x3002;getComponent&#xFF08;&#xFF09;&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
mHandler&#x3002;handleMessage&#xFF08;msg&#xFF09;;
returntrue;
}
}
HCallback&#x5B9E;&#x73B0;&#x4E86;Handler&#x3002;Callback&#xFF0C;&#x5E76;&#x91CD;&#x5199;&#x4E86;handleMessage&#x65B9;&#x6CD5;&#xFF0C;&#x5F53;&#x6536;&#x5230;&#x6D88;&#x606F;&#x7684;&#x7C7B;&#x578B;
&#x4E3A;LAUNCH_ACTIVITY&#x65F6;&#xFF0C;&#x5C06;&#x542F;&#x52A8;SubActivity&#x7684;Intent&#x66FF;&#x6362;&#x4E3A;&#x542F;&#x52A8;TargetActivity&#x7684;Intent&#x3002;
&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x5728;HookHelper&#x4E2D;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;hookHandler&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
HookHelper&#x3002;java
publicstaticvoidhookHandler&#xFF08;&#xFF09;throwsException{
Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ActivityThread&quot;&#xFF09;;
ObjectcurrentActivityThread=FieldUtil&#x3002;getField&#xFF08;activityThreadClass&#xFF0C;null&#xFF0C;
Class&lt;?&gt;activityThreadClass
%3D
&quot;sCurrentActivityThread&quot;&#xFF09;;//1
FieldmHField=FieldUtil&#x3002;getField&#xFF08;activityThread&#xFF0C;&quot;mH&quot;&#xFF09;;//2
&#xFF08;Handler&#xFF09;mHField&#x3002;get&#xFF08;currentActivityThread&#xFF09;;//3
FieldUtil&#x3002;setField&#xFF08;Handler&#x3002;class&#xFF0C;mH&#xFF0C;&quot;mCallback&quot;&#xFF0C;newHCallback&#xFF08;mH&#xFF09;&#xFF09;;
HandlermH=
}
361</p>
<p>Page378
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
ActivityThread&#x7C7B;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x53D8;&#x91CF;sCurrentActivityThread&#xFF0C;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x5F53;&#x524D;&#x7684;
ActivityThreadt&#xFF0C;AEEE#1L*ActivityThread#&#xC8;XJsCurrentActivityThread
&#x5BF9;&#x8C61;&#x3002;&#x6CE8;&#x91CA;2&#x5904;&#x83B7;&#x53D6;ActivityThread&#x7C7B;&#x7684;mH&#x5B57;&#x6BB5;&#xFF0C;&#x63A5;&#x7740;&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x83B7;&#x53D6;&#x5F53;&#x524D;ActivityThread</p>
<h1 id="mht&#xFF0C;aaahcallbackmhhmcallback&#xFF0C;emyapplicationj"><a name="mht&#xFF0C;aaahcallbackmhhmcallback&#xFF0C;emyapplicationj" class="anchor-navigation-ex-anchor" href="#mht&#xFF0C;aaahcallbackmhhmcallback&#xFF0C;emyapplicationj"><i class="fa fa-link" aria-hidden="true"></i></a>4. mHt&#xFF0C;aaahcallback**mHHmCallback&#xFF0C;EMyApplicationJ</h1>
<p>attachBaseContext&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;HookHelper&#x7684;hookHandler&#x65B9;&#x6CD5;&#xFF0C;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x5355;&#x51FB;&#x201C;&#x542F;
&#x52A8;&#x63D2;&#x4EF6;&#x201D;&#x6309;&#x94AE;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x542F;&#x52A8;&#x7684;&#x662F;&#x63D2;&#x4EF6;TargetActivity&#x3002;
15&#x3002;4&#x3002;2&#x3002;4&#x63D2;&#x4EF6;Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;
&#x63D2;&#x4EF6;TargetActivity&#x786E;&#x5B9E;&#x542F;&#x52A8;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x6709;&#x751F;&#x547D;&#x5468;&#x671F;&#x5417;?&#x8FD9;&#x91CC;&#x4ECE;&#x6E90;&#x7801;&#x89D2;&#x5EA6;&#x6765;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;
Activity&#x7684;finish&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x53D8;&#x5316;&#xFF0C;&#x548C;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x7C7B;&#x4F3C;&#xFF0C;finish
&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
frameworks/base/core/javalandroid/app/Activity&#x3002;java
publicvoidfinish&#xFF08;&#xFF09;{
finish&#xFF08;DONTFINISHTASKWITHACTIVITY&#xFF09;;
}
privatevoidfinish&#xFF08;intfinishTask&#xFF09;{
if&#xFF08;mParent==null&#xFF09;{
intresultCode;
IntentresultData;
synchronized&#xFF08;this&#xFF09;{
resultCode=mResultCode;
resultData=mResultData;
if&#xFF08;false&#xFF09;Log&#x3002;v&#xFF08;TAG&#xFF0C;&quot;Finishingself&#xFF1A;token=&quot;+mToken&#xFF09;;
try{
if&#xFF08;resultData!=null&#xFF09;{
resultData&#x3002;prepareToLeaveProcess&#xFF08;this&#xFF09;;
if&#xFF08;ActivityManager&#x3002;getService&#xFF08;&#xFF09;
&#x3002;finishActivity&#xFF08;mToken&#xFF0C;resultCode&#xFF0C;resultData&#xFF0C;finishTask&#xFF09;&#xFF09;
{//1
mFinished=true;
}
}catch&#xFF08;RemoteExceptione&#xFF09;{
//Empty
}else{
mParent&#x3002;finishFromChild&#xFF08;this&#xFF09;;
}
}
362</p>
<p>Page379
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
finish&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x94FE;&#x548C;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x8C03;&#x7528;AMS&#x7684;
finishActivity&#xFF0C;EREAMS1itApplicationThreadiActivityThread&#xFF0C;ActivityThread
&#x5411;H&#x7C7B;&#x53D1;&#x9001;DESTROY_ACTIVITY&#x7C7B;&#x578B;&#x7684;&#x6D88;&#x606F;&#xFF0C;H&#x7C7B;&#x63A5;&#x6536;&#x5230;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x4F1A;&#x6267;&#x884C;
handleDestroyActivityk&#xFF0C;handleDestroyActivityXperformDestroyActivity
&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
frameworks/base/core/javalandroid/app/ActivityThread&#x3002;java
privateActivityClientRecordperformDestroyActivity&#xFF08;IBinder
token&#xFF0C;
boolean
finishing&#xFF0C;intconfigChanges&#xFF0C;booleangetNonConfigInstance&#xFF09;{
ActivityClientRecordr
=mActivities&#x3002;get&#xFF08;token&#xFF09;;//1
try{
r&#x3002;activity&#x3002;mCalled
=false;
mInstrumentation&#x3002;callActivityOnDestroy&#xFF08;r&#x3002;activity&#xFF09;;//2
}catch&#xFF08;SuperNotCalledExceptione&#xFF09;{
}
}
mActivities&#x3002;remove&#xFF08;token&#xFF09;;
StrictMode&#x3002;decrementExpectedActivityCount&#xFF08;activityClass&#xFF09;;
returnr;
E&#xC8;1LtIBinder<em>token*</em>ActivityClientRecord&#xFF0C;ActivityClientRecord
HTaA+6Activity&#xFF0C;EE2LInstrumentationjcallActivityOnDestroy
&#x65B9;&#x6CD5;&#x6765;&#x8C03;&#x7528;Activity&#x7684;OnDestroy&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x4E86;r&#x3002;activity&#x3002;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6211;&#x4EEC;&#x7528;SubActivity
&#x66FF;&#x6362;&#x4E86;TargetActivity&#x901A;&#x8FC7;&#x4E86;AMS&#x7684;&#x6821;&#x9A8C;&#xFF0C;&#x8FD9;&#x6837;AMS&#x53EA;&#x77E5;&#x9053;SubActivity&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;AMS
&#x662F;&#x5982;&#x4F55;&#x80FD;&#x63A7;&#x5236;TargetActivity&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x56DE;&#x8C03;&#x7684;&#x5462;?&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x5F80;&#x4E0B;&#x770B;&#xFF0C;&#x542F;&#x52A8;Activity&#x65F6;&#x4F1A;&#x8C03;
HActivityThreadfjperformLaunchActivity&#xFF0C;knF&#xFF1A;
frameworks/base/core/javalandroid/app/ActivityThread&#x3002;java
privateActivityperformLaunchActivity&#xFF08;ActivityClientRecordr&#xFF0C;IntentcustomIntent&#xFF09;{
java&#x3002;lang&#x3002;ClassLoadercl=
appContext&#x3002;getClassLoader&#xFF08;&#xFF09;;
activity
mInstrumentation&#x3002;newActivity&#xFF08;
%3D
cl&#xFF0C;component&#x3002;getClassName&#xFF08;&#xFF09;&#xFF0C;r&#x3002;intent&#xFF09;;//1
activity&#x3002;attach&#xFF08;appContext&#xFF0C;this&#xFF0C;getInstrumentation&#xFF08;&#xFF09;&#xFF0C;r&#x3002;token&#xFF0C;r&#x3002;ident&#xFF0C;
app&#xFF0C;r&#x3002;intent&#xFF0C;r&#x3002;activityInfo&#xFF0C;title&#xFF0C;r&#x3002;parent&#xFF0C;r&#x3002;embeddedID&#xFF0C;
r&#x3002;lastNonConfigurationInstances&#xFF0C;config&#xFF0C;r&#x3002;referrer&#xFF0C;
r&#x3002;voiceInteractor&#xFF0C;window&#xFF0C;r&#x3002;configCallback&#xFF09;;
363</p>
<p>Page380
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
mActivities&#x3002;put&#xFF08;r&#x3002;token&#xFF0C;r&#xFF09;;//2
returnactivity;
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x6839;&#x636E;Activity&#x7684;&#x7C7B;&#x540D;&#x7528;ClassLoader&#x52A0;&#x8F7D;Acitivty&#xFF0C;&#x63A5;&#x7740;&#x8C03;&#x7528;Activity&#x7684;atach
&#x65B9;&#x6CD5;&#xFF0C;&#x5C06;rtoken&#x8D4B;&#x503C;&#x7ED9;Activity&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;mToken&#x3002;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x5C06;ActivityClientRecord&#x6839;
Er&#x3002;token&#xFF08;RFEmActivities&#xFF08;mActivities*Y%ArrayMap<ibinder，activityclientrecord>&#xFF09;&#xFF0C;
&#x518D;&#x7ED3;&#x5408;Activity&#x7684;finish&#x65B9;&#x6CD5;&#x7684;&#x6CE8;&#x91CA;1&#x5904;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#x7ED3;&#x8BBA;&#xFF1A;AMS&#x548C;ActivityThread&#x4E4B;&#x95F4;&#x7684;&#x901A;
&#x4FE1;&#x91C7;&#x7528;&#x4E86;token&#x6765;&#x5BF9;Activity&#x8FDB;&#x884C;&#x6807;&#x8BC6;&#xFF0C;&#x5E76;&#x4E14;&#x6B64;&#x540E;&#x7684;Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5904;&#x7406;&#x4E5F;&#x662F;&#x6839;&#x636E;token
&#x6765;&#x5BF9;Activity&#x8FDB;&#x884C;&#x6807;&#x8BC6;&#x7684;&#x3002;&#x56DE;&#x5230;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x5728;Activity&#x542F;&#x52A8;&#x65F6;&#x7528;&#x63D2;&#x4EF6;TargetActivity
&#x66FF;&#x6362;&#x5360;&#x5751;SubActivity&#xFF0C;&#x8FD9;&#x4E00;&#x8FC7;&#x7A0B;&#x5728;performLaunchActivity&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x56E0;&#x6B64;&#x6CE8;&#x91CA;2&#x5904;&#x7684;
r&#x3002;tokenTargetActivity&#xFF0C;&#xA3;performDestroyActivityE1Kaae
TargetActivityjActivityClientRecord&#xFF0C;JNTargetActivityhaftA&#x3002;
15&#x3002;4&#x3002;3HookInstrumentationa
HookInstrumentation&#x5B9E;&#x73B0;&#x8981;&#x6BD4;HookIActivityManager&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x4E00;&#x4E9B;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x4F1A;&#x548C;
HookIActivityManagerF&#xFF0C;&#xCD;IOMELH&#x3002;HookInstrumentationM
&#x540C;&#x6837;&#x4E5F;&#x9700;&#x8981;&#x7528;&#x5230;&#x5360;&#x5751;Activity&#xFF0C;&#x4E0E;HOOIActivityManager&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x7528;&#x5360;&#x5751;Activity&#x66FF;
&#x6362;&#x63D2;&#x4EF6;Activity&#x4EE5;&#x53CA;&#x8FD8;&#x539F;&#x63D2;&#x4EF6;Activity&#x7684;&#x5730;&#x65B9;&#x4E0D;&#x540C;&#x3002;Acitivty&#x7684;startActivity&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x65F6;&#x5E8F;&#x56FE;
&#x5982;&#x56FE;15-9&#x6240;&#x793A;&#x3002;
&#x4ECE;&#x56FE;15-9&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x5728;Activity&#x901A;&#x8FC7;AMS&#x6821;&#x9A8C;&#x524D;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;Activity&#x7684;
startActivityForResultj&#xFF1A;
frameworks/base/core/javalandroid/app/Activity&#x3002;java
publicvoidstartActivityForResult&#xFF08;@RequiresPermissionIntentintent&#xFF0C;intrequestCode&#xFF0C;
@NullableBundleoptions&#xFF09;{
if&#xFF08;mParent==null&#xFF09;{
options
transferSpringboardActivityOptions&#xFF08;options&#xFF09;;
Instrumentation&#x3002;ActivityResultar=
mInstrumentation&#x3002;execStartActivity&#xFF08;
this&#xFF0C;mMainThread&#x3002;getApplicationThread&#xFF08;&#xFF09;&#xFF0C;mToken&#xFF0C;this&#xFF0C;
intent&#xFF0C;requestCode&#xFF0C;options&#xFF09;;
}else{
364</ibinder，activityclientrecord></p>
<p>Page381
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
Activity
Instrumentation
IActivityManager
AMS
startActivity
startActivityForResult
-execStartActivity-
-startActivity-
startActivity-
&#x56FE;15-9Acitivty&#x7684;startActivity&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x65F6;&#x5E8F;&#x56FE;
EstartActivityForResultATInstrumentationJexecStartActivityifi
Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x3002;
&#x56FE;15-8&#x4E2D;&#x4F1A;&#x8C03;&#x7528;ActivityThread&#x7684;performLaunchActivity&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
frameworks/base/core/javalandroid/app/ActivityThread&#x3002;java
privateActivityperformLaunchActivity&#xFF08;ActivityClientRecordr&#xFF0C;IntentcustomIntent&#xFF09;{
//&#x521B;&#x5EFA;&#x8981;&#x542F;&#x52A8;Activity&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x73AF;&#x5883;
ContextImplappContext=createBaseContextForActivity&#xFF08;r&#xFF09;;
Activityactivity
=null;
try{
java&#x3002;lang&#x3002;ClassLoadercl=
appContext&#x3002;getClassLoader&#xFF08;&#xFF09;;
1/&#x7528;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x4F86;&#x521B;&#x5EFA;Activity&#x7684;&#x5B9E;&#x4F8B;
activity=mInstrumentation&#x3002;newActivity&#xFF08;
cl&#xFF0C;component&#x3002;getClassName&#xFF08;&#xFF09;&#xFF0C;r&#x3002;intent&#xFF09;;//1
}catch&#xFF08;Exceptione&#xFF09;{
returnactivity;
}
365</p>
<p>Page382
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x8C03;&#x7528;&#x4E86;mInstrumentation&#x7684;newActivity&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x4F1A;&#x7528;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x6765;&#x521B;&#x5EFA;
Activity&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x65B9;&#x6848;&#xFF0C;&#x5C31;&#x662F;&#x5728;Instrumentation&#x7684;execStartActivity
&#x65B9;&#x6CD5;&#x4E2D;&#x7528;&#x5360;&#x5751;SubActivity&#x6765;&#x901A;&#x8FC7;AMS&#x7684;&#x9A8C;&#x8BC1;&#xFF0C;&#x5728;Instrumentation&#x7684;newActivity&#x65B9;&#x6CD5;&#x4E2D;&#x8FD8;
&#x539F;TargetActivity&#xFF0C;&#x8FD9;&#x4E24;&#x90E8;&#x64CD;&#x4F5C;&#x90FD;&#x548C;Instrumentation&#x6709;&#x5173;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x7684;
Instrumentation**mInstrumentation&#xFF0C;A0&#xCD;&#xC8;L-&#x2191;Instrumentation&#xFF0C;E
execStartActivityaTargetActivitySubActivity&#xFF0C;kuTHi&#xFF1A;
InstrumentationProxy&#x3002;java
publicclassInstrumentationProxyextendsInstrumentation{
privateInstrumentationmInstrumentation;
privatePackageManagermPackageManager;
publicInstrumentationProxy&#xFF08;Instrumentationinstrumentation&#xFF0C;PackageManager
packageManager&#xFF09;{
mInstrumentation
instrumentation;
mPackageManager
packageManager;
%3D
}
publicActivityResultexecStartActivity&#xFF08;
Contextwho&#xFF0C;IBindercontextThread&#xFF0C;IBindertoken&#xFF0C;Activitytarget&#xFF0C;
Intentintent&#xFF0C;intrequestCode&#xFF0C;Bundleoptions&#xFF09;{
List<resolveinfo>
infos
mPackageManager&#x3002;queryIntentActivities&#xFF08;intent&#xFF0C;
PackageManager&#x3002;MATCHALL&#xFF09;;
==null||infos&#x3002;size&#xFF08;&#xFF08;&#xFF09;
intent&#x3002;putExtra&#xFF08;HookHelper&#x3002;TARGET_INTENST_NAME&#xFF0C;
intent&#x3002;getComponent&#xFF08;&#xFF09;&#x3002;getClassName&#xFF08;&#xFF09;&#xFF09;;//1
if&#xFF08;infos</resolveinfo></p>
<h1 id="0&#xFF09;"><a name="0&#xFF09;" class="anchor-navigation-ex-anchor" href="#0&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>5. 0&#xFF09;{</h1>
<p>intent&#x3002;setClassName&#xFF08;who&#xFF0C;
&quot;com&#x3002;example&#x3002;liuwangshu&#x3002;pluginactivity&#x3002;StubActivity&quot;&#xFF09;;//2
}
try{
MethodexecMethod=
Instrumentation&#x3002;class&#x3002;getDeclaredMethod&#xFF08;&quot;execStart
Activity&quot;&#xFF0C;Context&#x3002;class&#xFF0C;IBinder&#x3002;class&#xFF0C;IBinder&#x3002;class&#xFF0C;Activity&#x3002;class&#xFF0C;
Intent&#x3002;class&#xFF0C;int&#x3002;class&#xFF0C;Bundle&#x3002;class&#xFF09;;
return&#xFF08;ActivityResult&#xFF09;execMethod&#x3002;invoke&#xFF08;mInstrumentation&#xFF0C;who&#xFF0C;
contextThread&#xFF0C;token&#xFF0C;target&#xFF0C;intent&#xFF0C;requestCode&#xFF0C;options&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
returnnull;
}
&#x9996;&#x5148;&#x67E5;&#x627E;&#x8981;&#x542F;&#x52A8;&#x7684;Activity&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5728;AndroidManifest&#x3002;xml&#x4E2D;&#x6CE8;&#x518C;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6CE8;&#x518C;
&#x5C31;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x5C06;&#x8981;&#x542F;&#x52A8;&#x7684;Activity&#xFF08;TargetActivity&#xFF09;&#x7684;ClassName&#x4FDD;&#x5B58;&#x8D77;&#x6765;&#x7528;&#x4E8E;&#x540E;&#x9762;&#x8FD8;&#x539F;
366</p>
<p>Page383
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
TargetActivity&#xFF0C;&#x63A5;&#x7740;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x66FF;&#x6362;&#x8981;&#x542F;&#x52A8;&#x7684;Activity&#x4E3A;StubActivity&#xFF0C;&#x6700;&#x540E;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x8C03;&#x7528;
execStartActivity&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x7528;StubActivity&#x901A;&#x8FC7;AMS&#x7684;&#x9A8C;&#x8BC1;&#x3002;&#x5728;InstrumentationProxy
&#x7684;newActivity&#x65B9;&#x6CD5;&#x4E2D;&#x8FD8;&#x539F;TargetActivity&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
InstrumentationProxy&#x3002;java
publicActivitynewActivity&#xFF08;ClassLoadercl&#xFF0C;StringclassName&#xFF0C;Intentintent&#xFF09;throws
InstantiationException&#xFF0C;
IllegalAccessException&#xFF0C;ClassNotFoundException{
StringintentName=
intent&#x3002;getStringExtra&#xFF08;HookHelper&#x3002;TARGETINTENTNAME&#xFF09;;
if&#xFF08;!TextUtils&#x3002;isEmpty&#xFF08;intentName&#xFF09;&#xFF09;{
returnsuper&#x3002;newActivity&#xFF08;cl&#xFF0C;intentName&#xFF0C;intent&#xFF09;;
}
returnsuper&#x3002;newActivity&#xFF08;cl&#xFF0C;className&#xFF0C;intent&#xFF09;;
&#xC6;newActivityta#TargetActivity&#xFF0C;zTIHTargetActivity&#xFF0C;
EhookInstrumentation&#xFF0C;HInstrumentationProxymInstrumentation;
HookHelper&#x3002;java
publicstaticvoidhookInstrumentation&#xFF08;Contextcontext&#xFF09;throwsException{
Class&lt;?&gt;contextImplClass
Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ContextImpl&quot;&#xFF09;;
FieldmMainThreadField=FieldUtil&#x3002;getField&#xFF08;contextImplClass&#xFF0C;
&quot;mMainThread&quot;&#xFF09;;//1
=mMainThreadField&#x3002;get&#xFF08;context&#xFF09;;//2
ObjectactivityThread
Class&lt;?&gt;activityThreadClass
=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ActivityThread&quot;&#xFF09;;
FieldmInstrumentationField=FieldUtil&#x3002;getField&#xFF08;activityThreadClass&#xFF0C;
&quot;mInstrumentation&quot;&#xFF09;;//3
FieldUtil&#x3002;setField&#xFF08;activityThreadClass&#xFF0C;activityThread&#xFF0C;&quot;mInstrumentation&quot;&#xFF0C;
newInstrumentationProxy&#xFF08;&#xFF08;Instrumentation&#xFF09;mInstrumentationField&#x3002;
get&#xFF08;activityThread&#xFF09;&#xFF0C;context&#x3002;getPackageManager&#xFF08;&#xFF09;&#xFF09;&#xFF09;;
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x83B7;&#x53D6;ContextImpl&#x7C7B;&#x7684;ActivityThread&#x7C7B;&#x578B;&#x7684;mMainThread&#x5B57;&#x6BB5;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2
&#x5904;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x4E0A;&#x4E0B;&#x6587;&#x73AF;&#x5883;&#x7684;ActivityThread&#x5BF9;&#x8C61;&#x3002;&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x83B7;&#x53D6;ActivityThread&#x7C7B;&#x4E2D;&#x7684;
mlnstrumentation7&#xFF0C;AInstrumentationProxy**mInstrumentation&#x3002;E
MyApplicationjattachBaseContextjHookHelperjhooklInstrumentation75ti&#xFF0C;j&#xEB;
&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x5355;&#x51FB;&#x201C;&#x542F;&#x52A8;&#x63D2;&#x4EF6;&#x201D;&#x6309;&#x94AE;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x542F;&#x52A8;&#x7684;&#x662F;&#x63D2;&#x4EF6;TargetActivity&#x3002;
15&#x3002;4&#x3002;4&#x603B;&#x7ED3;
&#x8FD9;&#x4E00;&#x8282;&#x6211;&#x4EEC;&#x5B66;&#x4E60;&#x4E86;&#x542F;&#x52A8;&#x63D2;&#x4EF6;Activity&#x7684;&#x539F;&#x7406;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x65B9;&#x6848;&#x5C31;&#x662F;&#x5148;&#x7528;&#x4E00;&#x4E2A;&#x5728;
367
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page384
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
AndroidManifest&#x3002;xml&#x4E2D;&#x6CE8;&#x518C;&#x7684;Activity&#x6765;&#x8FDB;&#x884C;&#x5360;&#x5751;&#xFF0C;&#x7528;&#x6765;&#x901A;&#x8FC7;AMS&#x7684;&#x6821;&#x9A8C;&#xFF0C;&#x63A5;&#x7740;&#x5728;&#x5408;&#x9002;&#x7684;
&#x65F6;&#x673A;&#x7528;&#x63D2;&#x4EF6;Activity&#x66FF;&#x6362;&#x5360;&#x5751;&#x7684;Activity&#x3002;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x5730;&#x8BB2;&#x89E3;&#x542F;&#x52A8;&#x63D2;&#x4EF6;Activity&#x7684;&#x539F;&#x7406;&#xFF0C;&#x672C;&#x8282;
&#x7701;&#x7565;&#x4E86;&#x63D2;&#x4EF6;Activity&#x7684;&#x52A0;&#x8F7D;&#x903B;&#x8F91;&#xFF0C;&#x76F4;&#x63A5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;TargetActivity&#x6765;&#x4EE3;&#x8868;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x63D2;&#x4EF6;
Activity&#x3002;&#x540C;&#x65F6;&#x8FD9;&#x4E00;&#x8282;&#x4F7F;&#x6211;&#x4EEC;&#x66F4;&#x597D;&#x5730;&#x7406;&#x89E3;&#x4E86;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x3002;
15&#x3002;5Service&#x63D2;&#x4EF6;&#x5316;
Service&#x63D2;&#x4EF6;&#x5316;&#x548C;Activity&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x539F;&#x7406;&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x56DE;&#x987E;&#x4E00;&#x4E0B;Service&#x7684;&#x542F;&#x52A8;
&#x8FC7;&#x7A0B;&#x3002;
15&#x3002;5&#x3002;1&#x63D2;&#x4EF6;&#x5316;&#x65B9;&#x9762;Service&#x4E0E;Activity&#x7684;&#x4E0D;&#x540C;
&#x5728;4&#x3002;2&#x8282;&#x8BB2;&#x5230;&#x4E86;Service&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#xFF0C;&#x5B83;&#x548C;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#xFF0C;
ContextImpl&#x5230;AMS&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x5982;&#x56FE;15-10&#x6240;&#x793A;&#x3002;
ContextWrapper
Contextimpl
IActivityManager
AMS
startService
startService-
startServiceCommon
-startService
-startService
&#x56FE;15-10ContextImpl&#x5230;AMS&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;
&#x5728;ContextImpl&#x5230;AMS&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x4EA4;&#x7531;Instrumentation&#x6765;&#x5904;&#x7406;&#xFF0C;&#x5728;&#x540E;&#x7EED;&#x7684;
ActivityThread&#x542F;&#x52A8;Service&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x5982;&#x56FE;15-11&#x6240;&#x793A;&#x3002;
368
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page385
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
AMS
ActiveServices
ApplicationThread
ActivityThread
H
Service
startService
-startServicelLocked&gt;
startServicelnnerLocked
bringUpServiceLocked
realStartServicelocked
scheduleCreateService&gt;
sendMessage
handleMessage
KhandleCreateService
-onCreate
&#x56FE;15-11ActivityThread&#x542F;&#x52A8;Service
&#x53EF;&#x89C1;Service&#x7684;&#x542F;&#x52A8;&#x548C;Instrumentation&#x5B8C;&#x5168;&#x6CA1;&#x6709;&#x5173;&#x8054;&#xFF0C;&#x56E0;&#x6B64;Service&#x63D2;&#x4EF6;&#x5316;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;Hook
Instrumentation&#x6765;&#x5B9E;&#x73B0;&#x3002;Service&#x63D2;&#x4EF6;&#x5316;&#x53EF;&#x4EE5;&#x7528;HookIActivityManager&#x7684;&#x65B9;&#x6848;&#x6765;&#x5B9E;&#x73B0;&#x5417;?&#x5E26;
&#x7740;&#x8FD9;&#x4E2A;&#x7591;&#x95EE;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x5728;&#x63D2;&#x4EF6;&#x5316;&#x65B9;&#x9762;Activity&#x548C;Service&#x6709;&#x4F55;&#x4E0D;&#x540C;&#xFF0C;&#x4E3B;&#x8981;&#x6709;&#x4EE5;&#x4E0B;3&#x70B9;&#xFF1A;
&#x3002;Activity&#x662F;&#x57FA;&#x4E8E;&#x6808;&#x7BA1;&#x7406;&#x7684;&#xFF0C;&#x4E00;&#x4E2A;&#x6808;&#x4E2D;&#x7684;Activity&#x7684;&#x6570;&#x91CF;&#x4E0D;&#x4F1A;&#x592A;&#x591A;&#xFF0C;&#x56E0;&#x6B64;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x5904;
&#x7406;&#x7684;&#x63D2;&#x4EF6;Activity&#x6570;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x58F0;&#x660E;&#x6709;&#x9650;&#x7684;&#x5360;&#x5751;Activity&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x9664;&#x53BB;&#x786C;&#x4EF6;
&#x548C;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF0C;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x5904;&#x7406;&#x7684;&#x63D2;&#x4EF6;Service&#x7684;&#x6570;&#x91CF;&#x53EF;&#x4EE5;&#x662F;&#x8FD1;&#x4E4E;&#x65E0;&#x9650;&#x7684;&#xFF0C;&#x65E0;&#x6CD5;&#x7528;&#x6709;&#x9650;
&#x7684;&#x5360;&#x5751;Service&#x6765;&#x5B9E;&#x73B0;&#x3002;
&#x3002;&#x5728;Standard&#x6A21;&#x5F0F;&#x4E0B;&#x591A;&#x6B21;&#x542F;&#x52A8;&#x540C;&#x4E00;&#x4E2A;&#x5360;&#x5751;Activity&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x591A;&#x4E2A;Activity&#x5B9E;&#x4F8B;&#xFF0C;&#x4F46;&#x662F;
&#x591A;&#x6B21;&#x542F;&#x52A8;&#x5360;&#x5751;Service&#x5E76;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA;&#x591A;&#x4E2A;Service&#x5B9E;&#x4F8B;&#x3002;
&#x3002;&#x7528;&#x6237;&#x548C;&#x754C;&#x9762;&#x7684;&#x4EA4;&#x4E92;&#x4F1A;&#x5F71;&#x54CD;&#x5230;Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x56E0;&#x6B64;&#x63D2;&#x4EF6;Activity&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x9700;
&#x8981;&#x4EA4;&#x7531;&#x7CFB;&#x7EDF;&#x6765;&#x7BA1;&#x7406;&#xFF0C;HookIActivityManager&#x65B9;&#x6848;&#x4E2D;&#x8FD8;&#x539F;&#x63D2;&#x4EF6;Activity&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x8FD9;&#x4E00;
&#x70B9;&#x3002;Service&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E0D;&#x53D7;&#x7528;&#x6237;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x4EE5;&#x7531;&#x5F00;&#x53D1;&#x8005;&#x7BA1;&#x7406;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x8FD8;&#x539F;
&#x63D2;&#x4EF6;&#x3002;
369
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page386
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
&#x7EFC;&#x5408;&#x4E0A;&#x9762;3&#x70B9;&#x5F97;&#x51FA;&#x7684;&#x7ED3;&#x8BBA;&#x5C31;&#x662F;&#xFF0C;Service&#x63D2;&#x4EF6;&#x5316;&#x4E0D;&#x53EF;&#x4EE5;&#x7528;HookIActivityManager&#x65B9;&#x6848;&#x6765;
&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x65B9;&#x6848;&#x3002;
15&#x3002;5&#x3002;2&#x4EE3;&#x7406;&#x5206;&#x53D1;&#x5B9E;&#x73B0;
Activity&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x91CD;&#x70B9;&#x5728;&#x4E8E;&#x8981;&#x4FDD;&#x8BC1;&#x5B83;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x800C;Service&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x91CD;&#x70B9;&#x662F;&#x4FDD;&#x8BC1;&#x5B83;&#x7684;
&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x7528;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;Service&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x50CF;&#x5360;&#x5751;Activity&#x90A3;&#x6837;&#x8D77;&#x4E00;&#x4E2A;&#x5360;&#x5751;&#x7684;
&#x4F5C;&#x7528;&#x3002;&#x5F53;&#x542F;&#x52A8;&#x63D2;&#x4EF6;Service&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x5148;&#x542F;&#x52A8;&#x4EE3;&#x7406;Service&#xFF0C;&#x5F53;&#x8FD9;&#x4E2A;&#x4EE3;&#x7406;Service&#x8FD0;&#x884C;&#x8D77;&#x6765;&#x4E4B;&#x540E;&#xFF0C;
&#x5728;&#x5B83;&#x7684;onStartCommand&#x7B49;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x8FDB;&#x884C;&#x5206;&#x53D1;&#xFF0C;&#x6267;&#x884C;&#x63D2;&#x4EF6;TargetService&#x7684;onCreate&#x7B49;&#x65B9;&#x6CD5;&#xFF0C;
&#x8FD9;&#x4E00;&#x65B9;&#x6848;&#x5C31;&#x53EB;&#x4F5C;&#x4EE3;&#x7406;&#x5206;&#x53D1;&#x3002;
15&#x3002;5&#x3002;2&#x3002;1&#x542F;&#x52A8;&#x4EE3;&#x7406;Service
Service&#x63D2;&#x4EF6;&#x5316;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;Service&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x8981;&#x5728;AndroidManifest&#x3002;xml&#x4E2D;&#x6CE8;
&#x518C;&#x4EE3;&#x7406;ProxyService&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
&lt;?xmlversion=&quot;1&#x3002;0&quot;encoding=&quot;utf-8&quot;?&gt;</p>
<p><manifestxmlns：android="http： schemas。android。com="" apk="" res="" android"="" package="com&#x3002;example&#x3002;liuwangshu&#x3002;pluginservice"></manifestxmlns：android="http：></p>
<p>&lt;application</p>
<p><serviceandroid：name="。proxyservice" android：process="&#xFF1A;daemon">
&lt;/application&gt;
&lt;/manifest&gt;
&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x6CE8;&#x518C;&#x4E86;ProxyService&#xFF0C;&#x8BA9;&#x5B83;&#x8FD0;&#x884C;&#x5728;&#x5F53;&#x524D;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;
android&#xFF1A;process&#x7528;&#x4E8E;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x3002;&#x5728;MainActivity&#x4E2D;&#x542F;&#x52A8;&#x63D2;&#x4EF6;Service&#xFF0C;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
MainActivity&#x3002;java
publicclassMainActivityextendsAppCompatActivity{
privateButtonbthook;
@Override
protectedvoidonCreate&#xFF08;BundlesavedInstanceState&#xFF09;{
super&#x3002;onCreate&#xFF08;savedInstanceState&#xFF09;;
setContentView&#xFF08;R&#x3002;layout&#x3002;activity_main&#xFF09;;
bt_hook=
&#xFF08;Button&#xFF09;this&#x3002;findViewById&#xFF08;R&#x3002;id&#x3002;bt_hook&#xFF09;;
bthook&#x3002;setOnClickListener&#xFF08;newView&#x3002;OnClickListener&#xFF08;&#xFF09;{
@Override
370
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</serviceandroid：name="。proxyservice"></p>
<p>Page387
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
publicvoidonClick&#xFF08;Viewview&#xFF09;{
Intentintent=newIntent&#xFF08;MainActivity&#x3002;this&#xFF0C;TargetService&#x3002;class&#xFF09;;
startService&#xFF08;intent&#xFF09;;
}&#xFF09;;
}
}
&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;&#x7406;&#x89E3;&#xFF0C;&#x8FD9;&#x91CC;&#x7701;&#x7565;&#x4E86;&#x63D2;&#x4EF6;Service&#x7684;&#x52A0;&#x8F7D;&#x903B;&#x8F91;&#xFF0C;&#x76F4;&#x63A5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;TargetService&#x6765;&#x4EE3;
&#x8868;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x63D2;&#x4EF6;Service&#x3002;TargetService&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
TargetService&#x3002;java
publicclassTargetServiceextendsService{
privatestaticfinalStringTAG=
&quot;TargetService&quot;;
@Nullable
@Override
publicIBinderonBind&#xFF08;Intentintent&#xFF09;{
returnnull;
}
@Override
publicvoidonCreate&#xFF08;&#xFF09;{
super&#x3002;onCreate&#xFF08;&#xFF09;;
Log&#x3002;d&#xFF08;TAG&#xFF0C;&quot;onCreate&quot;&#xFF09;;
}
@Override
publicintonStartCommand&#xFF08;Intentintent&#xFF0C;intflags&#xFF0C;intstartId&#xFF09;{
Log&#x3002;d&#xFF08;TAG&#xFF0C;&quot;onStartCommand&quot;&#xFF09;;
returnsuper&#x3002;onStartCommand&#xFF08;intent&#xFF0C;flags&#xFF0C;startId&#xFF09;;
}
TargetService&#x53EA;&#x662F;&#x7528;&#x6765;&#x6253;&#x5370;Log&#xFF0C;&#x786E;&#x5B9A;&#x81EA;&#x8EAB;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x88AB;&#x8C03;&#x7528;&#x3002;TargetService&#x7528;&#x6765;
&#x4EE3;&#x8868;&#x63D2;&#x4EF6;Service&#xFF0C;&#x4E0D;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x542F;&#x52A8;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x542F;&#x52A8;&#x4EE3;&#x7406;ProxyService&#xFF0C;&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#x6211;
&#x4EEC;&#x9700;&#x8981;HookIActivityManager&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x539F;&#x7406;&#x548C;&#x6B65;&#x9AA4;&#x4E0E;15&#x3002;4&#x3002;2&#x8282;&#x8BB2;&#x5F97;&#x7C7B;&#x4F3C;&#xFF0C;&#x5B9A;&#x4E49;&#x66FF;&#x6362;
IActivityManager#3fEActivityManagerProxy&#xFF0C;kuF&#xFF1A;
publicclassIActivityManagerProxyimplementsInvocationHandler{
privateObjectmActivityManager;
privatestaticfinalStringTAG=&quot;IActivityManagerProxy&quot;;
publicIActivityManagerProxy&#xFF08;ObjectactivityManager&#xFF09;{
this&#x3002;mActivityManager
activityManager;
}
@Override
publicObjectinvoke&#xFF08;Objecto&#xFF0C;Methodmethod&#xFF0C;Object[]args&#xFF09;throwsThrowable{
371
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page388
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
if&#xFF08;&quot;startService&quot;&#x3002;equals&#xFF08;method&#x3002;getName&#xFF08;&#xFF09;&#xFF09;&#xFF09;{//1
Intentintent=null;
intindex
0;
for&#xFF08;inti=
0;i<args。length;i++）{ 3="" 4="" if（args[i]instanceofintent）{="" index="i;" break;="" }="" intent="&#xFF08;Intent&#xFF09;args[index];" intentproxyintent="newIntent&#xFF08;&#xFF09;;//2" stringpackagename="com&#x3002;example&#x3002;liuwangshu&#x3002;pluginservice" ;="" proxyintent。setclassname（packagename，packagename+"。proxyservice"）;="" proxyintent。putextra（proxyservice。target_service，="" intent。getcomponent（）。="" getclassname（））;="" args[index]="subIntent;//5" log。d（tag，"hook"）;="" returnmethod。invoke（mactivitymanager，args）;="" 在注释1处拦截startservice方法，接着获取参数args中第一个intent对象，它原本要="" 启动插件targetactivity的intent。在注释2、注释3处新建一个proxylntent用来启动="" proxyservice，注释4处将这个proxyservice的intent保存到proxyintent中，便于此后进行="" 分发。在注释5处将proxyintent赋值给参数args，这样启动的目标就变为了proxyservice。="" 定义了iactivitymanagerproxy，我们就需要用iactivitymanagerproxy来替换系统的="" iactivitymanager，kufh：="" hookhelper。java="" publicclasshookhelper{="" publicstaticfinalstringtarget_intent="target_intent" publicstaticvoidhookams（）throwsexception{="" objectdefaultsingleton="null;" if（build。version。sdkint="">=26&#xFF09;{//1
Class&lt;?&gt;activityManageClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ActivityManager&quot;&#xFF09;;
//activityManager##IActivityManagerSingleton
defaultSingleton=FieldUtil&#x3002;getField&#xFF08;activityManageClazz&#xFF0C;null&#xFF0C;
&quot;IActivityManagerSingleton&quot;&#xFF09;;
}else{
Class&lt;?&gt;activityManagerNativeClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;
ActivityManagerNative&quot;&#xFF09;;
372
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</args。length;i++）{></p>
<p>Page389
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
//##RActivityManagerNative##gDefault
defaultSingleton=FieldUtil&#x3002;getField&#xFF08;activityManagerNativeClazz&#xFF0C;null&#xFF0C;
&quot;gDefault&quot;&#xFF09;;
}
Class&lt;?&gt;singletonClazz
=Class&#x3002;forName&#xFF08;&quot;android&#x3002;util&#x3002;Singleton&quot;&#xFF09;;
FieldmInstanceField=FieldUtil&#x3002;getField&#xFF08;singletonClazz&#xFF0C;&quot;mInstance&quot;&#xFF09;;//2
//#iActivityManager
ObjectiActivityManager
=mInstanceField&#x3002;get&#xFF08;defaultSingleton&#xFF09;;//3
Class&lt;?&gt;iActivityManagerClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;IActivityManager&quot;&#xFF09;;
Objectproxy
ClassLoader&#xFF08;&#xFF09;&#xFF0C;newClass&lt;?&gt;[]{iActivityManagerClazz}&#xFF0C;
Proxy&#x3002;newProxyInstance&#xFF08;Thread&#x3002;currentThread&#xFF08;&#xFF09;&#x3002;getContext
newIactivityManagerProxy&#xFF08;iActivityManager&#xFF09;&#xFF09;;
mInstanceField&#x3002;set&#xFF08;defaultSingleton&#xFF0C;proxy&#xFF09;;
}
&#x9996;&#x5148;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x5BF9;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x8FDB;&#x884C;&#x533A;&#x5206;&#xFF0C;&#x6700;&#x7EC8;&#x83B7;&#x53D6;&#x7684;&#x662F;Singleton<iactivitymanager>&#x7C7B;&#x578B;
&#x7684;IActivityManagerSingleton&#x6216;&#x8005;gDefault&#x5B57;&#x6BB5;&#x3002;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x83B7;&#x53D6;Singleton&#x7C7B;&#x4E2D;&#x7684;mlnstance
&#x5B57;&#x6BB5;&#xFF0C;&#x4ECE;15&#x3002;4&#x3002;2&#x3002;2&#x8282;&#x4E2D;&#x7ED9;&#x51FA;&#x7684;Singleton&#x7C7B;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;minstance&#x5B57;&#x6BB5;&#x7684;&#x7C7B;&#x578B;&#x4E3A;T&#xFF0C;&#x5728;&#x6CE8;&#x91CA;
3LIActivityManagerSingletongDefaultR+OT0<em>N&#xFF0C;T&#xC1;J</em>
IActivityManager&#xFF0C;aaaEMIActivityManagerProxy&#xFF0C;IActivityManagerProxy
&#x6765;&#x66FF;&#x6362;IActivityManager&#x3002;&#x5176;&#x4E2D;&#x7528;&#x5230;&#x4E86;FieldUtil&#x7C7B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#x5728;14&#x3002;5&#x3002;1&#x3002;2&#x8282;&#x4E2D;&#x5DF2;&#x7ECF;&#x8BB2;&#x8FC7;&#x3002;
&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;Application&#x8C03;&#x7528;HookHelper&#x7684;hookAMS&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
MyApplication&#x3002;java
publicclassMyApplicationextendsApplication{
@Override
protectedvoidattachBaseContext&#xFF08;Contextbase&#xFF09;{
super&#x3002;attachBaseContext&#xFF08;base&#xFF09;;
try{
HookHelper&#x3002;hookAMS&#xFF08;&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
&#x8FD0;&#x884C;&#x5E94;&#x7528;&#x5355;&#x51FB;MainActivity&#x7684;&#x6309;&#x94AE;&#x65F6;&#xFF0C;&#x542F;&#x52A8;&#x7684;&#x4E0D;&#x662F;&#x63D2;&#x4EF6;TargetService&#xFF0C;&#x800C;&#x662F;&#x4EE3;&#x7406;
ProxyService&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;ProxyService&#x4E2D;&#x8FDB;&#x884C;&#x4EE3;&#x7406;&#x5206;&#x53D1;&#x3002;
373
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</iactivitymanager></p>
<p>Page390
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
15&#x3002;5&#x3002;2&#x3002;2&#x4EE3;&#x7406;&#x5206;&#x53D1;
&#x7F16;&#x5199;ProxyService&#x7C7B;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
ProxyService&#x3002;java
publicclassProxyServiceextendsService{
publicstaticfinalStringTARGETSERVICE=
&quot;target_service&quot;;
@Override
publicintonStartCommand&#xFF08;Intentintent&#xFF0C;intflags&#xFF0C;intstartId&#xFF09;{
intent||!intent&#x3002;hasExtra&#xFF08;TARGETSERVICE&#xFF09;&#xFF09;{
if&#xFF08;null==
returnSTARTSTICKY;
intent&#x3002;getStringExtra&#xFF08;TARGETSERVICE&#xFF09;;
StringserviceName=
if&#xFF08;null
==serviceName&#xFF09;{
returnSTARTSTICKY;
ServicetargetService=null;
try{
ClassactivityThreadClazz
Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;ActivityThread&quot;&#xFF09;;
MethodgetActivityThreadMethod=activityThreadClazz&#x3002;getDeclaredMethod
&#xFF08;&quot;getApplicationThread&quot;&#xFF09;;
getActivityThreadMethod&#x3002;setAccessible&#xFF08;true&#xFF09;;
ObjectactivityThread
FieldUtil&#x3002;getField&#xFF08;activityThreadClazz&#xFF0C;null&#xFF0C;
%D
&quot;sCurrentActivityThread&quot;&#xFF09;;//1
ObjectapplicationThread=getActivityThreadMethod&#x3002;invoke&#xFF08;activityThread&#xFF09;;//2
%3D
ClassiInterfaceClazz
Class&#x3002;forName&#xFF08;&quot;android&#x3002;os&#x3002;IInterface&quot;&#xFF09;;
MethodasBinderMethod=
iInterfaceClazz&#x3002;getDeclaredMethod&#xFF08;&quot;asBinder&quot;&#xFF09;;
asBinderMethod&#x3002;setAccessible&#xFF08;true&#xFF09;;
Objecttoken=asBinderMethod&#x3002;invoke&#xFF08;applicationThread&#xFF09;;//3
ClassserviceClazz=Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;Service&quot;&#xFF09;;
MethodattachMethod
serviceClazz&#x3002;getDeclaredMethod&#xFF08;&quot;attach&quot;&#xFF0C;
Context&#x3002;class&#xFF0C;activityThreadClazz&#xFF0C;String&#x3002;class&#xFF0C;IBinder&#x3002;class&#xFF0C;
Application&#x3002;class&#xFF0C;Object&#x3002;class&#xFF09;;
attachMethod&#x3002;setAccessible&#xFF08;true&#xFF09;;
ObjectdefaultSingleton=null;
if&#xFF08;Build&#x3002;VERSION&#x3002;SDKINT&gt;=26&#xFF09;{//4
Class&lt;?&gt;activityManageClazz
Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;Activity
Manager&quot;&#xFF09;;
//#activityManagerIActivityManagerSingletonF
defaultSingleton
FieldUtil&#x3002;getField&#xFF08;activityManageClazz&#xFF0C;
null&#xFF0C;
&quot;IActivityManagerSingleton&quot;&#xFF09;;
}else{
Class&lt;?&gt;activityManagerNativeClazz
Class&#x3002;forName&#xFF08;&quot;android&#x3002;app&#x3002;
374
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page391
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
ActivityManagerNative&quot;&#xFF09;;
//#ActivityManagerNativegDefault<em>
defaultSingleton
FieldUtil&#x3002;getField&#xFF08;activityManagerNativeClazz&#xFF0C;
%3D
null&#xFF0C;&quot;gDefault&quot;&#xFF09;;
}
Class&lt;?&gt;singletonClazz
=Class&#x3002;forName&#xFF08;&quot;android&#x3002;util&#x3002;Singleton&quot;&#xFF09;;
FieldmInstanceField=
//#iActivityManager
FieldUtil&#x3002;getField&#xFF08;singletonClazz&#xFF0C;&quot;mInstance&quot;&#xFF09;;
ObjectiActivityManager=mInstanceField&#x3002;get&#xFF08;defaultSingleton&#xFF09;;//5
targetService=&#xFF08;Service&#xFF09;Class&#x3002;forName&#xFF08;serviceName&#xFF09;&#x3002;newInstance&#xFF08;&#xFF09;;//6
attachMethod&#x3002;invoke&#xFF08;targetService&#xFF0C;this&#xFF0C;activityThread&#xFF0C;intent&#x3002;
getComponent&#xFF08;&#xFF09;&#x3002;getClassName&#xFF08;&#xFF09;&#xFF0C;token&#xFF0C;getApplication&#xFF08;&#xFF09;&#xFF0C;
iActivityManager&#xFF09;;//7
targetService&#x3002;onCreate&#xFF08;&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
returnSTARTSTICKY;
}
targetService&#x3002;onStartCommand&#xFF08;intent&#xFF0C;flags&#xFF0C;startId&#xFF09;;
returnSTARTSTICKY;
}
&#x5728;onStartCommand&#x65B9;&#x6CD5;&#x4E2D;&#x8FDB;&#x884C;&#x4EE3;&#x7406;&#x5206;&#x53D1;&#xFF0C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6BD4;&#x8F83;&#x957F;&#xFF0C;&#x4E3B;&#x8981;&#x505A;&#x4E86;3&#x4EF6;&#x4E8B;&#xFF1A;
</em>ProxyService&#x9700;&#x8981;&#x957F;&#x65F6;&#x95F4;&#x5BF9;Service&#x8FDB;&#x884C;&#x5206;&#x53D1;&#x5904;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x53C2;&#x6570;&#x6761;&#x4EF6;&#x4E0D;&#x6EE1;&#x8DB3;&#x3001;&#x51FA;&#x73B0;&#x5F02;
&#x5E38;&#x548C;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x65F6;&#x9700;&#x8981;&#x8FD4;&#x56DE;START_STICKY&#xFF0C;&#x8FD9;&#x6837;ProxyService&#x4F1A;&#x91CD;&#x65B0;&#x88AB;&#x521B;&#x5EFA;&#x5E76;
thiionStartCommand&#x3002;
&#x3002;&#x521B;&#x5EFA;targetService&#x5E76;&#x53CD;&#x5C04;&#x8C03;&#x7528;targetService&#x7684;attach&#x65B9;&#x6CD5;&#x3002;
&#x3002;&#x8FDB;&#x884C;&#x4EE3;&#x7406;&#x5206;&#x53D1;&#xFF0C;&#x6267;&#x884C;targetService&#x7684;onCreate&#x65B9;&#x6CD5;&#x3002;
&#x8FD9;&#x4E09;&#x4EF6;&#x4E8B;&#x4E2D;&#x7B2C;&#x4E8C;&#x4EF6;&#x4E8B;&#x7684;&#x4EE3;&#x7801;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x3002;&#x4E3A;&#x4E86;&#x53CD;&#x5C04;&#x8C03;&#x7528;Service&#x7684;attach
&#x65B9;&#x6CD5;&#xFF0C;&#x9664;&#x4E86;&#x8981;&#x53CD;&#x5C04;&#x5F97;&#x5230;attach&#x65B9;&#x6CD5;&#x5916;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5F97;&#x5230;atach&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#xFF1A;ActivityThread&#x3001;
IBinder&#x3001;IActivityManager&#x7B49;&#x3002;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x5F97;&#x5230;ActivityThread&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x6839;&#x636E;
ActivityThreadHapplicationThread&#xFF0C;lapplicationThreadfae&#xC8;#3
&#x53CD;&#x5C04;&#x8C03;&#x7528;ApplicationThread&#x7684;asBinder&#x65B9;&#x6CD5;&#x5F97;&#x5230;token&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x6E90;&#x7801;&#x4E2D;&#x8FD9;&#x4E2A;token&#x662F;IBinder
&#x7C7B;&#x578B;&#x7684;&#x3002;&#x5728;&#x6CE8;&#x91CA;4&#x5904;&#x5230;&#x6CE8;&#x91CA;5&#x5904;&#x4E4B;&#x95F4;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x5728;&#x672C;&#x7AE0;&#x591A;&#x6B21;&#x51FA;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x975E;&#x5E38;&#x719F;&#x6089;&#x4E86;&#xFF0C;
&#x662F;&#x4E3A;&#x4E86;&#x83B7;&#x53D6;iActivityManager&#x3002;&#x5728;&#x6CE8;&#x91CA;6&#x5904;&#x53CD;&#x5C04;&#x5F97;&#x5230;targetService&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x4E3E;&#x4F8B;&#xFF0C;
&#x7528;targetService&#x4EE3;&#x8868;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x63D2;&#x4EF6;Service&#xFF0C;&#x771F;&#x6B63;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x4F1A;&#x7528;ClassLoader&#x6765;&#x52A0;
&#x8F7D;&#x63D2;&#x4EF6;&#x4E2D;&#x7684;Service&#x3002;&#x5728;&#x6CE8;&#x91CA;7&#x5904;&#x53CD;&#x5C04;&#x6267;&#x884C;targetService&#x7684;attach&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x6B64;&#x524D;&#x5F97;&#x5230;&#x7684;
375
&#x4EC5;&#x4F9B;&#x975E;&#x5546;&#x4E1A;&#x7528;&#x9014;&#x6216;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x4F7F;&#x7528;</p>
<p>Page392
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
&#x53C2;&#x6570;&#x3002;&#x6700;&#x540E;&#x6267;&#x884C;targetService&#x7684;onCreate&#x65B9;&#x6CD5;&#x6765;&#x5B8C;&#x6210;&#x4EE3;&#x7406;&#x5206;&#x53D1;&#x3002;&#x8FD0;&#x884C;&#x5E94;&#x7528;&#x5355;&#x51FB;MainActivity
&#x7684;&#x6309;&#x94AE;&#x65F6;&#xFF0C;&#x4E0D;&#x4EC5;&#x542F;&#x52A8;&#x4E86;ProxyService&#xFF0C;&#x63D2;&#x4EF6;TargetService&#x4E5F;&#x88AB;&#x542F;&#x52A8;&#x4E86;&#x3002;
15&#x3002;6ContentProvider&#x63D2;&#x4EF6;&#x5316;
&#x4E0E;Activity&#x3001;BroadcastReceiver&#x7684;&#x9891;&#x7E41;&#x4F7F;&#x7528;&#x76F8;&#x6BD4;&#xFF0C;ContentProvider&#x4F7F;&#x7528;&#x7684;&#x9891;&#x7387;&#x5E76;&#x4E0D;&#x9AD8;&#xFF0C;
&#x56E0;&#x6B64;&#x6709;&#x4E9B;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x5E76;&#x4E0D;&#x652F;&#x6301;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x3002;&#x5728;&#x8BB2;&#x5230;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x4E4B;&#x524D;
&#x4ECD;&#x65E7;&#x8981;&#x7B80;&#x5355;&#x56DE;&#x987E;&#x4E00;&#x4E0B;ContentProvider&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x3002;
15&#x3002;6&#x3002;1ContentProvider&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x56DE;&#x987E;
ContentProvider&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x8FDB;&#x7A0B;&#x5185;&#x548C;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x5171;&#x4EAB;&#xFF0C;&#x5B83;&#x540C;&#x6837;&#x9700;&#x8981;&#x7ECF;&#x8FC7;AMS&#x6765;&#x8FDB;&#x884C;&#x5904;
&#x7406;&#xFF0C;query&#x65B9;&#x6CD5;&#x5230;AMS&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x5982;&#x56FE;15-12&#x6240;&#x793A;&#x3002;
ContentResolver
ApplicationContentResolver
ActivityThread
IActivityManager
AMS
-query
acquireUnstableProvider
-acquireUnstableProvider&gt;
-acquireProvider-
-getContentProvider-
-getContentProvider&gt;
getContentProviderlmpl
main-
attach
-attachApplication-
-attachApplication-
&#x56FE;15-12query&#x65B9;&#x6CD5;&#x5230;AMS&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;
376</p>
<p>Page393
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
&#x4ECE;&#x56FE;15-12&#x53EF;&#x4EE5;&#x770B;&#x51FA;ContentProvider&#x7684;query&#x65B9;&#x6CD5;&#x4F1A;&#x8C03;&#x7528;ActivityThread&#x7684;acquireProvider
&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
frameworks/base/core/javalandroidlapp
publicfinalIContentProvideracquireProvider&#xFF08;
Contextc&#xFF0C;Stringauth&#xFF0C;intuserId&#xFF0C;booleanstable&#xFF09;{
finalIContentProviderprovider=acq
Existi
gProv
er&#xFF08;c&#xFF0C;auth&#xFF0C;userId&#xFF0C;
stable&#xFF09;;//1
if&#xFF08;provider!=null&#xFF09;{
returnprovider;
}
ContentProviderHolderholder=null;
try{
holder=ActivityManager&#x3002;getService&#xFF08;&#xFF09;&#x3002;getContentProvider&#xFF08;
getApplicationThread&#xFF08;&#xFF09;&#xFF0C;auth&#xFF0C;userId&#xFF0C;stable&#xFF09;;//2
}catch&#xFF08;RemoteExceptionex&#xFF09;{
throwex&#x3002;rethrowFromSystemServer&#xFF08;&#xFF09;;
}
if&#xFF08;holder==
null&#xFF09;{
Slog&#x3002;e&#xFF08;TAG&#xFF0C;&quot;Failedtofindproviderinfofor&quot;
+auth&#xFF09;;
returnnull;
holder=installProvider&#xFF08;c&#xFF0C;holder&#xFF0C;holder&#x3002;info&#xFF0C;
true/<em>noisy</em>/&#xFF0C;holder&#x3002;noReleaseNeeded&#xFF0C;stable&#xFF09;;
returnholder&#x3002;provider;
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x7684;acquireProvider&#x65B9;&#x6CD5;&#x4E2D;&#x4F1A;&#x67E5;&#x8BE2;mProviderMap&#x662F;&#x5426;&#x6709;&#x76EE;&#x6807;IContentProvider
&#x5B58;&#x5728;&#xFF0C;&#x6709;&#x5219;&#x8FD4;&#x56DE;&#xFF0C;&#x6CA1;&#x6709;&#x5C31;&#x4F1A;&#x8C03;&#x7528;&#x6CE8;&#x91CA;2&#x5904;&#x7684;IActivityManager&#x7684;getContentProvider&#x65B9;&#x6CD5;&#xFF0C;
RAMS&#xC9;JgetContentProvider<em>ContentProviderHolder&#xFF08;1A
IContentProvider&#x7C7B;&#x578B;&#x6570;&#x636E;&#xFF09;&#x3002;IContentProvider&#x662F;&#x4E00;&#x4E2A;Binder&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#xFF0C;
ContentProvideraahaeTEIContentProvider</em>&#x3002;AMSHContentProvider
&#x7684;&#x8FC7;&#x7A0B;&#x4E0E;Activity&#x548C;Service&#x7C7B;&#x4F3C;&#xFF0C;&#x90FD;&#x662F;&#x901A;&#x8FC7;ActvityThread&#x5411;H&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7684;&#xFF0C;&#x5C06;&#x4EE3;&#x7801;&#x903B;&#x8F91;
&#x8FD0;&#x884C;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x6700;&#x7EC8;&#x8C03;&#x7528;ContentProvider&#x7684;onCreate&#x65B9;&#x6CD5;&#x3002;&#x5177;&#x4F53;&#x7684;&#x5185;&#x5BB9;&#x8BF7;&#x67E5;&#x770B;4&#x3002;5&#x8282;&#xFF0C;
&#x8FD9;&#x91CC;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#x3002;
15&#x3002;6&#x3002;2VirtualApk#J
ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x5173;&#x952E;&#x5728;&#x4E8E;&#x5C06;ContentProvider&#x63D2;&#x4EF6;&#x5171;&#x4EAB;&#x7ED9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x3002;&#x548C;Service
&#x63D2;&#x4EF6;&#x5316;&#x7C7B;&#x4F3C;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;ContentProvider&#x4F5C;&#x4E3A;&#x4EE3;&#x7406;ContentProvider&#xFF0C;&#x5E76;&#x628A;&#x8FD9;&#x4E2A;&#x4EE3;
&#x7406;ContentProvider&#x5171;&#x4EAB;&#x7ED9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#xFF0C;&#x5BF9;&#x4E8E;&#x63D2;&#x4EF6;ContentProvider&#x7684;&#x8BF7;&#x6C42;&#x4F1A;&#x5168;&#x90E8;&#x4EA4;&#x7531;&#x4EE3;&#x7406;
377</p>
<p>Page394
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
ContentProvider&#x5904;&#x7406;&#x5E76;&#x5206;&#x53D1;&#x7ED9;&#x5BF9;&#x5E94;&#x7684;&#x63D2;&#x4EF6;ContentProvider&#x3002;&#x5BF9;&#x4E8E;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x7684;
&#x539F;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x518D;&#x50CF;&#x5206;&#x6790;Activity&#x548C;Service&#x63D2;&#x4EF6;&#x5316;&#x90A3;&#x6837;&#x53BB;&#x5199;&#x4E00;&#x4E2A;&#x5C0F;&#x4F8B;&#x5B50;&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x662F;&#x6362;&#x4E00;&#x79CD;
&#x5F62;&#x5F0F;&#xFF0C;&#x5206;&#x6790;&#x6EF4;&#x6EF4;VirtualApk&#x7684;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x76F8;&#x4FE1;&#x6709;&#x4E86;&#x524D;&#x9762;&#x7684;&#x539F;&#x7406;
&#x79EF;&#x7D2F;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x518D;&#x53BB;&#x5206;&#x6790;&#x7B2C;&#x4E09;&#x65B9;&#x6846;&#x67B6;&#x4F1A;&#x8F7B;&#x677E;&#x8BB8;&#x591A;&#x3002;
15&#x3002;6&#x3002;2&#x3002;1VirtualApkI&#xC1;t
&#x8981;&#x60F3;&#x66F4;&#x597D;&#x5730;&#x7406;&#x89E3;VirtualApk&#x5BF9;&#x4E8E;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x5927;&#x6982;&#x4E86;&#x89E3;
VirtualApk&#x662F;&#x5982;&#x4F55;&#x521D;&#x59CB;&#x5316;&#x7684;&#x3002;VirtualApk&#x7ED9;&#x51FA;&#x4E86;&#x4F7F;&#x7528;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#xFF0C;&#x5728;MainActivity&#x7684;onCreate
&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;&#x4E86;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;
app/src/main/java/com/didi/virtualapk/MainActivity&#x3002;java
this&#x3002;loadPlugin&#xFF08;this&#xFF09;;
MainActivityjloadPluginT&#xFF1A;
app/src/main/java/com/didi/virtualapk/MainActivity&#x3002;java
privatevoidloadPlugin&#xFF08;Contextbase&#xFF09;{
PluginManagerpluginManager
PluginManager&#x3002;getInstance&#xFF08;base&#xFF09;;//1
Fileapk=newFile&#xFF08;Environment&#x3002;getExternalStorageDirectory&#xFF08;&#xFF09;&#xFF0C;&quot;Test&#x3002;apk&quot;&#xFF09;;
if&#xFF08;apk&#x3002;exists&#xFF08;&#xFF09;&#xFF09;{
try{
pluginManager&#x3002;loadPlugin&#xFF08;apk&#xFF09;;//2
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x7528;&#x4E8E;&#x521D;&#x59CB;&#x5316;&#x63D2;&#x4EF6;&#x5316;&#x7CFB;&#x7EDF;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x7528;&#x4E8E;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#x3002;PluginManager&#x7684;
getInstance&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/PluginManager&#x3002;java
publicstaticPluginManagergetInstance&#xFF08;Contextbase&#xFF09;{
if&#xFF08;sInstance==null&#xFF09;{
synchronized&#xFF08;PluginManager&#x3002;class&#xFF09;{
if&#xFF08;sInstance
null&#xFF09;
sInstance=newPluginManager&#xFF08;base&#xFF09;;
}
returnsInstance;
}
378</p>
<p>Page395
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
privatePluginManager&#xFF08;Contextcontext&#xFF09;{
Contextapp=context&#x3002;getApplicationContext&#xFF08;&#xFF09;;
if&#xFF08;app==null&#xFF09;{
this&#x3002;mContext=context;//1
}else{
this&#x3002;mContext=&#xFF08;&#xFF08;Application&#xFF09;app&#xFF09;&#x3002;getBaseContext&#xFF08;&#xFF09;;//2
}
prepare&#xFF08;&#xFF09;;
}
privatevoidprepare&#xFF08;&#xFF09;{
Systems&#x3002;sHostContext=getHostContext&#xFF08;&#xFF09;;//3
this&#x3002;hookInstrumentationAndHandler&#xFF08;&#xFF09;;//4
if&#xFF08;Build&#x3002;VERSION&#x3002;SDKINT&gt;=26&#xFF09;{
this&#x3002;hookAMSForO&#xFF08;&#xFF09;;
}else{
this&#x3002;hookSystemServices&#xFF08;&#xFF09;;
PluginManager&#x7684;getInstance&#x65B9;&#x6CD5;&#x91C7;&#x7528;&#x7684;&#x662F;&#x5355;&#x4F8B;&#x53CC;&#x91CD;&#x68C0;&#x67E5;&#x6A21;&#x5F0F;&#xFF08;DCL&#xFF09;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x83B7;
&#x53D6;&#x5BBF;&#x4E3B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;Context&#xFF0C;&#x503C;&#x4E3A;this&#x3002;mContext&#xFF0C;&#x5B83;&#x5728;&#x6CE8;&#x91CA;1&#x548C;&#x6CE8;&#x91CA;3&#x5904;&#x88AB;&#x8D4B;&#x503C;&#x3002;&#x6CE8;&#x91CA;4&#x5904;&#x7528;
&#x4E8E;HookInstrumentation&#x548C;H&#xFF0C;&#x63A5;&#x7740;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x7248;&#x672C;HookIActivityManager&#xFF0C;&#x8FD9;&#x4E9B;Hook
&#x539F;&#x7406;&#x5728;15&#x3002;4&#x8282;&#x4E2D;&#x90FD;&#x8BB2;&#x8FC7;&#x3002;&#x63A5;&#x7740;&#x56DE;&#x5934;&#x67E5;&#x770B;MainActivity&#x7684;loadPlugin&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x8C03;&#x7528;
JpluginManager#jloadPluginj&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/PluginManager&#x3002;java
publicvoidloadPlugin&#xFF08;Fileapk&#xFF09;throwsException{
LoadedPluginplugin
if&#xFF08;null!=plugin&#xFF09;{
=LoadedPlugin&#x3002;create&#xFF08;this&#xFF0C;this&#x3002;mContext&#xFF0C;apk&#xFF09;;//1
this&#x3002;mPlugins&#x3002;put&#xFF08;plugin&#x3002;getPackageName&#xFF08;&#xFF09;&#xFF0C;plugin&#xFF09;;
plugin&#x3002;invokeApplication&#xFF08;&#xFF09;;//2
}else{
throw
newRuntimeException&#xFF08;&quot;Can&apos;tloadpluginwhichisinvalid&#xFF1A;
apk&#x3002;getAbsolutePath&#xFF08;&#xFF09;&#xFF09;;
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x8C03;&#x7528;&#x4E86;LoadedPlugin&#x7684;create&#x65B9;&#x6CD5;&#x6765;&#x521B;&#x5EFA;LoadedPlugin&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2&#x5904;
&#x521B;&#x5EFA;&#x63D2;&#x4EF6;&#x7684;Application&#x3002;LoadedPlugin&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
LoadedPlugin&#xFF08;PluginManagerpluginManager&#xFF0C;Contextcontext&#xFF0C;
Fileapk&#xFF09;throws
PackageParser&#x3002;PackageParserException{
379</p>
<p>Page396
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
this&#x3002;mPluginManager
pluginManager;
%D
this&#x3002;mHostContext=context;
this&#x3002;mPluginContext=newPluginContext&#xFF08;this&#xFF09;;//1
this&#x3002;mNativeLibDir
context&#x3002;getDir&#xFF08;Constants&#x3002;NATIVEDIR&#xFF0C;
%3D
Context&#x3002;MODEPRIVATE&#xFF09;;
this&#x3002;mResources=createResources&#xFF08;context&#xFF0C;apk&#xFF09;;
this&#x3002;mClassLoader=createClassLoader&#xFF08;context&#xFF0C;apk&#xFF0C;this&#x3002;mNativeLibDir&#xFF0C;
context&#x3002;getClassLoader&#xFF08;&#xFF09;&#xFF09;;
//ContentProvider*#
Map<string，providerinfo>providers=newHashMap<string，providerinfo>&#xFF08;&#xFF09;;
Map<componentname，providerinfo>providerInfos=newHashMap<componentname， providerinfo="">&#xFF08;&#xFF09;;
}
LoadedPlugin&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4EE3;&#x7801;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x6BD4;&#x5982;
Packagelnfo&#x3001;Resources&#x3001;ClassLoader&#x7B49;&#xFF0C;&#x8FD8;&#x6709;&#x6709;&#x521B;&#x5EFA;&#x5B58;&#x50A8;&#x56DB;&#x5927;&#x7EC4;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x6BD4;&#x5982;
Map&#x7B49;&#x3002;&#x9700;&#x8981;&#x4E3B;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x6CE8;&#x91CA;1&#x5904;&#x4F1A;&#x521B;&#x5EFA;&#x63D2;&#x4EF6;&#x7684;&#x4E0A;&#x4E0B;&#x6587;PluginContext&#x3002;&#x5173;&#x4E8E;VirtualApk&#x521D;
&#x59CB;&#x5316;&#x5C31;&#x8BB2;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x56DE;&#x5230;ContentProvider&#x63D2;&#x4EF6;&#x5316;&#x8FD9;&#x4E00;&#x8BDD;&#x9898;&#x3002;
15&#x3002;6&#x3002;2&#x3002;2&#x542F;&#x52A8;&#x4EE3;&#x7406;ContentProvider
EMainActivityjonButtonClickJaontentProvider&#xFF0C;knFT&#xFF1A;
app/src/main/java/com/didi/virtualapk/MainActivity&#x3002;java
publicvoidonButtonClick&#xFF08;Viewv&#xFF09;{
if&#xFF08;v&#x3002;getId&#xFF08;&#xFF09;
finalStringpkg</componentname，></componentname，providerinfo></string，providerinfo></string，providerinfo></p>
<h1 id="r&#x3002;id&#x3002;button&#xFF09;"><a name="r&#x3002;id&#x3002;button&#xFF09;" class="anchor-navigation-ex-anchor" href="#r&#x3002;id&#x3002;button&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>6. R&#x3002;id&#x3002;button&#xFF09;{</h1>
<p>&quot;com&#x3002;didi&#x3002;virtualapk&#x3002;demo&quot;;
%3D
&#x3002;&#x3002;
//testContentProvider
Uribook&#xFC;ri=Uri&#x3002;parse&#xFF08;&quot;content&#xFF1A;//com&#x3002;didi&#x3002;virtualapk&#x3002;demo&#x3002;book&#x3002;
provider/book&quot;&#xFF09;;
PluginManager&#x3002;getInstance&#xFF08;this&#xFF09;&#x3002;getLoadedPlugin
LoadedPluginplugin
&#xFF08;pkg&#xFF09;;
bookUri=
PluginContentResolver&#x3002;wrapperUri&#xFF08;plugin&#xFF0C;bookUri&#xFF09;;
CursorbookCursor=getContentResolver&#xFF08;&#xFF09;&#x3002;query&#xFF08;bookUri&#xFF0C;newString[]
{&quot;_id&quot;&#xFF0C;&quot;name&quot;}&#xFF0C;null&#xFF0C;null&#xFF0C;null&#xFF09;;//1
}elseif&#xFF08;v&#x3002;getId&#xFF08;&#xFF09;
showAbout&#xFF08;&#xFF09;;
R&#x3002;id&#x3002;about&#xFF09;{
}
}
380</p>
<p>Page397
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
EActivity&#xCD;VirtualApktitHookInstrumentationJ&#xC6;t&#xFF0C;&#xC6;VAInstrumentation
tjcallActivityOnCreate7jPluginContextJContextWrapperJEaBase&#xFF0C;
mBase&#x662F;Context&#x7C7B;&#x578B;&#x7684;&#xFF0C;&#x4E0D;&#x4E86;&#x89E3;mBase&#x7684;&#x8BF7;&#x67E5;&#x770B;&#x7B2C;5&#x7AE0;&#x3002;&#x6CE8;&#x91CA;1&#x5904;&#x7684;getContentResolver
&#x5B9E;&#x9645;&#x8C03;&#x7528;&#x7684;&#x662F;PluginContext&#x7684;getContentResolver&#x65B9;&#x6CD5;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/PluginContext&#x3002;java
@Override
publicContentResolvergetContentResolver&#xFF08;&#xFF09;{
returnnewPluginContentResolver&#xFF08;getHostContext&#xFF08;&#xFF09;&#xFF09;;
}
EgetContentResolverjATPluginContentResolverF&#xFF08;4TContext&#xFF0C;
&#x56E0;&#x6B64;&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;getContentResolver&#x7684;query&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x8C03;&#x7528;&#x4E86;PluginContentResolver
&#x7684;query&#x65B9;&#x6CD5;&#x3002;&#x6839;&#x636E;&#x56FE;15-12&#x6240;&#x793A;&#x53EF;&#x77E5;&#xFF0C;query&#x65B9;&#x6CD5;&#x4F1A;&#x8C03;&#x7528;ContentResolver&#x7684;
acquireUnstableProviderj&#xFF0C;PluginContentResolverETacquireUnstableProviderj&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/PluginContentResolver&#x3002;java
protectedIContentProvideracquireUnstableProvider&#xFF08;Contextcontext&#xFF0C;Stringauth&#xFF09;{
try{
if&#xFF08;mPluginManager&#x3002;resolveContentProvider&#xFF08;auth&#xFF0C;0&#xFF09;
returnmPluginManager&#x3002;getIContentProvider&#xFF08;&#xFF09;;
!=null&#xFF09;{//1
}
return&#xFF08;IContentProvider&#xFF09;sAcquireUnstableProvider&#x3002;invoke&#xFF08;mBase&#xFF0C;context&#xFF0C;
auth&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
returnnull;
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x4F1A;&#x67E5;&#x627E;&#x63D2;&#x4EF6;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x5339;&#x914D;&#x7684;ContentProvider&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5C31;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;
ContentResolver&#xFD;acquireUnstableProvider&#xFF0C;#0i6AAPluginManagerJ
getIContentProviderj&#xFF0C;kuFH&#xFF1A;
publicsynchronizedIContentProvidergetIContentProvider&#xFF08;&#xFF09;{
if&#xFF08;mIContentProvider==
null&#xFF09;
hookIContentProviderAsNeeded&#xFF08;&#xFF09;;
returnmIContentProvider;
hookIContentProviderAsNeededT&#xFF1A;
381</p>
<p>Page398
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
CoreLibrary/src/main/java/com/didi/virtualapk/PluginManager&#x3002;java
privatevoidhookIContentProviderAsNeeded&#xFF08;&#xFF09;{
//#aontentResolver#jUri
Uriuri=Uri&#x3002;parse&#xFF08;PluginContentResolver&#x3002;getUri&#xFF08;mContext&#xFF09;&#xFF09;;//1
//IContentProvider
mContext&#x3002;getContentResolver&#xFF08;&#xFF09;&#x3002;call&#xFF08;uri&#xFF0C;&quot;wakeup&quot;&#xFF0C;null&#xFF0C;nul1&#xFF09;;//2
try{
Fieldauthority
null;
FieldmProvider
null;
//&amp;ActivityThreadA
ActivityThreadactivityThread
&#xFF08;ActivityThread&#xFF09;ReflectUtil&#x3002;
getActivityThread&#xFF08;mContext&#xFF09;;
MapmProviderMap=&#xFF08;Map&#xFF09;ReflectUtil&#x3002;getField&#xFF08;activityThread&#x3002;getClass&#xFF08;&#xFF09;&#xFF0C;
activityThread&#xFF0C;&quot;mProviderMap&quot;&#xFF09;;//3
%3D
Iteratoriter
mProviderMap&#x3002;entrySet&#xFF08;&#xFF09;&#x3002;iterator&#xFF08;&#xFF09;;
while&#xFF08;iter&#x3002;hasNext&#xFF08;O&#xFF09;{
Map&#x3002;Entryentry=&#xFF08;Map&#x3002;Entry&#xFF09;iter&#x3002;next&#xFF08;&#xFF09;;
Objectkey
entry&#x3002;getKey&#xFF08;&#xFF09;;
Objectval=entry&#x3002;getValue&#xFF08;&#xFF09;;
Stringauth;
if&#xFF08;keyinstanceofString&#xFF09;{
auth=
&#xFF08;String&#xFF09;key;
}else{
if&#xFF08;authority
==null&#xFF09;{
authority
key&#x3002;getClass&#xFF08;&#xFF09;&#x3002;getDeclaredField&#xFF08;&quot;authority&quot;&#xFF09;;
%3D
authority&#x3002;setAccessible&#xFF08;true&#xFF09;;
}
auth=&#xFF08;String&#xFF09;authority&#x3002;get&#xFF08;key&#xFF09;;
}
if&#xFF08;auth&#x3002;equals&#xFF08;PluginContentResolver&#x3002;getAuthority&#xFF08;mContext&#xFF09;&#xFF09;&#xFF09;{
if&#xFF08;mProvider==
null&#xFF09;
mProvider=val&#x3002;getClass&#xFF08;&#xFF09;&#x3002;getDeclaredField&#xFF08;&quot;mProvider&quot;&#xFF09;;
mProvider&#x3002;setAccessible&#xFF08;true&#xFF09;;
IContentProviderrawProvider=
&#xFF08;IContentProvider&#xFF09;mProvider&#x3002;
get&#xFF08;val&#xFF09;;
IContentProviderproxy=IContentProviderProxy&#x3002;newInstance
&#xFF08;mContext&#xFF0C;rawProvider&#xFF09;;///4
mIContentProvider=proxy;//5
Log&#x3002;d&#xFF08;TAG&#xFF0C;&quot;hookIContentProvidersucceed&#xFF1A;
&quot;+mIContentProvider&#xFF09;;
break;
}catch&#xFF08;Exceptione&#xFF09;
{
382</p>
<p>Page399
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
&#x4ECE;&#x65B9;&#x6CD5;&#x540D;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x7528;&#x6765;HookIContentProvider&#x7684;&#x3002;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x83B7;&#x5F97;&#x4EE3;
&#x7406;ContentResolver&#x7684;Uri&#x3002;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x8C03;&#x7528;ContentResolver&#x7684;call&#x65B9;&#x6CD5;&#xFF0C;mContext&#x662F;&#x5BBF;&#x4E3B;
&#x7684;Context&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x7684;&#x662F;&#x5BBF;&#x4E3B;ContentResolver&#x7684;call&#x65B9;&#x6CD5;&#xFF0C;&#x7528;&#x4E8E;&#x5F97;&#x5230;IContentProvider&#x3002;
ERE#3LActivityThread#jmProviderMap&#xFF0C;F*5mProviderMap&#xFF0C;#E#&#xFF09;CR
IContentProvider&#xFF0C;E&#xC8;#5La&#xFF0C;IContentProviderProxyIContentProvider&#xFF0C;Hook
IContentProvider&#xFF0C;IContentProviderProxyfjwrapperUrijE&#x2606;aiUrifj&#xFF0C;ku
&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi//virtualapk/delegate/IContentProviderProxy&#x3002;java
privatevoidwrapperUri&#xFF08;Methodmethod&#xFF0C;Object[]args&#xFF09;{
PluginManagerpluginManager
ProviderInfoinfo=pluginManager&#x3002;resolveContentProvider&#xFF08;uri&#x3002;getAuthority&#xFF08;&#xFF09;&#xFF0C;0&#xFF09;;
PluginManager&#x3002;getInstance&#xFF08;mContext&#xFF09;;
if&#xFF08;info!=null&#xFF09;{
Stringpkg=info&#x3002;packageName;
pluginManager&#x3002;getLoadedPlugin&#xFF08;pkg&#xFF09;;
=Uri&#x3002;encode&#xFF08;uri&#x3002;toString&#xFF08;&#xFF09;&#xFF09;;
LoadedPluginplugin
StringpluginUri
StringBuilderbuilder=newStringBuilder&#xFF08;PluginContentResolver&#x3002;getUri
&#xFF08;mContext&#xFF09;&#xFF09;;//1
builder&#x3002;append&#xFF08;&quot;/?plugin=&quot;+plugin&#x3002;getLocation&#xFF08;&#xFF09;&#xFF09;;
builder&#x3002;append&#xFF08;&quot;&amp;pkg=&quot;+pkg&#xFF09;;
builder&#x3002;append&#xFF08;&quot;&amp;uri=&quot;+pluginUri&#xFF09;;
UriwrapperUri
Uri&#x3002;parse&#xFF08;builder&#x3002;toString&#xFF08;&#xFF09;&#xFF09;;//2
%3D
if&#xFF08;method&#x3002;getName&#xFF08;&#xFF09;&#x3002;equals&#xFF08;&quot;call&quot;&#xFF09;&#xFF09;{
bundleInCallMethod&#x3002;putString&#xFF08;KEY_WRAPPER_URI&#xFF0C;wrapperUri&#x3002;toString&#xFF08;&#xFF09;&#xFF09;;
}else{
args[index]
wrapperUri;//3
}
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x83B7;&#x53D6;&#x63D2;&#x4EF6;&#x7684;Uri&#x5E76;&#x5C01;&#x88C5;&#x6210;StringBuilder&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5BF9;StringBuilder&#x8FDB;&#x884C;&#x62FC;&#x63A5;&#xFF0C;
&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x65B0;&#x7684;Uri&#xFF0C;&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x66FF;&#x6362;Uri&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;ContentProvider
&#x65F6;&#x4F1A;&#x5148;&#x542F;&#x52A8;&#x4EE3;&#x7406;ContentProvider&#x3002;
15&#x3002;6&#x3002;2&#x3002;3&#x4EE3;&#x7406;&#x5206;&#x53D1;
EHContentProviderEAndroidManifest&#x3002;xmlHt&#xFF0C;kuFHF&#xFF1A;
383</p>
<p>Page400
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
CoreLibrary/src/main/AndroidManifest&#x3002;xml</p>
<p><provider android：name="com&#x3002;didi&#x3002;virtualapk&#x3002;delegate&#x3002;RemoteContentProvider" android：authorities="${applicationId}&#x3002;VirtualAPK&#x3002;Provider" android：process="&#xFF1A;daemon">
&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;ContentProvider&#x7684;query&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5B9E;&#x9645;&#x4F1A;&#x8C03;&#x7528;RemoteContentProvider&#x7684;
query&#x65B9;&#x6CD5;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/delegate/RemoteContentProvider&#x3002;java
@Override
publicCursorquery&#xFF08;Uriuri&#xFF0C;String[]projection&#xFF0C;Stringselection&#xFF0C;String[]
selectionArgs&#xFF0C;StringsortOrder&#xFF09;{
ContentProviderprovider=getContentProvider&#xFF08;uri&#xFF09;;//1
UripluginUri
Uri&#x3002;parse&#xFF08;uri&#x3002;getQueryParameter&#xFF08;KEYURI&#xFF09;&#xFF09;;
if&#xFF08;provider!=null&#xFF09;{
returnprovider&#x3002;query&#xFF08;pluginUri&#xFF0C;projection&#xFF0C;selection&#xFF0C;selectionArgs&#xFF0C;
sortOrder&#xFF09;;
}
returnnull;
}
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x4F1A;&#x901A;&#x8FC7;RemoteContentProvider&#x7684;getContentProvider&#x65B9;&#x6CD5;&#x5F97;&#x5230;&#x4E00;&#x4E2A;
ContentProvider&#xFF0C;#&#xC8;&#xC1;query&#xFF0C;RemoteContentProvider&#xC1;jgetContentProvider
&#x6CD5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/delegate/RemoteContentProvider&#x3002;java
privateContentProvidergetContentProvider&#xFF08;finalUriuri&#xFF09;{
finalPluginManagerpluginManager
PluginManager&#x3002;getInstance&#xFF08;getContext&#xFF08;&#xFF09;&#xFF09;;
UripluginUri
finalStringauth=pluginUri&#x3002;getAuthority&#xFF08;&#xFF09;;
=Uri&#x3002;parse&#xFF08;uri&#x3002;getQueryParameter&#xFF08;KEY_URI&#xFF09;&#xFF09;;
%3D
ContentProvidercachedProvider=sCachedProviders&#x3002;get&#xFF08;auth&#xFF09;;//1
if&#xFF08;cachedProvider!=null&#xFF09;{
returncachedProvider;
}
synchronized&#xFF08;sCachedProviders&#xFF09;{
LoadedPluginplugin
pluginManager&#x3002;getLoadedPlugin&#xFF08;uri&#x3002;getQueryParameter
&#xFF08;KEYPKG&#xFF09;&#xFF09;;
if&#xFF08;plugin</provider></p>
<h1 id="null&#xFF09;"><a name="null&#xFF09;" class="anchor-navigation-ex-anchor" href="#null&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>7. null&#xFF09;{</h1>
<p>try{
pluginManager&#x3002;loadPlugin&#xFF08;newFile&#xFF08;uri&#x3002;getQueryParameter&#xFF08;KEY
PLUGIN&#xFF09;&#xFF09;&#xFF09;;//2
}catch&#xFF08;Exceptione&#xFF09;
384</p>
<p>Page401
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
finalProviderInfoproviderInfo=pluginManager&#x3002;resolveContentProvider&#xFF08;auth&#xFF0C;
0&#xFF09;;//3
if&#xFF08;providerInfo!=null&#xFF09;{
RunUtil&#x3002;runOnUiThread&#xFF08;newRunnable&#xFF08;&#xFF09;{
@Override
publicvoidrun&#xFF08;&#xFF09;{
try{
LoadedPluginloadedPlugin=pluginManager&#x3002;getLoadedPlugin&#xFF08;uri&#x3002;
getQueryParameter&#xFF08;KEY_PKG&#xFF09;&#xFF09;;
ContentProvidercontentProvider=&#xFF08;ContentProvider&#xFF09;Class&#x3002;
forName&#xFF08;providerInfo&#x3002;name&#xFF09;&#x3002;newInstance&#xFF08;&#xFF09;;//4
contentProvider&#x3002;attachInfo&#xFF08;loadedPlugin&#x3002;getPluginContext&#xFF08;&#xFF09;&#xFF0C;
providerInfo&#xFF09;;//5
sCachedProviders&#x3002;put&#xFF08;auth&#xFF0C;contentProvider&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
}&#xFF0C;true&#xFF09;;
returnsCachedProviders&#x3002;get&#xFF08;auth&#xFF09;;
}
}
returnnull;
}
&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x662F;&#x63D2;&#x4EF6;uri&#x5E76;&#x89E3;&#x6790;&#x4E3A;auth&#xFF0C;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x4F1A;&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x8BFB;&#x53D6;&#x662F;&#x5426;&#x6709;&#x5339;&#x914D;auth&#x7684;
&#x63D2;&#x4EF6;ContentProvider&#xFF0C;&#x6CA1;&#x6709;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;APK&#xFF0C;&#x5E76;&#x4ECE;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;APK&#x4E2D;&#x5F97;&#x5230;
&#x5339;&#x914D;auth&#x7684;ProviderInfo&#xFF0C;&#x6839;&#x636E;&#x8FD9;&#x4E2A;ProviderInfo&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6CE8;&#x91CA;4&#x5904;&#x521B;&#x5EFA;&#x63D2;&#x4EF6;ContentProvider&#x3002;
&#x5728;&#x6CE8;&#x91CA;5&#x5904;&#x8C03;&#x7528;&#x63D2;&#x4EF6;ContentProvider&#x7684;attachInfo&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x4F1A;&#x4E3A;&#x63D2;&#x4EF6;ContentProvider
&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x5E76;&#x8C03;&#x7528;&#x5B83;&#x7684;onCreate&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x63D2;&#x4EF6;ContentProvider&#x5C31;&#x542F;&#x52A8;&#x4E86;&#x3002;&#x6700;&#x540E;&#x5C06;&#x8FD9;&#x4E2A;&#x65B0;&#x521B;
&#x5EFA;&#x7684;&#x63D2;&#x4EF6;ContentProvider&#x52A0;&#x5165;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x907F;&#x514D;&#x91CD;&#x590D;&#x521B;&#x5EFA;&#x63D2;&#x4EF6;ContentProvider&#x3002;
15&#x3002;7BroadcastReceiverfjiiA&#x141;
BroadcastReceiverE
&#x4E3A;&#x4E24;&#x79CD;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x548C;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#xFF0C;&#x5728;4&#x3002;4&#x8282;&#x4ECB;&#x7ECD;&#x4E86;
BroadcastReceiver&#x7684;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#xFF0C;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#x901A;&#x8FC7;AMS&#x6765;&#x5B8C;&#x6210;&#xFF0C;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#x7684;&#x4FE1;&#x606F;&#x4F1A;&#x5B58;&#x5728;AMS
385</p>
<p>Page402
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
&#x4E2D;&#x3002;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x9700;&#x8981;&#x5728;AndroidManifest&#x3002;xml&#x4E2D;&#x6CE8;&#x518C;&#xFF0C;&#x5E94;&#x7528;&#x5728;&#x5B89;&#x88C5;&#x65F6;&#xFF0C;PackageManagerService
&#xFF08;PMS&#xFF09;APackageParser&apos;JparsePackage<em>APK&#xFF0C;itAPK#
AndroidManifest&#x3002;xml&#x6587;&#x4EF6;&#x7684;&#x6807;&#x7B7E;&#x5F97;&#x5230;APK&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x4FE1;&#x606F;&#x5E76;&#x5C01;&#x88C5;&#x6210;&#x76F8;&#x5E94;&#x7684;&#x4FE1;&#x606F;&#x7C7B;&#xFF0C;&#x6BD4;&#x5982;
ApplicationInfo&#x3001;ProviderInfo&#x548C;Activitylnfo&#x7B49;&#xFF0C;&#x56E0;&#x6B64;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#x7684;&#x4FE1;&#x606F;&#x4F1A;&#x5B58;&#x5728;PMS&#x4E2D;&#x3002;
15&#x3002;7&#x3002;1&#x3002;&#x5E7F;&#x64AD;&#x63D2;&#x4EF6;&#x5316;&#x601D;&#x8DEF;
AEBroadcastReceiverEAndroidManifest&#x3002;xmli<intent-filter>j;&#xFF0C;
BroadcastReceiver&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x6807;&#x7B7E;&#x4E2D;&#x7684;&#x503C;&#x6765;&#x63A5;&#x6536;&#x201C;&#x611F;&#x5174;&#x8DA3;&#x201D;&#x7684;&#x5E7F;&#x64AD;&#x3002;&#x5982;&#x679C;&#x91C7;&#x7528;&#x7C7B;&#x4F3C;Activity
EERGHookIActivityManager7&#xFF0C;H-T5EBroadcastReceiver</intent-filter></em>Al&amp;s*at
&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x9884;&#x6599;&#x63D2;&#x4EF6;&#x4E2D;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver&#x7684;<intent-filter>&#x6807;&#x7B7E;&#xFF0C;&#x8FD9;&#x6837;&#x5360;
&#x5751;BroadcastReceiver&#x65E0;&#x6CD5;&#x63A5;&#x6536;&#x5230;&#x201C;&#x611F;&#x5174;&#x8DA3;&#x201D;&#x7684;&#x5E7F;&#x64AD;&#x3002;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver&#x7684;</intent-filter></p>
<p><intent-filter>&#x6807;&#x7B7E;&#x65E0;&#x6CD5;&#x52A8;&#x6001;&#x8BBE;&#x7F6E;&#xFF0C;&#x4F46;&#x662F;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver&#x662F;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x8BBE;&#x7F6E;
IntentFilter&#x7684;&#xFF0C;&#x8BB2;&#x5230;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x601D;&#x8DEF;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5C06;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver
&#x5168;&#x90E8;&#x8F6C;&#x6362;&#x4E3A;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#x6765;&#x5904;&#x7406;&#xFF0C;&#x867D;&#x7136;&#x9759;&#x6001;&#x548C;&#x52A8;&#x6001;&#x7684;BroadcastReceiver&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E0D;&#x540C;&#xFF0C;&#x4F46;&#x662F;
&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x63D2;&#x4EF6;&#x5316;&#xFF0C;&#x8FD9;&#x4E2A;&#x7F3A;&#x70B9;&#x663E;&#x7136;&#x4E0D;&#x662F;&#x5173;&#x952E;&#x95EE;&#x9898;&#x3002;
15&#x3002;7&#x3002;2VirtualApk#J&#xC6;
&#x5728;LoadedPlugin&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B9E;&#x73B0;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver&#x8F6C;&#x6362;&#x4E3A;&#x52A8;&#x6001;&#x6CE8;&#x518C;&#xFF0C;&#x5982;
&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/LcadedPlugin&#x3002;java
LoadedPlugin&#xFF08;PluginManagerpluginManager&#xFF0C;Context
context&#xFF0C;
Fileapk&#xFF09;
throws
PackageParser&#x3002;PackageParserException{
Map<componentname，activityinfo>receivers=newHashMap<componentname， activityinfo="">&#xFF08;&#xFF09;;//1
for&#xFF08;PackageParser&#x3002;Activityreceiver&#xFF1A;this&#x3002;mPackage&#x3002;receivers&#xFF09;{
receivers&#x3002;put&#xFF08;receiver&#x3002;getComponentName&#xFF08;&#xFF09;&#xFF0C;receiver&#x3002;info&#xFF09;;//2
try{
BroadcastReceiverbr
BroadcastReceiver&#x3002;class&#x3002;
%3D
cast&#xFF08;getClassLoader&#xFF08;&#xFF09;&#x3002;loadClass&#xFF08;receiver&#x3002;getComponentName&#xFF08;&#xFF09;&#x3002;
getClassName&#xFF08;&#xFF09;&#xFF09;&#x3002;newInstance&#xFF08;&#xFF09;&#xFF09;;//3
for&#xFF08;PackageParser&#x3002;ActivityIntentInfoaii&#xFF1A;receiver&#x3002;intents&#xFF09;
this&#x3002;mHostContext&#x3002;registerReceiver&#xFF08;br&#xFF0C;aii&#xFF09;;//4
}catch&#xFF08;Exceptione&#xFF09;{
386</componentname，></componentname，activityinfo></intent-filter></p>
<p>Page403
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
this&#x3002;mReceiverInfos=Collections&#x3002;unmodifiableMap&#xFF08;receivers&#xFF09;;
this&#x3002;mPackageInfo&#x3002;receivers
=receivers&#x3002;values&#xFF08;&#xFF09;&#x3002;toArray&#xFF08;newActivityInfo
[receivers&#x3002;size&#xFF08;&#xFF09;]&#xFF09;;
&#x6CE8;&#x91CA;1&#x5904;&#x7684;receivers&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x63D2;&#x4EF6;&#x4E2D;&#x9759;&#x6001;&#x6CE8;&#x518C;&#x7684;BroadcastReceiver&#x4FE1;&#x606F;&#xFF0C;&#x6709;&#x7684;&#x8BFB;&#x8005;&#x53EF;
&#x80FD;&#x4F1A;&#x6709;&#x7591;&#x95EE;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;receivers&#x7684;&#x6CDB;&#x578B;&#x7C7B;&#x578B;&#x4F1A;&#x662F;ActivityInfo&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;PackageParser&#x5728;&#x89E3;&#x6790;
AndroidManifest&#x3002;xml&#x65F6;&#x628A;<receiver>&#x6807;&#x7B7E;&#x5F53;&#x4F5C;<activity>&#x6807;&#x7B7E;&#x5904;&#x7406;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x89E3;&#x6790;&#x5F97;&#x5230;&#x7684;
BroadcastReceiverfLatactivityInfo#&#xFF0C;&#xC6;E#2LAraroadcastReceiverf&#x3002;
&#x5B58;&#x50A8;&#x5728;receivers&#x4E2D;&#x3002;&#x6CE8;&#x91CA;3&#x5904;&#x7684;&#x4EE3;&#x7801;&#x6709;&#x70B9;&#x957F;&#xFF0C;&#x5B83;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x6B65;&#x9AA4;&#xFF0C;&#x6B65;&#x9AA4;1&#x6839;&#x636E;&#x63D2;&#x4EF6;
BroadcastReceiverJ*&#x2606;&#xFF0C;
ClassLoader&#x52A0;&#x8F7D;&#x5E76;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF08;&#x7C7B;&#x578B;&#x4E3A;Object&#xFF09;;&#x6B65;&#x9AA4;2&#x662F;&#x5C06;
ObjectBroadcastReceiverKH&#xFF0C;EE#4bIHContextf#jregisterReceiverj
&#x6CD5;&#x6765;&#x5B8C;&#x6210;&#x63D2;&#x4EF6;BroadcastReceiver&#x7684;&#x6CE8;&#x518C;&#x3002;
15&#x3002;8&#x8D44;&#x6E90;&#x7684;&#x63D2;&#x4EF6;&#x5316;
&#x5728;&#x4E0A;&#x4E00;&#x7AE0;&#x8BB2;&#x89E3;&#x70ED;&#x4FEE;&#x590D;&#x539F;&#x7406;&#x65F6;&#x8BB2;&#x89E3;&#x4E86;&#x8D44;&#x6E90;&#x4FEE;&#x590D;&#xFF0C;&#x8D44;&#x6E90;&#x4FEE;&#x590D;&#x4E0E;AssetManager&#x662F;&#x6709;&#x5173;&#x7684;&#xFF0C;&#x540C;
&#x6837;&#x5730;&#xFF0C;&#x8D44;&#x6E90;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x4E5F;&#x662F;&#x5982;&#x6B64;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x7CFB;&#x7EDF;&#x7684;&#x8D44;&#x6E90;&#x662F;&#x5982;&#x4F55;&#x52A0;&#x8F7D;&#x7684;&#x3002;
15&#x3002;8&#x3002;1&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;
&#x542F;&#x52A8;Activity&#x65F6;&#x4F1A;&#x8C03;&#x7528;performLaunchActivity&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x4F1A;&#x8C03;&#x7528;LoadedApk&#x7684;
makeApplication
frameworks/base/core/java/android/app/LoadedApk&#x3002;java
publicApplicationmakeApplication&#xFF08;booleanforceDefaultAppClass&#xFF0C;
Instrumentationinstrumentation&#xFF09;{
ContextImplappContext
=ContextImpl&#x3002;createAppContext&#xFF08;mActivityThread&#xFF0C;
this&#xFF09;;
app=
mActivityThread&#x3002;mInstrumentation&#x3002;newApplication&#xFF08;
cl&#xFF0C;appClass&#xFF0C;appContext&#xFF09;;//1
appContext&#x3002;setOuterContext&#xFF08;app&#xFF09;;
387</activity></receiver></p>
<p>Page404
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
EE1Application&#xFF0C;ContextImplfjcreateAppContextj&#xA3;T&#xD4;
Context&#xFF1A;
frameworks/base/core/javalandroid/app/ContextImpl&#x3002;java
staticContextImplcreateAppContext&#xFF08;ActivityThreadmainThread&#xFF0C;LoadedApkpackageInfo&#xFF09;{
if&#xFF08;packageInfo
ContextImplcontext=newContextImpl&#xFF08;null&#xFF0C;mainThread&#xFF0C;packageInfo&#xFF0C;null&#xFF0C;null&#xFF0C;</p>
<h1 id="null&#xFF09;thrownewillegalargumentexception&#xFF08;packageinfo&#xFF09;"><a name="null&#xFF09;thrownewillegalargumentexception&#xFF08;packageinfo&#xFF09;" class="anchor-navigation-ex-anchor" href="#null&#xFF09;thrownewillegalargumentexception&#xFF08;packageinfo&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>8. null&#xFF09;thrownewIllegalArgumentException&#xFF08;&quot;packageInfo&quot;&#xFF09;;</h1>
<p>null&#xFF0C;0&#xFF0C;null&#xFF09;;
context&#x3002;setResources&#xFF08;packageInfo&#x3002;getResources&#xFF08;&#xFF09;&#xFF09;;//1
returncontext;
}
E&#xC8;#1LLoadedApkJgetResourcesENResources&#xFF0C;}#Resourcesiti
AContextImpl&#xFF0C;LoadedApkfjgetResourcesFHis&#xFF1A;
frameworks/base/core/javalandroid/app/LoadedApk&#x3002;java
publicResourcesgetResources&#xFF08;&#xFF09;{
mResources=ResourcesManager&#x3002;getInstance&#xFF08;&#xFF09;&#x3002;getResources&#xFF08;null&#xFF0C;mResDir&#xFF0C;
splitPaths&#xFF0C;mOverlayDirs&#xFF0C;mApplicationInfo&#x3002;sharedLibraryFiles&#xFF0C;
Display&#x3002;DEFAULT_DISPLAY&#xFF0C;null&#xFF0C;getCompatibilityInfo&#xFF08;&#xFF09;&#xFF0C;
getClassLoader&#xFF08;&#xFF09;&#xFF09;;
}
returnmResources;
}
getResourcesiEAAResourcesManagerjgetResources&#xFF0C;AWA
getOrCreateResources&#xFF1A;
private@NullableResourcesgetOrCreateResources&#xFF08;@NullableIBinderactivityToken&#xFF0C;
@NonNullResourcesKeykey&#xFF0C;@NonNullClassLoaderclassLoader&#xFF09;{
ResourcesImplresourcesImpl=createResourcesImpl&#xFF08;key&#xFF09;;//1
if&#xFF08;resourcesImpl==null&#xFF09;{
returnnull;
}
synchronized&#xFF08;this&#xFF09;{
finalResourcesresources;
if&#xFF08;activityToken!=null&#xFF09;{
resources=
getorCreateResourcesForActivityLocked&#xFF08;activityToken&#xFF0C;
classLoader&#xFF0C;resourcesImpl&#xFF0C;key&#x3002;mCompatInfo&#xFF09;;//2
}else{
resources
getOrCreateResourcesLocked&#xFF08;classLoader&#xFF0C;resourcesImpl&#xFF0C;
%3D
key&#x3002;mCompatInfo&#xFF09;;
388</p>
<p>Page405
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
}
returnresources;
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x521B;&#x5EFA;ResourcesImpl&#xFF0C;&#x5B83;&#x7528;&#x4E8E;&#x5177;&#x4F53;&#x5B9E;&#x73B0;Resources&#xFF0C;&#x5728;Resources&#x521B;&#x5EFA;&#x540E;&#xFF0C;&#x4F1A;
&#x8C03;&#x7528;Resources&#x7684;setImpl&#x65B9;&#x6CD5;&#x5C06;ResourcesImpl&#x8BBE;&#x7F6E;&#x8FDB;&#x53BB;&#x3002;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x521B;&#x5EFA;Resources&#x3002;
createResourcesImplj&#xA3;Fs&#xFF1A;
frameworks/base/core/java/android/app/ResourcesManager&#x3002;java
private@NullableResourcesImplcreateResourcesImpl&#xFF08;@NonNullResourcesKeykey&#xFF09;{
finalDisplayAdjustmentsdaj
=newDisplayAdjustments&#xFF08;key&#x3002;mOverride
Configuration&#xFF09;;
daj&#x3002;setCompatibilityInfo&#xFF08;key&#x3002;mCompatInfo&#xFF09;;
finalAssetManagerassets=createAssetManager&#xFF08;key&#xFF09;;//l
if&#xFF08;assets==
null&#xFF09;{
returnnull;
}
finalDisplayMetricsdm=
finalConfigurationconfig
finalResourcesImplimpl
getDisplayMetrics&#xFF08;key&#x3002;mDisplayId&#xFF0C;daj&#xFF09;;
generateConfig&#xFF08;key&#xFF0C;dm&#xFF09;;
=newResourcesImpl&#xFF08;assets&#xFF0C;dm&#xFF0C;config&#xFF0C;daj&#xFF09;;//2
%3D
if&#xFF08;DEBUG&#xFF09;{
Slog&#x3002;d&#xFF08;TAG&#xFF0C;
&quot;withkey&#xFF1A;
+key&#xFF09;;
I&quot;-
creatingimpl=&quot;+impl+
}
returnimpl;
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x521B;&#x5EFA;AssetManager&#xFF0C;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x65B0;&#x5EFA;ResourcesImpl&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x5C06;AssetManager
&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x8FDB;&#x53BB;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;Resources&#x4F1A;&#x4F9D;&#x8D56;AssetManager&#x6765;&#x52A0;&#x8F7D;&#x8D44;&#x6E90;&#x3002;
15&#x3002;8&#x3002;2VirtualApkN
&#x8D44;&#x6E90;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x65B9;&#x6848;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#xFF1A;&#x4E00;&#x79CD;&#x662F;&#x5408;&#x5E76;&#x8D44;&#x6E90;&#x65B9;&#x6848;&#xFF0C;&#x5C06;&#x63D2;&#x4EF6;&#x7684;&#x8D44;&#x6E90;&#x5168;&#x90E8;&#x6DFB;&#x52A0;&#x5230;&#x5BBF;&#x4E3B;
&#x7684;Resources&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6848;&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5BBF;&#x4E3B;&#x7684;&#x8D44;&#x6E90;&#x3002;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x6784;&#x5EFA;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;&#x65B9;&#x6848;&#xFF0C;&#x6BCF;&#x4E2A;&#x63D2;
&#x4EF6;&#x90FD;&#x6784;&#x9020;&#x51FA;&#x72EC;&#x7ACB;&#x7684;Resources&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6848;&#x63D2;&#x4EF6;&#x4E0D;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5BBF;&#x4E3B;&#x8D44;&#x6E90;&#x3002;VirtualApk&#x91C7;&#x7528;&#x4E86;&#x4EE5;&#x4E0A;
&#x4E24;&#x79CD;&#x65B9;&#x6848;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x5728;LoadedPlugin&#x4E2D;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/LoadedPlugin&#x3002;java
@WorkerThread
privatestaticResourcescreateResources&#xFF08;Contextcontext&#xFF0C;Fileapk&#xFF09;{
if&#xFF08;Constants&#x3002;COMBINERESOURCES&#xFF09;{
Resources
resources
ResourcesManager&#x3002;createResources&#xFF08;context&#xFF0C;apk&#x3002;
getAbsolutePath&#xFF08;&#xFF09;&#xFF09;;
389</p>
<p>Page406
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
ResourcesManager&#x3002;hookResources&#xFF08;context&#xFF0C;resources&#xFF09;;//1
returnresources;
}else{
ResourceshostResources=context&#x3002;getResources&#xFF08;&#xFF09;;
AssetManagerassetManager=createAssetManager&#xFF08;context&#xFF0C;apk&#xFF09;;//2
return
new
Resources&#xFF08;assetManager&#xFF0C;hostResources&#x3002;getDisplayMetrics&#xFF08;&#xFF09;&#xFF0C;
hostResources&#x3002;getConfiguration&#xFF08;&#xFF09;&#xFF09;;//3
}
createResources&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x521B;&#x5EFA;Resources&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5408;&#x5E76;&#x8D44;&#x6E90;&#x65B9;&#x6848;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;ResourcesManager
&#x7684;createResources&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x4F1A;&#x5148;&#x5F97;&#x5230;&#x5305;&#x542B;&#x5BBF;&#x4E3B;&#x8D44;&#x6E90;&#x7684;AssetManager&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x8C03;&#x7528;
AssetManager&#x7684;addAssetPath&#x6765;&#x6DFB;&#x52A0;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;&#xFF0C;&#x8FD4;&#x56DE;&#x65B0;&#x7684;Resources&#xFF0C;&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x901A;&#x8FC7;Hook
&#x7684;&#x65B9;&#x5F0F;&#x7528;&#x65B0;&#x7684;Resources&#x66FF;&#x6362;&#x6B64;&#x524D;&#x7684;Resources&#x3002;&#x5982;&#x679C;&#x662F;&#x6784;&#x5EFA;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;&#x65B9;&#x6848;&#xFF0C;&#x4F1A;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x5148;
&#x521B;&#x5EFA;AssetManager&#xFF0C;&#x518D;&#x521B;&#x5EFA;Resources&#x5E76;&#x5C06;AssetManager&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x8FDB;&#x53BB;&#x3002;createAssetManager
&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/LoadedPlugin&#x3002;java
privatestaticAssetManagercreateAssetManager&#xFF08;Contextcontext&#xFF0C;Fileapk&#xFF09;{
try{
AssetManageram=
AssetManager&#x3002;class&#x3002;newInstance&#xFF08;&#xFF09;;
ReflectUtil&#x3002;invoke&#xFF08;AssetManager&#x3002;class&#xFF0C;am&#xFF0C;&quot;addAssetPath&quot;&#xFF0C;apk&#x3002;
getAbsolutePath&#xFF08;&#xFF09;&#xFF09;;
returnam;
}catch&#xFF08;Exceptione&#xFF09;
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
{
returnnull;
&#x9996;&#x5148;&#x52A8;&#x6001;&#x521B;&#x5EFA;AssetManager&#xFF0C;&#x518D;&#x53CD;&#x5C04;&#x8C03;&#x7528;AssetManager&#x7684;addAssetPath&#x65B9;&#x6CD5;&#x6765;&#x52A0;&#x8F7D;&#x63D2;
&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;AssetManager&#x53EA;&#x5305;&#x542B;&#x4E86;&#x63D2;&#x4EF6;&#x7684;&#x8D44;&#x6E90;&#xFF0C;&#x56E0;&#x6B64;createResources&#x65B9;&#x6CD5;&#x7684;&#x6CE8;&#x91CA;3&#x5904;&#x65B0;&#x521B;&#x5EFA;
&#x7684;Resources&#x662F;&#x63D2;&#x4EF6;&#x7684;&#x8D44;&#x6E90;&#x3002;VirtualApk&#x5B9E;&#x73B0;&#x5C31;&#x8BB2;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x5173;&#x4E8E;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x548C;&#x624B;&#x673A;&#x578B;&#x53F7;&#x9002;&#x914D;&#x7684;
&#x95EE;&#x9898;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x63D0;&#x5230;&#xFF0C;&#x60F3;&#x4E86;&#x89E3;&#x7684;&#x8BFB;&#x8005;&#x8BF7;&#x81EA;&#x884C;&#x9605;&#x8BFB;VirtualApk&#x7684;&#x6E90;&#x7801;&#x3002;
15&#x3002;9so&#x7684;&#x63D2;&#x4EF6;&#x5316;
so&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;&#x7B2C;13&#x7AE0;&#x8BB2;&#x5230;&#x7684;so&#x70ED;&#x4FEE;&#x590D;&#x6765;&#x5B66;&#x4E60;&#xFF0C;so&#x70ED;&#x4FEE;&#x590D;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x6848;&#xFF1A;
390</p>
<p>Page407
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
&#x3002;&#x5C06;so&#x8865;&#x4E01;&#x63D2;&#x5165;&#x5230;NativeLibraryElement&#x6570;&#x7EC4;&#x7684;&#x524D;&#x90E8;&#xFF0C;&#x8BA9;so&#x8865;&#x4E01;&#x7684;&#x8DEF;&#x5F84;&#x5148;&#x88AB;&#x8FD4;&#x56DE;&#x548C;
&#x52A0;&#x8F7D;&#x3002;
&#x3002;&#x8C03;&#x7528;System&#x7684;load&#x65B9;&#x6CD5;&#x6765;&#x63A5;&#x7BA1;so&#x7684;&#x52A0;&#x8F7D;&#x5165;&#x53E3;&#x3002;
so&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x65B9;&#x6848;&#x548C;so&#x70ED;&#x4FEE;&#x590D;&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x7C7B;&#x4F3C;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x5C06;so&#x63D2;&#x4EF6;&#x63D2;&#x5165;&#x5230;
NativeLibraryElementA+&#xFF0C;#AKsoattXHnativeLibraryDirectories
&#x5408;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;&#x6211;&#x4EEC;&#x6765;&#x67E5;&#x770B;VirtualApk&#x5B9E;&#x73B0;&#xFF0C;&#x5728;LoadedPlugin&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x4F1A;&#x8C03;&#x7528;
createClassLoader&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/internal/LoadedPlugin&#x3002;java
privatestaticClassLoadercreateClassLoader&#xFF08;Contextcontext&#xFF0C;Fileapk&#xFF0C;File
libsDir&#xFF0C;ClassLoaderparent&#xFF09;{
FiledexOutputDir
context&#x3002;getDir&#xFF08;Constants&#x3002;OPTIMIZEDIR&#xFF0C;
Context&#x3002;MODE
PRIVATE&#xFF09;;
StringdexOutputPath
DexClassLoaderloader=newDexClassLoader&#xFF08;apk&#x3002;getAbsolutePath&#xFF08;&#xFF09;&#xFF0C;
dexOutputDir&#x3002;getAbsolutePath&#xFF08;&#xFF09;;
dexOutputPath&#xFF0C;libsDir&#x3002;getAbsolutePath&#xFF08;&#xFF09;&#xFF0C;
nt&#xFF09;;//1
if&#xFF08;Constants&#x3002;COMBINECLASSLOADER&#xFF09;{
try{
DexUtil&#x3002;insertDex&#xFF08;loader&#xFF09;;
}catch&#xFF08;Exceptione&#xFF09;{
e&#x3002;printStackTrace&#xFF08;&#xFF09;;
}
}
returnloader;
&#x5728;&#x6CE8;&#x91CA;1&#x5904;&#x521B;&#x5EFA;&#x7528;&#x4E8E;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#x7684;DexClassLoader&#xFF0C;&#x5E76;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x4EBA;DexUtil&#x7684;insertDex
&#x65B9;&#x6CD5;&#x4E2D;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/utils/DexUtil&#x3002;java
publicstaticvoidinsertDex&#xFF08;DexClassLoaderdexClassLoader&#xFF09;throwsException{
getDexElements&#xFF08;getPathList&#xFF08;getPathClassLoader&#xFF08;&#xFF09;&#xFF09;&#xFF09;;
getDexElements&#xFF08;getPathList&#xFF08;dexClassLoader&#xFF09;&#xFF09;;
combineArray&#xFF08;baseDexElements&#xFF0C;newDexElements&#xFF09;;
ObjectbaseDexElements=
ObjectnewDexElements
ObjectallDexElements
ObjectpathList
=getPathList&#xFF08;getPathClassLoader&#xFF08;&#xFF09;&#xFF09;;
ReflectUtil&#x3002;setField&#xFF08;pathList&#x3002;getClass&#xFF08;&#xFF09;&#xFF0C;pathList&#xFF0C;&quot;dexElements&quot;&#xFF0C;allDex
Elements&#xFF09;;//1
insertNativeLibrary&#xFF08;dexClassLoader&#xFF09;;
insertDex&#x65B9;&#x6CD5;&#x4F1A;&#x5C06;&#x5BBF;&#x4E3B;&#x548C;&#x63D2;&#x4EF6;&#x7684;DexElements&#x5408;&#x5E76;&#x5F97;&#x5230;allDexElements&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x7528;
391</p>
<p>Page408
Android&#x8FDB;&#x9636;&#x89E3;&#x5BC6;
allDexElementsdexElements&#xFF0C;*T&#xC8;#1HE14&#x3002;5&#x3002;2&#x3002;3#SUFieldUtil&#x3002;setField
&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#x3002;so&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x5728;insertNativeLibrary&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;
CoreLibrary/src/main/java/com/didi/virtualapk/utils/DexUtil&#x3002;java
privatestaticsynchronizedvoidinsertNativeLibrary&#xFF08;DexClassLoaderdexClassLoader&#xFF09;
throwsException{
if&#xFF08;sHasInsertedNativeLibrary&#xFF09;{//1
return;
sHasInsertedNativeLibrary
=true;
ObjectbasePathList=
getPathList&#xFF08;getPathClassLoader&#xFF08;&#xFF09;&#xFF09;;//2
1/Android&#x7248;&#x672C;&#x5927;&#x4E8E;5&#x3002;1
if&#xFF08;Build&#x3002;VERSION&#x3002;SDKINT&gt;Build&#x3002;VERSIONCODES&#x3002;LOLLIPOPMR1&#xFF09;{
List<file>nativeLibraryDirectories=&#xFF08;List<file>&#xFF09;ReflectUtil&#x3002;getField
&#xFF08;basePathList&#x3002;getClass&#xFF08;&#xFF09;&#xFF0C;basePathList&#xFF0C;&quot;nativeLibraryDirectories&quot;&#xFF09;;//3
nativeLibraryDirectories&#x3002;add&#xFF08;Systems&#x3002;getContext&#xFF08;&#xFF09;&#x3002;getDir&#xFF08;Constants&#x3002;
NATIVEDIR&#xFF0C;Context&#x3002;MODEPRIVATE&#xFF09;&#xFF09;;//4
ObjectbaseNativeLibraryPathElements=ReflectUtil&#x3002;getField&#xFF08;basePathList&#x3002;
getClass&#xFF08;&#xFF09;&#xFF0C;basePathList&#xFF0C;&quot;nativeLibraryPathElements&quot;&#xFF09;;//5
finalintbaseArrayLength=Array&#x3002;getLength&#xFF08;baseNativeLibraryPathElements&#xFF09;;
ObjectnewPathList=
getPathList&#xFF08;dexClassLoader&#xFF09;;
ObjectnewNativeLibraryPathElements
ReflectUtil&#x3002;getField&#xFF08;newPathList&#x3002;
%3D
getClass&#xFF08;&#xFF09;&#xFF0C;newPathList&#xFF0C;&quot;nativeLibraryPathElements&quot;&#xFF09;;//6
Class&lt;?&gt;elementClass=
newNativeLibraryPathElements&#x3002;getClass&#xFF08;&#xFF09;&#x3002;
getComponentType&#xFF08;&#xFF09;;//7
ObjectallNativeLibraryPathElements=Array&#x3002;newInstance&#xFF08;elementClass&#xFF0C;
baseArrayLength+1&#xFF09;;
System&#x3002;arraycopy&#xFF08;baseNativeLibraryPathElements&#xFF0C;0&#xFF0C;
allNativeLibraryPathElements&#xFF0C;0&#xFF0C;baseArrayLength&#xFF09;;//8
FieldsoPathField;
if&#xFF08;Build&#x3002;VERSION&#x3002;SDKINT&gt;=26&#xFF09;{
soPathField=
elementClass&#x3002;getDeclaredField&#xFF08;&quot;path&quot;&#xFF09;;
}else{
soPathField=elementClass&#x3002;getDeclaredField&#xFF08;&quot;dir&quot;&#xFF09;;
}
soPathField&#x3002;setAccessible&#xFF08;true&#xFF09;;
finalintnewArrayLength
Array&#x3002;getLength&#xFF08;newNativeLibraryPathElements&#xFF09;;
for&#xFF08;inti=
0;i&lt;newArrayLength;i++&#xFF09;{
Objectelement=
Array&#x3002;get&#xFF08;newNativeLibraryPathElements&#xFF0C;i&#xFF09;;
Stringdir=&#xFF08;&#xFF08;File&#xFF09;soPathField&#x3002;get&#xFF08;element&#xFF09;&#xFF09;&#x3002;getAbsolutePath&#xFF08;&#xFF09;;
if&#xFF08;dir&#x3002;contains&#xFF08;Constants&#x3002;NATIVEDIR&#xFF09;&#xFF09;{
Array&#x3002;set&#xFF08;allNativeLibraryPathElements&#xFF0C;baseArrayLength&#xFF0C;element&#xFF09;;
break;
392</file></file></p>
<p>Page409
&#x7B2C;15&#x7AE0;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;
}
ReflectUtil&#x3002;setField&#xFF08;basePathList&#x3002;getClass&#xFF08;&#xFF09;&#xFF0C;basePathList&#xFF0C;
&quot;nativeLibraryPathElements&quot;&#xFF0C;allNativeLibraryPathElements&#xFF09;;
}else{
&#x6CE8;&#x91CA;1&#x5904;&#x7528;&#x4E8E;&#x907F;&#x514D;&#x91CD;&#x590D;&#x63D2;&#x5165;so&#x3002;&#x5728;&#x6CE8;&#x91CA;2&#x5904;&#x83B7;&#x53D6;&#x7684;basePathList&#x6307;&#x7684;&#x662F;&#x5BBF;&#x4E3B;&#x7684;PathList&#x3002;
&#x63A5;&#x4E0B;&#x6765;&#x5BF9;&#x4E0D;&#x540C;&#x7684;Android&#x7248;&#x672C;&#x4F1A;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x8BA8;&#x8BBA;Android&#x7248;&#x672C;&#x5927;&#x4E8E;5&#x3002;1&#x7684;&#x60C5;&#x51B5;&#x3002;
&#x5728;&#x6CE8;&#x91CA;3&#x5904;&#x5F97;&#x5230;&#x5BBF;&#x4E3B;&#x5B58;&#x50A8;so&#x6587;&#x4EF6;&#x7684;List&#x96C6;&#x5408;nativeLibraryDirectories&#xFF0C;&#x7D27;&#x63A5;&#x7740;&#x5728;&#x6CE8;&#x91CA;4&#x5904;&#x5C06;
&#x63D2;&#x4EF6;&#x5B58;&#x50A8;so&#x6587;&#x4EF6;&#x6DFB;&#x52A0;&#x5230;nativeLibraryDirectories&#x4E2D;&#x3002;&#x5728;&#x6CE8;&#x91CA;5&#x548C;&#x6CE8;&#x91CA;6&#x5904;&#x5206;&#x522B;&#x83B7;&#x53D6;&#x5BBF;&#x4E3B;&#x7684;
NativeLibraryElement&#xFF08;baseNativeLibraryPathElements&#xFF09;FIit&#xC1;JNativeLibraryElement
&#xFF08;newNativeLibraryPathElements&#xFF09;&#xFF0C;E&#xC8;#7aaaaF#jnewNativeLibraryPathElementsj}KT&#xFF0C;
&#x5E76;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x7EC4;allNativeLibraryPathElements&#xFF0C;&#x5728;&#x6CE8;&#x91CA;8&#x5904;&#x5C06;baseNativeLibraryPathElements
allNativeLibraryPathElements#&#x3002;newNativeLibraryPathElements&#xFF0C;soA
allNativeLibraryPathElements&#x3002;allNativeLibraryPathElements
nativeLibraryPathElements&#xFF0C;j&#xE0;#tsofui&#xFF08;4&#xFF1A;1&#x141;&#x3002;
15&#x3002;10&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;
&#x672C;&#x7AE0;&#x4ECB;&#x7ECD;&#x4E86;&#x63D2;&#x4EF6;&#x5316;&#x7684;&#x4EA7;&#x751F;&#x3001;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x5BF9;&#x6BD4;&#x3001;&#x56DB;&#x5927;&#x7EC4;&#x4EF6;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x3001;&#x8D44;&#x6E90;&#x548C;so&#x7684;&#x63D2;&#x4EF6;&#x5316;
&#x7B49;&#x3002;&#x63D2;&#x4EF6;&#x5316;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x5E9E;&#x5927;&#x7684;&#x77E5;&#x8BC6;&#x4F53;&#x7CFB;&#xFF0C;&#x7528;&#x4E00;&#x7AE0;&#x7684;&#x5185;&#x5BB9;&#x53EA;&#x80FD;&#x4ECB;&#x7ECD;&#x4E86;&#x90E8;&#x5206;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;&#xFF0C;&#x6BD4;&#x5982;
&#x63D2;&#x4EF6;&#x7684;&#x52A0;&#x8F7D;&#x673A;&#x5236;&#x5C31;&#x6CA1;&#x6709;&#x8BB2;&#x5230;&#xFF0C;&#x63D2;&#x4EF6;&#x7684;&#x52A0;&#x8F7D;&#x673A;&#x5236;&#x65B9;&#x6848;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#xFF0C;&#x4E00;&#x79CD;&#x662F;HookClassLoader&#xFF0C;
&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x59D4;&#x6258;&#x7ED9;&#x7CFB;&#x7EDF;&#x7684;ClassLoader&#x5E2E;&#x5FD9;&#x52A0;&#x8F7D;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x54EA;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#xFF0C;&#x539F;&#x7406;&#x90FD;&#x79BB;&#x4E0D;&#x5F00;&#x7B2C;12&#x7AE0;
&#x8BB2;&#x89E3;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x53E6;&#x5916;&#x672C;&#x7AE0;&#x4ECB;&#x7ECD;&#x7684;&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;&#x662F;&#x5EFA;&#x7ACB;&#x5728;&#x4E3B;&#x6D41;&#x6846;&#x67B6;&#x4E4B;&#x4E0A;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x638C;&#x63E1;&#x5168;&#x90E8;&#x7684;
&#x63D2;&#x4EF6;&#x5316;&#x539F;&#x7406;&#xFF0C;&#x8BF7;&#x9605;&#x8BFB;&#x8868;15-1&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x5168;&#x90E8;&#x63D2;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x6E90;&#x7801;&#x3002;
393</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="15 Hook.html" class="navigation navigation-prev " aria-label="Previous page: 15 Hook">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="17 绘制流程-生产者.html" class="navigation navigation-next " aria-label="Next page: 17 绘制流程-生产者">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"16 插件化","level":"1.6.1.13","depth":3,"next":{"title":"17 绘制流程-生产者","level":"1.6.1.14","depth":3,"path":"05 Android/01 Android底层源码分析/17 绘制流程-生产者.md","ref":"./05 Android/01 Android底层源码分析/17 绘制流程-生产者.md","articles":[]},"previous":{"title":"15 Hook","level":"1.6.1.12","depth":3,"path":"05 Android/01 Android底层源码分析/15 Hook.md","ref":"./05 Android/01 Android底层源码分析/15 Hook.md","articles":[]},"dir":"ltr"},"config":{"plugins":["highlight","search","livereload","splitter","expandable-chapters-small","anchors","anchor-navigation-ex"],"styles":{"website":"./styles/website.css"},"pluginsConfig":{"livereload":{},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"expandable-chapters-small":{},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","author":"Mezzsy","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Mezzsy is here","language":"zh-hans","gitbook":"3.2.3"},"file":{"path":"05 Android/01 Android底层源码分析/16 插件化.md","mtime":"2021-07-25T08:58:48.034Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-11-17T13:20:29.328Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

